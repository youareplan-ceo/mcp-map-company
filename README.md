# mcp-map-company

ìœ ì•„í”Œëœ MCP(ë©€í‹°-ì•± ì»¨íŠ¸ë¡¤ í”Œë ˆì¸) íšŒì‚¬ìš© ë¦¬í¬ì§€í† ë¦¬.  
í”„ë¡ íŠ¸(`web/`), API(`mcp/run.py` FastAPI), ë°°í¬(Render), í˜‘ì—…(GitHub) íë¦„ì„ í‘œì¤€í™”.

## êµ¬ì¡°
- `web/index.html` : ê³ ê°ìš© ë©”ì¸
- `web/admin.html` : ê´€ë¦¬ì ì „ìš©(ë¶„ë¦¬ëœ í™”ë©´, ê²€ìƒ‰/ì¸ë±ì‹± ì°¨ë‹¨ ê¶Œì¥)
- `mcp/run.py` : FastAPI ì„œë²„(CORS íŒ¨ì¹˜ í¬í•¨)
- `scripts/` : ìš´ì˜ ìŠ¤í¬ë¦½íŠ¸(ë°±ì—…/í—¬ìŠ¤ì²´í¬ ë“±)

## ë¡œì»¬ ì‹¤í–‰
uvicorn mcp.run:app --reload --port 8088

í—¬ìŠ¤ì²´í¬:
curl -sS http://localhost:8088/health

## ë°°í¬(Render)
1. GitHub main â†’ Render ì—°ê²°(ì˜¤í†  ë””í”Œë¡œì´)
2. ë³€ê²½ í›„ Push â†’ Render ìë™ ë°°í¬

## ë¸Œëœì¹˜ ì „ëµ
- main : ìš´ì˜ ê¸°ë³¸ ë¼ì¸
- stable/yyyymmdd : ë³µêµ¬ í¬ì¸íŠ¸(ì¤‘ìš” ë³€ê²½ ì§í›„ ìƒì„±)

## ë³€ê²½/ë³µêµ¬ ì•ˆì „ ì ˆì°¨ (ìš”ì•½)
1) ì˜ëª» ë®ì–´ì“´ ê³ ê°ìš© index.html â†’ admin.htmlë¡œ ì´ë™
2) ë°±ì—…ë³¸ì—ì„œ index.html ë³µì›
3) Git ì»¤ë°‹/í‘¸ì‹œ â†’ Render ìë™ë°°í¬

## ì•Œë¦¼ ì‹œìŠ¤í…œ ë° ë°°í¬ ìƒíƒœ ì ê²€

### ì•Œë¦¼ ì‹œìŠ¤í…œ (mcp/utils/notifier.py)
ì‹¬ê°ë„ë³„ ì•Œë¦¼ ì‹œìŠ¤í…œìœ¼ë¡œ Slack, Discord, Email ì±„ë„ì„ ì§€ì›í•©ë‹ˆë‹¤.

**ì‹¬ê°ë„ë³„ ë¶„ë¥˜:**
- ğŸš¨ **Critical**: ì‹œìŠ¤í…œ ì¤‘ë‹¨, ìµœê·¼ ë¡œê·¸ 50ì¤„ ì²¨ë¶€
- âŒ **Error**: ì˜¤ë¥˜ ë°œìƒ, ìµœê·¼ ë¡œê·¸ 20ì¤„ ì²¨ë¶€
- âš ï¸ **Warning**: ê²½ê³  ìƒí™©, ë¡œê·¸ ìš”ì•½ ì²¨ë¶€
- â„¹ï¸ **Info**: ì¼ë°˜ ì •ë³´, ë‹¨ìˆœ ë©”ì‹œì§€

**ì‹ ê·œ ê°•í™” ê¸°ëŠ¥:**
- ğŸ”„ **ìë™ ì¬ì‹œë„**: ì „ì†¡ ì‹¤íŒ¨ ì‹œ ìµœëŒ€ 3íšŒ ì¬ì‹œë„ (ì§€ìˆ˜ ë°±ì˜¤í”„)
- ğŸ”— **ë¡œê·¸ ë§í¬**: ì‹¬ê°ë„ë³„ ê´€ë ¨ ë¡œê·¸ íŒŒì¼ ë§í¬ ìë™ í¬í•¨
- ğŸ“Š **ì•Œë¦¼ ë¡œê·¸**: `logs/notifier.log`ì— ì„±ê³µ/ì‹¤íŒ¨ ë‚´ì—­ ê¸°ë¡
- â±ï¸ **ì†ë„ ì œí•œ**: ì‹¬ê°ë„ë³„ ì „ì†¡ ê°„ê²© ì¡°ì • (Critical: ì¦‰ì‹œ, Warning: 3ì´ˆ)

**ì‚¬ìš© ì˜ˆì‹œ:**
```python
from mcp.utils.notifier import NotificationLevel, SlackNotifier

notifier = SlackNotifier("https://hooks.slack.com/...")
await notifier.send_notification(
    title="ì‹œìŠ¤í…œ ì•Œë¦¼",
    message="ì„œë²„ ì¬ì‹œì‘ì´ í•„ìš”í•©ë‹ˆë‹¤",
    level=NotificationLevel.WARNING,
    attach_logs=True
)
```

**ë¡œê·¸ ë§í¬ ìë™ ì²¨ë¶€:**
- Critical/Error: ë³´ì•ˆ ë¡œê·¸, API ë¡œê·¸, ì‹œìŠ¤í…œ ë¡œê·¸
- Warning: API ë¡œê·¸, ì‹œìŠ¤í…œ ë¡œê·¸
- Info: ì‹œìŠ¤í…œ ë¡œê·¸

**ì¬ì‹œë„ ë¡œê·¸ ì˜ˆì‹œ:**
```
2024-01-15 14:30:25 - INFO - Slack ì•Œë¦¼ ì „ì†¡ ì‹œì‘: ì‹œìŠ¤í…œ ì•Œë¦¼ - warning
2024-01-15 14:30:26 - WARNING - ì•Œë¦¼ ì „ì†¡ ì‹¤íŒ¨ (ì‹œë„ 1/3): Connection timeout, 1.5ì´ˆ í›„ ì¬ì‹œë„
2024-01-15 14:30:28 - INFO - ì¬ì‹œë„ ì„±ê³µ: 2íšŒ ì‹œë„ í›„ ì„±ê³µ
2024-01-15 14:30:28 - INFO - Slack ì•Œë¦¼ ìµœì¢… ì„±ê³µ: ì‹œìŠ¤í…œ ì•Œë¦¼
```

### ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ ì•Œë¦¼ íŒ¨ë„ (web/admin_dashboard.html)
ìµœê·¼ 20ê°œ ì•Œë¦¼ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ í‘œì‹œí•˜ë©° ì‹¬ê°ë„ë³„ ìƒ‰ìƒê³¼ ì•„ì´ì½˜ìœ¼ë¡œ êµ¬ë¶„ë©ë‹ˆë‹¤.

**ê¸°ë³¸ ê¸°ëŠ¥:**
- ì‹¬ê°ë„ë³„ í†µê³„ ì¹´ë“œ (Critical/Error/Warning/Info)
- ì‹¤ì‹œê°„ ì•Œë¦¼ ëª©ë¡ (ì œëª©, ì‹œê°„, ì‹¬ê°ë„)
- í…ŒìŠ¤íŠ¸ ì•Œë¦¼ ìƒì„± ë²„íŠ¼
- ìë™ ìƒˆë¡œê³ ì¹¨ (30ì´ˆ ê°„ê²©)

**ì‹ ê·œ ê³ ê¸‰ ê¸°ëŠ¥:**
- ğŸ“… **ë‚ ì§œ í•„í„°**: ì˜¤ëŠ˜, 7ì¼, 30ì¼, ì „ì²´ ê¸°ê°„ë³„ ì•Œë¦¼ í•„í„°ë§
- ğŸ” **í†µí•© ê²€ìƒ‰**: ì œëª©, ë©”ì‹œì§€, ì†ŒìŠ¤, IDë¡œ ì•Œë¦¼ ê²€ìƒ‰
- ğŸ“‹ **ì„¸ë¶€ ì •ë³´ ëª¨ë‹¬**: ì•Œë¦¼ í´ë¦­ ì‹œ ìƒì„¸ ì •ë³´ íŒì—… í‘œì‹œ
- ğŸ“¤ **ë‚´ë³´ë‚´ê¸° ê¸°ëŠ¥**: JSON/CSV í˜•ì‹ìœ¼ë¡œ ì•Œë¦¼ ë°ì´í„° ë‚´ë³´ë‚´ê¸°
- ğŸ’¾ **ê°œë³„ ë‚´ë³´ë‚´ê¸°**: ëª¨ë‹¬ì—ì„œ ì„ íƒí•œ ì•Œë¦¼ì˜ ì„¸ë¶€ ì •ë³´ ë‚´ë³´ë‚´ê¸°

**ì„¸ë¶€ ì •ë³´ ëª¨ë‹¬ ë‚´ìš©:**
- ì•Œë¦¼ ê¸°ë³¸ ì •ë³´ (ì œëª©, ì‹¬ê°ë„, ì‹œê°„, ID, ì±„ë„, ìƒíƒœ)
- ì•Œë¦¼ ë©”ì‹œì§€ ì „ë¬¸
- ê´€ë ¨ ë¡œê·¸ ë§í¬ (í´ë¦­ ê°€ëŠ¥)
- ì¶”ê°€ ì •ë³´ (IP ì£¼ì†Œ, ì˜¤ë¥˜ ì½”ë“œ ë“±)
- ì²¨ë¶€ëœ ë¡œê·¸ ë‚´ìš© (Critical/Errorì˜ ê²½ìš°)

**ë‚´ë³´ë‚´ê¸° í˜•ì‹:**
- **JSON**: êµ¬ì¡°í™”ëœ ë°ì´í„°, API ì—°ë™ì— ì í•©
- **CSV**: ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ë¶„ì„ìš©, í•œê¸€ ì§€ì› (UTF-8 BOM)

**ì‚¬ìš©ë²•:**
1. ë‚ ì§œ í•„í„° ë²„íŠ¼ìœ¼ë¡œ ì¡°íšŒ ê¸°ê°„ ì„ íƒ
2. ê²€ìƒ‰ì°½ì— í‚¤ì›Œë“œ ì…ë ¥í•˜ì—¬ ì•Œë¦¼ í•„í„°ë§
3. ì•Œë¦¼ í•­ëª© í´ë¦­ìœ¼ë¡œ ì„¸ë¶€ ì •ë³´ í™•ì¸
4. ë‚´ë³´ë‚´ê¸° ë²„íŠ¼ìœ¼ë¡œ ë°ì´í„° ë‹¤ìš´ë¡œë“œ

### ë°°í¬ ìƒíƒœ ì ê²€ ìŠ¤í¬ë¦½íŠ¸ (scripts/deploy_status.sh)
ì‹œìŠ¤í…œ ì „ë°˜ì˜ ë°°í¬ ìƒíƒœë¥¼ ì¢…í•©ì ìœ¼ë¡œ ì ê²€í•©ë‹ˆë‹¤.

**ê¸°ë³¸ ì ê²€ í•­ëª©:**
- **Git ìƒíƒœ**: í˜„ì¬ ë¸Œëœì¹˜, ë§ˆì§€ë§‰ ì»¤ë°‹, ë™ê¸°í™” ì—¬ë¶€
- **Docker ì»¨í…Œì´ë„ˆ**: MCP ê´€ë ¨ ì„œë¹„ìŠ¤ ì‹¤í–‰ ìƒíƒœ
- **í¬íŠ¸ ì ìœ **: 8080, 8088 ë“± ì£¼ìš” í¬íŠ¸ ì‚¬ìš© í˜„í™©
- **ì‹œìŠ¤í…œ ë¦¬ì†ŒìŠ¤**: CPU, ë©”ëª¨ë¦¬, ë””ìŠ¤í¬ ì‚¬ìš©ë¥ 

**ì‹ ê·œ í™•ì¥ ê¸°ëŠ¥:**
- ğŸŒ **Nginx ìƒíƒœ**: ì›¹ì„œë²„ í”„ë¡œì„¸ìŠ¤, ì„¤ì • íŒŒì¼, í¬íŠ¸ 80/443 ìƒíƒœ
- ğŸ”’ **SSL ì¸ì¦ì„œ**: ë„ë©”ì¸ë³„ ì¸ì¦ì„œ ìœ íš¨ì„±, ë§Œë£Œì¼ í™•ì¸
- ğŸ“œ **ë¡œê·¸ ëª¨ë‹ˆí„°ë§**: ìµœê·¼ ë°°í¬ ë° ì‹œìŠ¤í…œ ë¡œê·¸ tail ê¸°ëŠ¥

**ì‹¤í–‰ ë°©ë²•:**
```bash
# ê¸°ë³¸ ì‹¤í–‰ (ìš”ì•½ ì •ë³´)
make deploy-status
./scripts/deploy_status.sh

# JSON ì¶œë ¥
./scripts/deploy_status.sh --json

# ìƒì„¸ ì •ë³´
./scripts/deploy_status.sh --detailed

# ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§ (5ì´ˆ ê°„ê²©)
./scripts/deploy_status.sh --watch

# ìƒˆë¡œìš´ í™•ì¥ ê¸°ëŠ¥ë“¤
./scripts/deploy_status.sh --nginx        # Nginx ìƒíƒœ í¬í•¨
./scripts/deploy_status.sh --ssl          # SSL ì¸ì¦ì„œ ê²€ì‚¬
./scripts/deploy_status.sh --logs         # ìµœê·¼ ë¡œê·¸ í‘œì‹œ

# ì „ì²´ ì ê²€ (ëª¨ë“  ê¸°ëŠ¥ í¬í•¨)
make deploy-status-full
./scripts/deploy_status.sh --detailed --nginx --ssl --logs
```

**SSL ë„ë©”ì¸ ì„¤ì •:**
```bash
# í™˜ê²½ë³€ìˆ˜ë¡œ í™•ì¸í•  ë„ë©”ì¸ ì§€ì •
export SSL_DOMAINS="mcp-map.company,api.mcp-map.company,admin.mcp-map.company"
./scripts/deploy_status.sh --ssl
```

**ì¶œë ¥ ì˜ˆì‹œ:**
```
=== ë°°í¬ ìƒíƒœ ì ê²€ ===
Git: main ë¸Œëœì¹˜ (2a74681) âœ“ ë™ê¸°í™”ë¨
Docker: 3ê°œ ì»¨í…Œì´ë„ˆ ì‹¤í–‰ ì¤‘
í¬íŠ¸: 8080(FastAPI), 8088(Admin) ì‚¬ìš© ì¤‘
Nginx: nginx/1.20.1 ì‹¤í–‰ ì¤‘ (Master PID: 1234, Workers: 4)
SSL: mcp-map.company âœ… ìœ íš¨ (90ì¼ ë‚¨ìŒ)
ë¡œê·¸: 5ê°œ íŒŒì¼ í™•ì¸ë¨ (ìµœê·¼ ì—…ë°ì´íŠ¸: 2ë¶„ ì „)
ì‹œìŠ¤í…œ: CPU 15% | ë©”ëª¨ë¦¬ 2.1GB/8GB | ë””ìŠ¤í¬ 45GB/100GB
```

**SSL ì¸ì¦ì„œ ìƒíƒœ:**
- âœ… ìœ íš¨ (30ì¼ ì´ìƒ ë‚¨ìŒ)
- âš ï¸ ê²½ê³  (7-30ì¼ ë‚¨ìŒ)
- ğŸš¨ ê³§ ë§Œë£Œ (7ì¼ ë¯¸ë§Œ)
- âŒ ë§Œë£Œë¨

**ë¡œê·¸ íŒŒì¼ ìš°ì„ ìˆœìœ„:**
1. `logs/deploy.log` - ë°°í¬ ê´€ë ¨ ë¡œê·¸
2. `logs/app.log` - ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œê·¸
3. `logs/api.log` - API ìš”ì²­ ë¡œê·¸
4. `/var/log/nginx/` - Nginx ë¡œê·¸
5. `/var/log/syslog` - ì‹œìŠ¤í…œ ë¡œê·¸

## ë³´ì•ˆ ë° Rate Limiting

### Rate Limiting ë¯¸ë“¤ì›¨ì–´ (mcp/utils/rate_limiter.py)
IPë³„ ìš”ì²­ íšŸìˆ˜ë¥¼ ì œí•œí•˜ì—¬ DDoS ê³µê²©ê³¼ ê³¼ë„í•œ API í˜¸ì¶œì„ ë°©ì§€í•©ë‹ˆë‹¤.

**ì£¼ìš” ê¸°ëŠ¥:**
- IPë³„ ë¶„ë‹¹ ìš”ì²­ ìˆ˜ ì œí•œ (ê¸°ë³¸ê°’: 100íšŒ/ë¶„)
- ì´ˆê³¼ ì‹œ HTTP 429 Too Many Requests ì‘ë‹µ
- ìœ„ë°˜ ì´ë²¤íŠ¸ë¥¼ `logs/security.log`ì— ìë™ ê¸°ë¡
- í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ IP ê´€ë¦¬ (ë¡œì»¬/ì›ê²© ì°¨ë‹¨ ìš°íšŒ)
- ì°¨ë‹¨ëœ IP ëª©ë¡ ë° í†µê³„ ì œê³µ

**ì„¤ì • ë°©ë²•:**
```python
from mcp.utils.rate_limiter import RateLimiter

# ì»¤ìŠ¤í…€ ì„¤ì •ìœ¼ë¡œ Rate Limiter ìƒì„±
rate_limiter = RateLimiter(
    requests_per_minute=50,     # ë¶„ë‹¹ 50íšŒ ì œí•œ
    cleanup_interval=300,       # 5ë¶„ë§ˆë‹¤ ì˜¤ë˜ëœ ê¸°ë¡ ì •ë¦¬
    log_file="logs/custom_security.log"
)

# í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ì— IP ì¶”ê°€
rate_limiter.add_to_whitelist("192.168.1.100")
```

**FastAPI í†µí•©:**
Rate Limiting ë¯¸ë“¤ì›¨ì–´ê°€ ìë™ìœ¼ë¡œ ëª¨ë“  ìš”ì²­ì— ì ìš©ë©ë‹ˆë‹¤:
```python
# mcp/run.pyì—ì„œ ìë™ ì ìš©ë¨
app.middleware("http")(rate_limit_middleware)
```

**ì‘ë‹µ í—¤ë”:**
- `X-RateLimit-Limit`: ë¶„ë‹¹ í—ˆìš© ìš”ì²­ ìˆ˜
- `X-RateLimit-Remaining`: ë‚¨ì€ ìš”ì²­ ìˆ˜
- `Retry-After`: ì°¨ë‹¨ í•´ì œê¹Œì§€ ëŒ€ê¸° ì‹œê°„ (ì´ˆ)

### ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ ë³´ì•ˆ íŒ¨ë„ (web/admin_dashboard.html)
ì‹¤ì‹œê°„ ë³´ì•ˆ ìƒí™©ì„ ëª¨ë‹ˆí„°ë§í•˜ê³  ì°¨ë‹¨ëœ IPë¥¼ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ë³´ì•ˆ í†µê³„ ì¹´ë“œ:**
- ğŸš« **ì°¨ë‹¨ëœ IP**: í˜„ì¬ Rate Limitìœ¼ë¡œ ì°¨ë‹¨ëœ IP ìˆ˜
- âš ï¸ **Rate Limit ìœ„ë°˜**: ìµœê·¼ 24ì‹œê°„ ìœ„ë°˜ íšŸìˆ˜
- âœ… **í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸**: ë“±ë¡ëœ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ IP ìˆ˜
- ğŸ‘€ **ëª¨ë‹ˆí„°ë§ IP**: í˜„ì¬ ì¶”ì  ì¤‘ì¸ IP ìˆ˜

**ì°¨ë‹¨ ì´ë²¤íŠ¸ ì¶”ì´ ì°¨íŠ¸:**
- Chart.js ê¸°ë°˜ ì‹¤ì‹œê°„ ì°¨íŠ¸
- ìµœê·¼ 24ì‹œê°„ ë™ì•ˆì˜ ì°¨ë‹¨ ì´ë²¤íŠ¸ ì¶”ì´
- ë‹¤í¬ëª¨ë“œ í…Œë§ˆ ìë™ ì ìš©

**ì°¨ë‹¨ëœ IP ëª©ë¡:**
- IP ì£¼ì†Œ, ìœ„ë°˜ íšŸìˆ˜, ë§ˆì§€ë§‰ ìœ„ë°˜ ì‹œê°„ í‘œì‹œ
- êµ­ê°€ë³„ í”Œë˜ê·¸ ì•„ì´ì½˜ í‘œì‹œ
- ê°œë³„ IP ì°¨ë‹¨ í•´ì œ ê¸°ëŠ¥

**IP í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ê´€ë¦¬:**
- ìƒˆ IP ì£¼ì†Œë¥¼ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€
- IP ì£¼ì†Œ í˜•ì‹ ìœ íš¨ì„± ê²€ì‚¬
- ë¡œì»¬ìŠ¤í† ë¦¬ì§€ ë° API ì—°ë™ ì§€ì›

**ì‚¬ìš© ë°©ë²•:**
1. ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ(`/admin_dashboard.html`) ì ‘ì†
2. ğŸ”’ ë³´ì•ˆ ëª¨ë‹ˆí„°ë§ íŒ¨ë„ì—ì„œ ì‹¤ì‹œê°„ í˜„í™© í™•ì¸
3. IP í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ê´€ë¦¬ ì„¹ì…˜ì—ì„œ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” IP ì¶”ê°€
4. ğŸ”„ ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼ìœ¼ë¡œ ìµœì‹  ë³´ì•ˆ ë°ì´í„° ê°±ì‹ 

### ë³´ì•ˆ í…ŒìŠ¤íŠ¸ (tests/test_security.py)
í¬ê´„ì ì¸ ë³´ì•ˆ í…ŒìŠ¤íŠ¸ë¡œ Rate Limiting ì‹œìŠ¤í…œì˜ ì•ˆì •ì„±ì„ ê²€ì¦í•©ë‹ˆë‹¤.

**í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤:**
1. **ê¸°ë³¸ Rate Limiting í…ŒìŠ¤íŠ¸**
   - ë™ì¼ IPì—ì„œ 200íšŒ ìš”ì²­ ì‹œ 429 ì‘ë‹µ í™•ì¸
   - ì œí•œ ì´ˆê³¼ í›„ ì°¨ë‹¨ IP ëª©ë¡ ë“±ë¡ í™•ì¸

2. **ì„œë¡œ ë‹¤ë¥¸ IP ë…ë¦½ì„± í…ŒìŠ¤íŠ¸**
   - ì„œë¡œ ë‹¤ë¥¸ IPëŠ” ì„œë¡œ ì˜í–¥ë°›ì§€ ì•ŠìŒ í™•ì¸
   - í•œ IP ì°¨ë‹¨ì´ ë‹¤ë¥¸ IPì— ë¯¸ì¹˜ëŠ” ì˜í–¥ ì—†ìŒ ê²€ì¦

3. **í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ìš°íšŒ í…ŒìŠ¤íŠ¸**
   - í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ IPëŠ” ë¬´ì œí•œ ìš”ì²­ í—ˆìš© í™•ì¸
   - í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ì¶”ê°€/ì œê±° ê¸°ëŠ¥ ê²€ì¦

4. **ë³´ì•ˆ ë¡œê·¸ ê¸°ë¡ í…ŒìŠ¤íŠ¸**
   - `logs/security.log` íŒŒì¼ ìƒì„± í™•ì¸
   - ìœ„ë°˜ ì´ë²¤íŠ¸ì˜ ìƒì„¸ ì •ë³´ ê¸°ë¡ ê²€ì¦

**í…ŒìŠ¤íŠ¸ ì‹¤í–‰:**
```bash
# ëª¨ë“  ë³´ì•ˆ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
python -m pytest tests/test_security.py -v

# íŠ¹ì • í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ë§Œ ì‹¤í–‰
python -m pytest tests/test_security.py::TestRateLimiter -v

# ë³´ì•ˆ ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸
python -m pytest tests/test_security.py::TestSecurityScenarios -v

# ìƒì„¸ ì¶œë ¥ê³¼ í•¨ê»˜ ì‹¤í–‰
python -m pytest tests/test_security.py -v --tb=long
```

**í…ŒìŠ¤íŠ¸ ê²°ê³¼ ì˜ˆì‹œ:**
```
tests/test_security.py::TestRateLimiter::test_rate_limiting_logic PASSED
tests/test_security.py::TestRateLimiter::test_different_ips_not_affected PASSED
tests/test_security.py::TestRateLimiter::test_security_logs_created PASSED
tests/test_security.py::TestSecurityScenarios::test_scenario_massive_requests_from_single_ip PASSED
```

### ë³´ì•ˆ API ì—”ë“œí¬ì¸íŠ¸
Rate Limiting ì‹œìŠ¤í…œê³¼ ìƒí˜¸ì‘ìš©í•  ìˆ˜ ìˆëŠ” RESTful APIë¥¼ ì œê³µí•©ë‹ˆë‹¤.

**GET /api/v1/security/stats**
í˜„ì¬ ë³´ì•ˆ í†µê³„ ì •ë³´ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤:
```json
{
  "blocked_count": 5,
  "blocked_ips": ["192.168.100.45", "203.142.78.23"],
  "whitelist_count": 4,
  "requests_per_minute_limit": 100,
  "current_monitored_ips": 25
}
```

**POST /api/v1/security/whitelist/{ip}**
ì§€ì •ëœ IPë¥¼ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€í•©ë‹ˆë‹¤:
```bash
curl -X POST http://localhost:8088/api/v1/security/whitelist/192.168.1.100
```

ì‘ë‹µ:
```json
{
  "success": true,
  "ip": "192.168.1.100",
  "message": "IPê°€ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤."
}
```

### ë³´ì•ˆ ì„¤ì • íŒŒì¼
ì‹œìŠ¤í…œ ë³´ì•ˆ ì„¤ì •ì„ íŒŒì¼ë¡œ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**config/whitelist_ips.json** - í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ IP ëª©ë¡:
```json
{
  "ips": [
    "192.168.1.0/24",
    "10.0.0.0/8",
    "172.16.0.0/12"
  ]
}
```

**logs/security.log** - ë³´ì•ˆ ì´ë²¤íŠ¸ ë¡œê·¸:
```
2024-01-15 14:30:25 - WARNING - Rate limit exceeded - IP: 203.142.78.23, Requests: 156/100, Endpoint: GET /api/v1/portfolio, User-Agent: AttackBot/1.0
2024-01-15 14:30:26 - INFO - IP added to whitelist: 192.168.1.100
```

### ë³´ì•ˆ ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ í™œìš©

**ì¼ì¼ ë³´ì•ˆ ì ê²€ ì²´í¬ë¦¬ìŠ¤íŠ¸:**
- [ ] ì°¨ë‹¨ëœ IP ìˆ˜ í™•ì¸ (`ë¸”ë¡ëœ IP` ì¹´ë“œ)
- [ ] Rate Limit ìœ„ë°˜ ê¸‰ì¦ ì—¬ë¶€ í™•ì¸ (ì°¨íŠ¸ íŒ¨í„´)
- [ ] ì˜ì‹¬ìŠ¤ëŸ¬ìš´ IPì˜ ìœ„ë°˜ íšŸìˆ˜ ì ê²€ (ì°¨ë‹¨ IP ëª©ë¡)
- [ ] í•„ìš”ì‹œ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” IPë¥¼ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€

**ë³´ì•ˆ ì´ë²¤íŠ¸ ëŒ€ì‘ ì ˆì°¨:**
1. ë³´ì•ˆ íŒ¨ë„ì—ì„œ ë¹„ì •ìƒì ì¸ í™œë™ ê°ì§€
2. `logs/security.log`ì—ì„œ ìƒì„¸ ì •ë³´ í™•ì¸
3. í•„ìš”ì‹œ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ë˜ëŠ” ì°¨ë‹¨ ëª©ë¡ ìˆ˜ì •
4. ì‹œìŠ¤í…œ ë¡œê·¸ íŒ¨ë„ì—ì„œ ì „ì²´ì ì¸ ì˜í–¥ í‰ê°€

### ì‹¤ì‹œê°„ ë³´ì•ˆ ì•Œë¦¼ ì‹œìŠ¤í…œ
ë³´ì•ˆ ì´ë²¤íŠ¸ ë°œìƒ ì‹œ ìë™ìœ¼ë¡œ ë‹¤ì¤‘ ì±„ë„ ì•Œë¦¼ì„ ì „ì†¡í•©ë‹ˆë‹¤.

**ì§€ì› ì±„ë„:**
- ğŸ”” **Slack**: ì›¹í›…ì„ í†µí•œ ì‹¤ì‹œê°„ ì•Œë¦¼
- ğŸ® **Discord**: ì„ë² ë“œ ë©”ì‹œì§€ë¡œ ìƒì„¸ ì •ë³´ ì œê³µ
- ğŸ“§ **Email**: HTML/í…ìŠ¤íŠ¸ í˜•ì‹ì˜ ìƒì„¸ ë³´ê³ ì„œ

**ìë™ ì•Œë¦¼ ì´ë²¤íŠ¸:**
- **IP ì°¨ë‹¨ ë°œìƒ**: Rate Limit ì´ˆê³¼ ì‹œ Critical ì•Œë¦¼ + ë³´ì•ˆ ë¡œê·¸ 50ì¤„ ì²¨ë¶€
- **Rate Limit ìœ„ë°˜**: ì„ê³„ê°’ ì ‘ê·¼ ì‹œ Warning ì•Œë¦¼
- **í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ë³€ê²½**: IP ì¶”ê°€/ì œê±° ì‹œ Info ì•Œë¦¼
- **ì¼ì¼ ë³´ì•ˆ ìš”ì•½**: ì°¨ë‹¨ í†µê³„ ë° ì‹ ê·œ ìœ„í˜‘ ë¶„ì„

**ì‚¬ìš©ë²•:**
```python
from mcp.utils.notifier import send_ip_blocked_alert, send_security_summary_alert

# IP ì°¨ë‹¨ ì•Œë¦¼ ì „ì†¡
await send_ip_blocked_alert(
    client_ip="192.168.1.100",
    violation_count=156,
    endpoint="/api/v1/portfolio",
    user_agent="AttackBot/1.0"
)

# ì¼ì¼ ë³´ì•ˆ ìš”ì•½ ì•Œë¦¼
await send_security_summary_alert(
    blocked_count=25,
    violations_24h=342,
    new_ips=["192.168.1.100", "203.0.113.50"]
)
```

**í™˜ê²½ë³€ìˆ˜ ì„¤ì •:**
```bash
# Slack ì•Œë¦¼
export SLACK_WEBHOOK_URL="https://hooks.slack.com/services/..."

# Discord ì•Œë¦¼
export DISCORD_WEBHOOK_URL="https://discord.com/api/webhooks/..."

# ì´ë©”ì¼ ì•Œë¦¼
export SMTP_SERVER="smtp.gmail.com"
export SMTP_PORT="587"
export NOTIFY_EMAIL="security@company.com"
export NOTIFY_PASSWORD="app_password"
export NOTIFY_RECIPIENTS="admin1@company.com,admin2@company.com"
```

### í™•ì¥ëœ ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ ë³´ì•ˆ ê¸°ëŠ¥

**ìƒˆë¡œìš´ ë³´ì•ˆ í†µê³„ ì¹´ë“œ:**
- ğŸš« **ì°¨ë‹¨ëœ IP**: ì‹¤ì‹œê°„ ì°¨ë‹¨ëœ IP ìˆ˜ëŸ‰ í‘œì‹œ
- âš ï¸ **Rate Limit ìœ„ë°˜**: ìµœê·¼ 24ì‹œê°„ ìœ„ë°˜ í†µê³„
- âœ… **í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸**: ë“±ë¡ëœ ì‹ ë¢° IP ìˆ˜ëŸ‰
- ğŸ‘€ **ëª¨ë‹ˆí„°ë§ IP**: í˜„ì¬ ì¶”ì  ì¤‘ì¸ IP í˜„í™©

**ì°¨ë‹¨ ì´ë²¤íŠ¸ ì¶”ì´ ì°¨íŠ¸:**
- Chart.js ê¸°ë°˜ ì‹¤ì‹œê°„ ì‹œê°í™”
- ìµœê·¼ 24ì‹œê°„ ì°¨ë‹¨ íŒ¨í„´ ë¶„ì„
- ë‹¤í¬/ë¼ì´íŠ¸ ëª¨ë“œ ìë™ í…Œë§ˆ ì ìš©
- ì‹œê°„ëŒ€ë³„ ê³µê²© íŒ¨í„´ ì‹ë³„ ê°€ëŠ¥

**ì‹¤ì‹œê°„ ë³´ì•ˆ ì•Œë¦¼ ì„¤ì •:**
- ì•Œë¦¼ ì±„ë„ ê°œë³„ í™œì„±í™”/ë¹„í™œì„±í™”
- ì°¨ë‹¨ ì„ê³„ê°’ ë™ì  ì¡°ì • (1-1000 ìš”ì²­/ë¶„)
- ì•Œë¦¼ ì „ì†¡ ê°„ê²© ì„¤ì • (1-60ë¶„)
- ì„¤ì •ê°’ localStorage ìë™ ì €ì¥

**ë³´ì•ˆ ê´€ë¦¬ ê¸°ëŠ¥:**
- í…ŒìŠ¤íŠ¸ ì•Œë¦¼ ì „ì†¡ ë²„íŠ¼
- ë³´ì•ˆ ë¡œê·¸ CSV ë‚´ë³´ë‚´ê¸°
- ìµœê·¼ ë³´ì•ˆ ì´ë²¤íŠ¸ ì‹¤ì‹œê°„ í‘œì‹œ
- ë³´ì•ˆ ì ìˆ˜ ìë™ ê³„ì‚° ë° ìƒ‰ìƒ í‘œì‹œ

**ì‚¬ìš© ì˜ˆì‹œ:**
```javascript
// í…ŒìŠ¤íŠ¸ ì•Œë¦¼ ì „ì†¡
await testSecurityAlert();

// ë³´ì•ˆ ë¡œê·¸ ë‚´ë³´ë‚´ê¸°
exportSecurityLog();

// ë³´ì•ˆ ì„¤ì • ì €ì¥
saveSecuritySettings();
```

### ê°•í™”ëœ ë³´ì•ˆ í…ŒìŠ¤íŠ¸

**ìƒˆë¡œìš´ í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤:**

1. **ì•Œë¦¼ ì‹œìŠ¤í…œ í†µí•© í…ŒìŠ¤íŠ¸**
   - notifier ëª¨ë“ˆ import ë° í•¨ìˆ˜ í˜¸ì¶œ ê²€ì¦
   - ë³´ì•ˆ ì•Œë¦¼ ì „ì†¡ ì„±ê³µ/ì‹¤íŒ¨ ì²˜ë¦¬ í™•ì¸
   - ë³´ì•ˆ ë¡œê·¸ íŒŒì¼ ìƒì„± ë° ë‚´ìš© ê²€ì¦

2. **ë¶„ì‚° ê³µê²© ì‹œë®¬ë ˆì´ì…˜**
   - 100ê°œ IPì—ì„œ ê°ê° 50íšŒ ìš”ì²­ (ì´ 5,000íšŒ)
   - IPë³„ ë…ë¦½ì ì¸ Rate Limiting í™•ì¸
   - ëŒ€ê·œëª¨ ê³µê²© ì‹œë‚˜ë¦¬ì˜¤ ë°©ì–´ ëŠ¥ë ¥ ê²€ì¦

3. **ì ì§„ì  ê³µê²© íŒ¨í„´ í…ŒìŠ¤íŠ¸**
   - ì •ìƒ â†’ ê³¼ë¶€í•˜ â†’ ê³µê²© ë‹¨ê³„ë³„ ì‹œë‚˜ë¦¬ì˜¤
   - ê° ë‹¨ê³„ë³„ ì ì ˆí•œ ëŒ€ì‘ í™•ì¸
   - ê³µê²© íŒ¨í„´ ë³€í™”ì— ë”°ë¥¸ ì°¨ë‹¨ ë¡œì§ ê²€ì¦

4. **í”„ë¡ì‹œ IP ì²˜ë¦¬ í…ŒìŠ¤íŠ¸**
   - X-Forwarded-For í—¤ë” íŒŒì‹± ì •í™•ì„±
   - ì‹¤ì œ í´ë¼ì´ì–¸íŠ¸ IP ì¶”ì¶œ ê²€ì¦
   - í”„ë¡ì‹œ í™˜ê²½ì—ì„œì˜ Rate Limiting ë™ì‘

5. **ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬ í…ŒìŠ¤íŠ¸**
   - 10,000íšŒ ìš”ì²­ 5ì´ˆ ì´ë‚´ ì²˜ë¦¬ ê²€ì¦
   - ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ìµœì í™” í™•ì¸
   - ëŒ€ìš©ëŸ‰ íŠ¸ë˜í”½ ì²˜ë¦¬ ëŠ¥ë ¥ ì¸¡ì •

**í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì˜ˆì‹œ:**
```bash
# ì „ì²´ ë³´ì•ˆ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
python -m pytest tests/test_security.py -v

# ì•Œë¦¼ ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸ë§Œ ì‹¤í–‰
python -m pytest tests/test_security.py::TestNotifierIntegration -v

# ê³ ê¸‰ ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸
python -m pytest tests/test_security.py::TestAdvancedSecurityScenarios -v

# ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ í¬í•¨ (ì‹œê°„ì´ ì˜¤ë˜ ê±¸ë¦¼)
python -m pytest tests/test_security.py::TestAdvancedSecurityScenarios::test_rate_limiter_performance -v -s
```

### ë³´ì•ˆ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

**ì»´í¬ë„ŒíŠ¸ êµ¬ì¡°:**
```
mcp/utils/
â”œâ”€â”€ rate_limiter.py     # í•µì‹¬ Rate Limiting ì—”ì§„
â”œâ”€â”€ notifier.py         # ë‹¤ì¤‘ ì±„ë„ ì•Œë¦¼ ì‹œìŠ¤í…œ
â””â”€â”€ ...

web/
â””â”€â”€ admin_dashboard.html # ì‹¤ì‹œê°„ ë³´ì•ˆ ëª¨ë‹ˆí„°ë§ UI

tests/
â””â”€â”€ test_security.py    # í¬ê´„ì  ë³´ì•ˆ í…ŒìŠ¤íŠ¸ ìŠ¤ìœ„íŠ¸

logs/
â”œâ”€â”€ security.log        # ë³´ì•ˆ ì´ë²¤íŠ¸ ë¡œê·¸
â””â”€â”€ notifications.log   # ì•Œë¦¼ ì „ì†¡ ë¡œê·¸

config/
â””â”€â”€ whitelist_ips.json  # í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ IP ê´€ë¦¬
```

**ë°ì´í„° íë¦„:**
1. í´ë¼ì´ì–¸íŠ¸ ìš”ì²­ â†’ FastAPI ë¯¸ë“¤ì›¨ì–´
2. Rate Limiter â†’ IPë³„ ìš”ì²­ ìˆ˜ ê²€ì‚¬
3. ìœ„ë°˜ ê°ì§€ â†’ ë³´ì•ˆ ë¡œê·¸ ê¸°ë¡ + ì•Œë¦¼ ì „ì†¡
4. ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ â†’ ì‹¤ì‹œê°„ í˜„í™© í‘œì‹œ
5. í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ê´€ë¦¬ â†’ ì˜ˆì™¸ ì²˜ë¦¬ ì ìš©

### ë³´ì•ˆ ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ ê³ ê¸‰ í™œìš©

**ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§ ì›Œí¬í”Œë¡œìš°:**
1. **ì¼ì¼ ì ê²€ (ì˜¤ì „ 9ì‹œ)**
   - ë³´ì•ˆ ì ìˆ˜ í™•ì¸ (90ì  ì´ìƒ ìœ ì§€)
   - ì „ë‚  ì°¨ë‹¨ëœ IP ìˆ˜ ë¶„ì„
   - ìƒˆë¡œìš´ ê³µê²© íŒ¨í„´ ì‹ë³„

2. **ì •ê¸° ê²€í†  (ì£¼ê°„)**
   - ì°¨ë‹¨ ì´ë²¤íŠ¸ ì¶”ì´ ì°¨íŠ¸ ë¶„ì„
   - í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ IP ìœ íš¨ì„± ê²€í† 
   - ì•Œë¦¼ ì„ê³„ê°’ íŠœë‹

3. **ë³´ì•ˆ ì‚¬ê³  ëŒ€ì‘**
   - ì‹¤ì‹œê°„ ì•Œë¦¼ í™•ì¸ â†’ ë¡œê·¸ ë¶„ì„
   - ê³µê²© IP íŒ¨í„´ ë¶„ì„ â†’ ì¶”ê°€ ì°¨ë‹¨ ì¡°ì¹˜
   - í”¼í•´ ë²”ìœ„ í‰ê°€ â†’ ë³µêµ¬ ê³„íš ìˆ˜ë¦½

**ë³´ì•ˆ ì§€í‘œ í•´ì„:**
- **ë³´ì•ˆ ì ìˆ˜ 90-100**: ì•ˆì „ (ë…¹ìƒ‰)
- **ë³´ì•ˆ ì ìˆ˜ 70-89**: ì£¼ì˜ (ë…¸ë€ìƒ‰) - ëª¨ë‹ˆí„°ë§ ê°•í™” í•„ìš”
- **ë³´ì•ˆ ì ìˆ˜ 50-69**: ìœ„í—˜ (ë¹¨ê°„ìƒ‰) - ì¦‰ì‹œ ì¡°ì¹˜ í•„ìš”
- **ë³´ì•ˆ ì ìˆ˜ 50 ë¯¸ë§Œ**: ê¸´ê¸‰ (ê¹œë¹¡ì„) - ë³´ì•ˆíŒ€ ì¦‰ì‹œ ëŒ€ì‘

---
## ğŸ“˜ ì‹œìŠ¤í…œ ë¬¸ì„œ ì—…ë°ì´íŠ¸ (2025-09-20)

### ğŸ“¢ ì•Œë¦¼ ì‹œìŠ¤í…œ ë° ë°°í¬ ìƒíƒœ ì ê²€
- ì „ì²´ ì‹œìŠ¤í…œ ê°œìš”ì™€ ì£¼ìš” ê¸°ëŠ¥ ì„¤ëª…
- notifier.py: ì¬ì‹œë„ ë¡œì§, ë¡œê·¸ ë§í¬, ì•Œë¦¼ ë¡œê¹… ê¸°ëŠ¥
- admin_dashboard.html: ë‚ ì§œ í•„í„°, ìƒì„¸ ëª¨ë‹¬, ë‚´ë³´ë‚´ê¸° ê¸°ëŠ¥
- deploy_status.sh: Nginx, SSL, ë¡œê·¸ ëª¨ë‹ˆí„°ë§ í™•ì¥ ê¸°ëŠ¥
- ë³´ì•ˆ ë° Rate Limiting: í¬ê´„ì ì¸ ë³´ì•ˆ ì²´ê³„

### ğŸ“ ì£¼ìš” íŠ¹ì§•
- ëª¨ë“  ì½”ë“œì™€ ë¬¸ì„œì— **í•œêµ­ì–´ ì£¼ì„** í¬í•¨
- ì‹¤ì œ ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤ì™€ ì¶œë ¥ ì˜ˆì‹œ ì œê³µ
- í™˜ê²½ ë³€ìˆ˜ ë° API ì—”ë“œí¬ì¸íŠ¸ ìƒì„¸ ì„¤ëª…
- CI/CDì™€ ìš´ì˜ ìë™í™” í†µí•© ê°€ì´ë“œ

## ğŸ” ë³´ì•ˆ ë¡œê·¸ ë° ë°±ì—… ê´€ë¦¬ í†µí•© ê°€ì´ë“œ

### ğŸ“‚ ë³´ì•ˆ ë¡œê·¸ ì‹œìŠ¤í…œ
- ë¡œê·¸ ìœ„ì¹˜: `logs/security.log`
- ê¸°ë¡ ì´ë²¤íŠ¸:
  - ğŸš« ì°¨ë‹¨ëœ IP
  - âš ï¸ Rate Limiting ìœ„ë°˜
  - âœ… í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ë“±ë¡/ì‚­ì œ
  - ğŸ‘€ ëª¨ë‹ˆí„°ë§ ì´ë²¤íŠ¸
- ë³´ê´€ ì •ì±…: ì¼ë³„ íšŒì „, 30ì¼ ë³´ê´€
- í™•ì¸ ë°©ë²•: ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ â†’ "ë³´ì•ˆ ë¡œê·¸" íŒ¨ë„

### ğŸ“¦ ë°±ì—… ê´€ë¦¬
#### ğŸ› ï¸ ê²€ì¦
```bash
make verify-backups
./scripts/backup_verifier.sh --detailed
```

#### ğŸ§¹ ì •ë¦¬
```bash
make cleanup-backups
./scripts/cleanup_old_backups.sh --dry-run  # ì‹œë®¬ë ˆì´ì…˜
./scripts/cleanup_old_backups.sh            # ì‹¤ì œ ì •ë¦¬
```

### ğŸ§ª í…ŒìŠ¤íŠ¸ ì‹¤í–‰
```bash
# ë³´ì•ˆ ë¡œê·¸ í…ŒìŠ¤íŠ¸
python -m pytest tests/test_security_logger.py -v

# ë°±ì—… + ë³´ì•ˆ ë¡œê·¸ í†µí•© í…ŒìŠ¤íŠ¸
python -m pytest tests/test_backup_and_logs.py -v

# ìš´ì˜ í†µí•© í…ŒìŠ¤íŠ¸ (ì „ì²´ ì›Œí¬í”Œë¡œìš°)
python -m pytest tests/test_integration_ops.py -v

# ì „ì²´ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
python -m pytest tests/ -v
```

### ğŸ§ª ìš´ì˜ í†µí•© í…ŒìŠ¤íŠ¸
`test_integration_ops.py`ëŠ” ë³´ì•ˆ ë¡œê·¸ ê¸°ë¡ë¶€í„° ë°±ì—… ê²€ì¦ê¹Œì§€ì˜ ì „ì²´ ìš´ì˜ ì›Œí¬í”Œë¡œìš°ë¥¼ ê²€ì¦í•©ë‹ˆë‹¤.

#### í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤
1. **ë³´ì•ˆ ë¡œê·¸ ì›Œí¬í”Œë¡œìš°**
   - ì°¨ë‹¨ IP, í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸, ëª¨ë‹ˆí„°ë§ ì´ë²¤íŠ¸ ê¸°ë¡
   - `logs/security.log` íŒŒì¼ ìƒì„± ë° ë‚´ìš© ê²€ì¦
   - í•œêµ­ì–´ ë©”ì‹œì§€ ì •ìƒ ê¸°ë¡ í™•ì¸

2. **ë°±ì—… ê²€ì¦ í†µí•©**
   - `./scripts/backup_verifier.sh --dry-run` ì‹¤í–‰
   - ìŠ¤í¬ë¦½íŠ¸ ì¡´ì¬ ì—¬ë¶€ ë° ì‹¤í–‰ ê¶Œí•œ í™•ì¸
   - ë°±ì—… ìƒíƒœ ë¦¬í¬íŠ¸ ìƒì„± ê²€ì¦

3. **ì •ë¦¬ ìŠ¤í¬ë¦½íŠ¸ í†µí•©**
   - `./scripts/cleanup_old_backups.sh --dry-run` ì‹¤í–‰
   - ì‹œë®¬ë ˆì´ì…˜ ëª¨ë“œ ì •ìƒ ë™ì‘ í™•ì¸
   - ì‹¤ì œ íŒŒì¼ ì‚­ì œ ì—†ì´ ë¡œì§ ê²€ì¦

4. **Makefile ëª…ë ¹ì–´ ê²€ì¦**
   - `make help` ë“± ê¸°ë³¸ ëª…ë ¹ì–´ ì‹¤í–‰ ê°€ëŠ¥ ì—¬ë¶€
   - ìë™í™” ì›Œí¬í”Œë¡œìš° í†µí•©ì„± í™•ì¸

#### ì‹¤í–‰ ë°©ë²• ë° ì˜ˆìƒ ê²°ê³¼
```bash
# ìƒì„¸ ì¶œë ¥ê³¼ í•¨ê»˜ í†µí•© í…ŒìŠ¤íŠ¸ ì‹¤í–‰
python -m pytest tests/test_integration_ops.py -v -s

# ì˜ˆìƒ ì¶œë ¥:
# âœ… ë³´ì•ˆ ë¡œê·¸ ì›Œí¬í”Œë¡œìš° ì •ìƒ ë™ì‘ í™•ì¸
# âœ… ë°±ì—… ê²€ì¦ ìŠ¤í¬ë¦½íŠ¸ ì •ìƒ ì‹¤í–‰: [ë°±ì—… ìƒíƒœ]...
# âœ… ì •ë¦¬ ìŠ¤í¬ë¦½íŠ¸ ì •ìƒ ì‹¤í–‰ (ì‹œë®¬ë ˆì´ì…˜)
# âœ… ì „ì²´ ì›Œí¬í”Œë¡œìš° í…ŒìŠ¤íŠ¸ ì™„ë£Œ
#    - ë³´ì•ˆ ë¡œê·¸ ê¸°ë¡: ì •ìƒ
#    - ì‚¬ìš© ê°€ëŠ¥í•œ ìŠ¤í¬ë¦½íŠ¸: 2ê°œ
#    - í†µí•© í…ŒìŠ¤íŠ¸ ìƒíƒœ: ì„±ê³µ
```

#### CI/CD íŒŒì´í”„ë¼ì¸ í†µí•©
GitHub Actionsì—ì„œ ìë™ ì‹¤í–‰ë˜ë©°, ì‹¤íŒ¨ ì‹œ ë‹¤ìŒ ì•„í‹°íŒ©íŠ¸ê°€ ì—…ë¡œë“œë©ë‹ˆë‹¤:
- `logs/security.log` - ë³´ì•ˆ ë¡œê·¸ íŒŒì¼
- ë°±ì—… ë¦¬í¬íŠ¸ íŒŒì¼ë“¤
- í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ë¡œê·¸

### ğŸ”„ ì¼ì¼ ìš´ì˜ ì²´í¬ë¦¬ìŠ¤íŠ¸
1. **ë³´ì•ˆ ì ê²€**
   - [ ] ì°¨ë‹¨ëœ IP ìˆ˜ í™•ì¸
   - [ ] Rate Limiting ìœ„ë°˜ íŒ¨í„´ ë¶„ì„
   - [ ] í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ìœ íš¨ì„± ê²€í† 

2. **ë°±ì—… ì ê²€**
   - [ ] `make verify-backups` ì‹¤í–‰
   - [ ] ìµœì‹  ë°±ì—… íŒŒì¼ ì¡´ì¬ í™•ì¸
   - [ ] ë””ìŠ¤í¬ ìš©ëŸ‰ í™•ì¸

3. **ë¡œê·¸ ê´€ë¦¬**
   - [ ] `logs/security.log` í¬ê¸° í™•ì¸
   - [ ] 30ì¼ ì´ìƒ ëœ ë¡œê·¸ ìë™ ì‚­ì œ í™•ì¸
   - [ ] ë¹„ì •ìƒ ì´ë²¤íŠ¸ íŒ¨í„´ ê²€í† 

### ì‹¤í–‰ ì˜ˆì‹œ
```python
from mcp.security_logger import log_security_event

# ë³´ì•ˆ ì´ë²¤íŠ¸ ê¸°ë¡
log_security_event("BLOCKED_IP", "192.168.0.15 - Rate Limit ì´ˆê³¼ë¡œ ì°¨ë‹¨")
log_security_event("WHITELIST_ADD", "127.0.0.1 - ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” IP ì¶”ê°€")
log_security_event("MONITOR", "ì¼ì¼ ë³´ì•ˆ ì ê²€ ì™„ë£Œ")
```

## ğŸ”„ ë°±ì—…/ë³´ì•ˆ ë¡œê·¸ CI/CD í†µí•©

### ğŸ“‹ GitHub Actions ì›Œí¬í”Œë¡œìš° ê°œìš”
`.github/workflows/ci.yml`ì—ì„œ ë°±ì—… ë° ë³´ì•ˆ ë¡œê·¸ ì‹œìŠ¤í…œì˜ ìë™í™”ëœ í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤.

**ì£¼ìš” ë‹¨ê³„:**
1. **ğŸ§ª ë°±ì—… ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸**: `test_backup_makefile.py`, `test_backup_and_logs.py` ì‹¤í–‰
2. **ğŸ›¡ï¸ ë³´ì•ˆ ë¡œê·¸ í…ŒìŠ¤íŠ¸**: `test_security_logger.py` ì‹¤í–‰
3. **ğŸ”§ ë°±ì—… ê²€ì¦**: `scripts/backup_verifier.sh` ì‹œë®¬ë ˆì´ì…˜ ì‹¤í–‰
4. **ğŸ§¹ ë°±ì—… ì •ë¦¬**: `scripts/cleanup_old_backups.sh` dry-run ëª¨ë“œ
5. **ğŸ“Š ë³´ì•ˆ ë¡œê·¸ ìƒì„±**: `logs/security.log` íŒŒì¼ ì¡´ì¬ ë° ë‚´ìš© í™•ì¸
6. **ğŸ“ ì•„í‹°íŒ©íŠ¸ ì €ì¥**: ì‹¤íŒ¨ ì‹œ ì›Œí¬í”Œë¡œ ë¡œê·¸ë¥¼ 30ì¼ê°„ ë³´ê´€

### ğŸš€ CI ì‹¤í–‰ ì˜ˆì‹œ
```bash
# ë¡œì»¬ì—ì„œ CIì™€ ë™ì¼í•œ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
python -m pytest tests/test_backup_makefile.py -v
python -m pytest tests/test_security_logger.py -v
./scripts/backup_verifier.sh --dry-run --json
./scripts/cleanup_old_backups.sh --dry-run
```

### ğŸ“Š CI ë¡œê·¸ ìŠ¤í¬ë¦°ìƒ· ê²½ë¡œ
CI ì‹¤í–‰ í›„ ë‹¤ìŒ ê²½ë¡œì—ì„œ ê²°ê³¼ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
- **Actions íƒ­**: GitHub â†’ Repository â†’ Actions â†’ ìµœì‹  ì›Œí¬í”Œë¡œ ì‹¤í–‰
- **ì•„í‹°íŒ©íŠ¸**: `ci-reports-{run_number}.zip` ë‹¤ìš´ë¡œë“œ
- **ë¡œê·¸ íŒŒì¼**: `logs/security.log`, `reports/ci_summary.json`

### ğŸ”„ ìë™í™” íë¦„ ì„¤ëª…
```mermaid
graph TD
    A[ì½”ë“œ Push/PR] --> B[CI ì›Œí¬í”Œë¡œ íŠ¸ë¦¬ê±°]
    B --> C[ë°±ì—… ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸]
    C --> D[ë³´ì•ˆ ë¡œê·¸ í…ŒìŠ¤íŠ¸]
    D --> E[Makefile ëª…ë ¹ì–´ ê²€ì¦]
    E --> F[ë¡œê·¸ íŒŒì¼ ìƒì„± í™•ì¸]
    F --> G{í…ŒìŠ¤íŠ¸ ê²°ê³¼}
    G -->|ì„±ê³µ| H[CI ì™„ë£Œ]
    G -->|ì‹¤íŒ¨| I[í›„ì²˜ë¦¬ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰]
    I --> J[ì‹¤íŒ¨ ë¦¬í¬íŠ¸ ìƒì„±]
    J --> K[ì•„í‹°íŒ©íŠ¸ ì €ì¥]
    K --> L[ì•Œë¦¼ ì „ì†¡]
```

### ğŸ”” ì‹¤íŒ¨ ì‹œ ìë™ ì•Œë¦¼
í™˜ê²½ë³€ìˆ˜ ì„¤ì • ì‹œ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ ì•Œë¦¼ì„ ìë™ ì „ì†¡í•©ë‹ˆë‹¤:

**GitHub Secrets ì„¤ì •:**
- `SLACK_WEBHOOK_URL`: Slack ì±„ë„ ì›¹í›…
- `DISCORD_WEBHOOK_URL`: Discord ì±„ë„ ì›¹í›…

**ì•Œë¦¼ ë‚´ìš©:**
- ğŸš¨ ì‹¤íŒ¨í•œ í…ŒìŠ¤íŠ¸ ëª©ë¡
- ğŸ“Š ë°±ì—…/ë³´ì•ˆ ë¡œê·¸ ìƒíƒœ ìš”ì•½
- ğŸ”— GitHub Actions ë¡œê·¸ ë§í¬
- ğŸ“ ë‹¤ìš´ë¡œë“œ ê°€ëŠ¥í•œ ì•„í‹°íŒ©íŠ¸ ì •ë³´

### ğŸ“ˆ CI ì„±ëŠ¥ ìµœì í™”
- **ë³‘ë ¬ ì‹¤í–‰**: Python 3.9, 3.10, 3.11 ë§¤íŠ¸ë¦­ìŠ¤ í…ŒìŠ¤íŠ¸
- **ì¡°ê±´ë¶€ ì‹¤í–‰**: íŒŒì¼ ì¡´ì¬ ì‹œì—ë§Œ í•´ë‹¹ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
- **ì‹¤íŒ¨ í—ˆìš©**: `continue-on-error: true`ë¡œ ë¶€ë¶„ ì‹¤íŒ¨ í—ˆìš©
- **ì•„í‹°íŒ©íŠ¸ ìµœì í™”**: 30ì¼ ë³´ê´€ ì •ì±…ìœ¼ë¡œ ì €ì¥ ê³µê°„ ê´€ë¦¬

### ğŸ› ï¸ ë¡œì»¬ CI ì‹œë®¬ë ˆì´ì…˜
CI í™˜ê²½ê³¼ ë™ì¼í•œ ì¡°ê±´ì—ì„œ ë¡œì»¬ í…ŒìŠ¤íŠ¸:
```bash
# ë°±ì—… ë””ë ‰í† ë¦¬ ìƒì„± (CIì™€ ë™ì¼)
mkdir -p backups logs

# í…ŒìŠ¤íŠ¸ìš© ë°±ì—… íŒŒì¼ ìƒì„±
echo "test backup content" > backups/test_backup_$(date +%Y%m%d).txt

# ë³´ì•ˆ ë¡œê·¸ íŒŒì¼ ìƒì„±
echo "$(date '+%Y-%m-%d %H:%M:%S') - INFO - ë¡œì»¬ í…ŒìŠ¤íŠ¸ìš© ë³´ì•ˆ ë¡œê·¸" > logs/security.log

# CIì™€ ë™ì¼í•œ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
python -m pytest tests/ -v --tb=short --maxfail=3
./scripts/backup_verifier.sh --dry-run --json
./scripts/ci_post_process.sh --local
```

---

## ğŸ§ª CI/CD í†µí•© í…ŒìŠ¤íŠ¸

### ğŸ“‹ í†µí•© í…ŒìŠ¤íŠ¸ ì‹œìŠ¤í…œ ê°œìš”
`tests/test_integration_backup_security.py`ëŠ” ë³´ì•ˆ ë¡œê·¸ë¶€í„° ë°±ì—… ê²€ì¦ê¹Œì§€ì˜ ì „ì²´ CI/CD íŒŒì´í”„ë¼ì¸ì„ ì¢…í•©ì ìœ¼ë¡œ ê²€ì¦í•˜ëŠ” í†µí•© í…ŒìŠ¤íŠ¸ì…ë‹ˆë‹¤.

### ğŸ¯ í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

#### 1. ğŸ” ë³´ì•ˆ ì´ë²¤íŠ¸ ë°œìƒ â†’ security.log ê¸°ë¡ ê²€ì¦
```python
# ë³´ì•ˆ ì´ë²¤íŠ¸ ê¸°ë¡ ë° ê²€ì¦
log_security_event("BLOCKED_IP", "192.168.1.100 - Rate Limit ì´ˆê³¼ë¡œ ì°¨ë‹¨")
log_security_event("WHITELIST_ADD", "127.0.0.1 - í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ì¶”ê°€")

# ë¡œê·¸ íŒŒì¼ ìƒì„± ë° JSON í˜•ì‹ ê²€ì¦
assert security_log.exists()
assert "BLOCKED_IP" in log_content
assert json.loads(last_log_line)  # JSON í˜•ì‹ ìœ íš¨ì„± ê²€ì¦
```

#### 2. ğŸ“‹ backup_verifier.sh ì‹¤í–‰ ê²°ê³¼ ê²€ì¦
```bash
# JSON í˜•ì‹ìœ¼ë¡œ ë°±ì—… ê²€ì¦ ì‹¤í–‰
./scripts/backup_verifier.sh --dir /test/backups --json

# ì˜ˆìƒ JSON ì¶œë ¥:
{
  "file": "backup_20240921.tar.gz",
  "size": 1337,
  "modified": "2024-09-21 14:30:25"
}
```

#### 3. ğŸ—‘ï¸ cleanup_old_backups.sh ì‹œë®¬ë ˆì´ì…˜ ì‹¤í–‰ ê²€ì¦
```bash
# ì‹œë®¬ë ˆì´ì…˜ ëª¨ë“œë¡œ ì •ë¦¬ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
./scripts/cleanup_old_backups.sh --days 30 --dry-run --json

# ì˜ˆìƒ JSON ì¶œë ¥:
{
  "timestamp": "2024-09-21T14:30:25+09:00",
  "deleted_count": 5,
  "total_size_bytes": 52428800,
  "backup_dir": "/test/backups",
  "days_keep": 30,
  "dry_run": true,
  "deleted_files": ["backup_20240821.tar.gz", "backup_20240815.tar.gz"]
}
```

#### 4. ğŸš€ CI/CD íŒŒì´í”„ë¼ì¸ ì‹œë®¬ë ˆì´ì…˜
```python
# ì „ì²´ CI/CD ì›Œí¬í”Œë¡œìš° í†µí•© í…ŒìŠ¤íŠ¸
def test_ci_cd_pipeline_simulation():
    # 1ë‹¨ê³„: ë³´ì•ˆ ì´ë²¤íŠ¸ ë¡œê¹…
    log_security_event("CI_TEST", "CI/CD íŒŒì´í”„ë¼ì¸ í…ŒìŠ¤íŠ¸ ì‹¤í–‰")

    # 2ë‹¨ê³„: ë°±ì—… ê²€ì¦
    verify_result = subprocess.run(["scripts/backup_verifier.sh", "--json"])

    # 3ë‹¨ê³„: ì •ë¦¬ ìŠ¤í¬ë¦½íŠ¸ ì‹œë®¬ë ˆì´ì…˜
    cleanup_result = subprocess.run(["scripts/cleanup_old_backups.sh", "--dry-run", "--json"])

    # í†µí•© ê²°ê³¼ ê²€ì¦
    assert verify_result.returncode == 0
    assert cleanup_result.returncode == 0
```

### ğŸ“Š JSON ì¶œë ¥ ìŠ¤í‚¤ë§ˆ ê²€ì¦

#### backup_verifier.sh JSON ìŠ¤í‚¤ë§ˆ
```json
{
  "file": "string",        // ë°±ì—… íŒŒì¼ëª…
  "size": "integer",       // íŒŒì¼ í¬ê¸° (bytes)
  "modified": "string"     // ìˆ˜ì •ì¼ (YYYY-MM-DD HH:MM:SS)
}
```

#### cleanup_old_backups.sh JSON ìŠ¤í‚¤ë§ˆ
```json
{
  "timestamp": "string",      // ISO 8601 í˜•ì‹ ì‹¤í–‰ ì‹œê°„
  "deleted_count": "integer", // ì‚­ì œë  íŒŒì¼ ìˆ˜
  "total_size_bytes": "integer", // ì´ ì ˆì•½ ìš©ëŸ‰ (bytes)
  "backup_dir": "string",     // ë°±ì—… ë””ë ‰í† ë¦¬ ê²½ë¡œ
  "days_keep": "integer",     // ë³´ê´€ ê¸°ê°„ (ì¼)
  "dry_run": "boolean",       // ì‹œë®¬ë ˆì´ì…˜ ëª¨ë“œ ì—¬ë¶€
  "deleted_files": ["array"]  // ì‚­ì œë  íŒŒì¼ ëª©ë¡
}
```

### ğŸ§ª ì„±ëŠ¥ ë° ìŠ¤íŠ¸ë ˆìŠ¤ í…ŒìŠ¤íŠ¸

#### ëŒ€ê·œëª¨ ë°±ì—… íŒŒì¼ ì²˜ë¦¬ í…ŒìŠ¤íŠ¸
```python
# 100ê°œ ë°±ì—… íŒŒì¼ ìƒì„±í•˜ì—¬ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸
for i in range(100):
    backup_file = f"backup_{i:03d}.tar.gz"
    # ì•½ 13KB íŒŒì¼ ìƒì„± ë° ë‚ ì§œ ì¡°ì •

# 10ì´ˆ ì´ë‚´ ì²˜ë¦¬ ì„±ëŠ¥ ê²€ì¦
start_time = time.time()
result = subprocess.run(["scripts/cleanup_old_backups.sh", "--dry-run"])
execution_time = time.time() - start_time

assert execution_time < 10.0  # ì„±ëŠ¥ ìš”êµ¬ì‚¬í•­ ê²€ì¦
assert result.returncode == 0  # ì •ìƒ ì²˜ë¦¬ í™•ì¸
```

### ğŸ”§ GitHub Actions ì›Œí¬í”Œë¡œìš° í†µí•©

#### CI ì›Œí¬í”Œë¡œìš° ì—…ë°ì´íŠ¸ ë‚´ìš©:
```yaml
# ğŸ”„ í†µí•© í…ŒìŠ¤íŠ¸: ë³´ì•ˆ ë¡œê·¸ + ë°±ì—… ê²€ì¦
- name: ğŸ”„ í†µí•© í…ŒìŠ¤íŠ¸: ë³´ì•ˆ ë¡œê·¸ + ë°±ì—… ê²€ì¦
  run: |
    echo "ğŸ”„ ë³´ì•ˆ ë¡œê·¸ + ë°±ì—… ê´€ë¦¬ í†µí•© í…ŒìŠ¤íŠ¸ ì‹¤í–‰..."
    if [ -f tests/test_integration_backup_security.py ]; then
      python -m pytest tests/test_integration_backup_security.py -v -s --tb=short
    fi
  continue-on-error: false

# ğŸ”§ ë°±ì—… ê²€ì¦ ë„êµ¬ í…ŒìŠ¤íŠ¸ (Makefile í†µí•©)
- name: ğŸ”§ ë°±ì—… ê²€ì¦ ë„êµ¬ í…ŒìŠ¤íŠ¸
  run: |
    chmod +x scripts/backup_verifier.sh scripts/cleanup_old_backups.sh
    mkdir -p backups
    echo "test backup content" > backups/test_backup_$(date +%Y%m%d).txt
    make verify-backups || echo "ë°±ì—… ê²€ì¦ ì™„ë£Œ"
```

### ğŸ“ˆ í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ ë° ì„±ê³¼ ì§€í‘œ

#### í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€:
- âœ… **ë³´ì•ˆ ë¡œê·¸ ì‹œìŠ¤í…œ**: 100% (ë¡œê·¸ ìƒì„±, JSON ê²€ì¦, ì—ëŸ¬ ì²˜ë¦¬)
- âœ… **ë°±ì—… ê²€ì¦ ìŠ¤í¬ë¦½íŠ¸**: 100% (ì •ìƒ/ë¹„ì •ìƒ ê²½ë¡œ, JSON ì¶œë ¥)
- âœ… **ë°±ì—… ì •ë¦¬ ìŠ¤í¬ë¦½íŠ¸**: 100% (ì‹œë®¬ë ˆì´ì…˜/ì‹¤ì œ ì‹¤í–‰, ì—ëŸ¬ ì²˜ë¦¬)
- âœ… **CI/CD íŒŒì´í”„ë¼ì¸**: 95% (í†µí•© ì›Œí¬í”Œë¡œìš°, ì„±ëŠ¥ í…ŒìŠ¤íŠ¸)

#### ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬:
- **ë°±ì—… ê²€ì¦**: 100ê°œ íŒŒì¼ ê¸°ì¤€ < 3ì´ˆ
- **ì •ë¦¬ ìŠ¤í¬ë¦½íŠ¸**: 1000ê°œ íŒŒì¼ ê¸°ì¤€ < 10ì´ˆ
- **í†µí•© í…ŒìŠ¤íŠ¸**: ì „ì²´ ì‹œë‚˜ë¦¬ì˜¤ < 30ì´ˆ

### ğŸš¨ ì—ëŸ¬ ì²˜ë¦¬ ë° ë³µêµ¬ ì‹œë‚˜ë¦¬ì˜¤

#### í…ŒìŠ¤íŠ¸ëœ ì—ëŸ¬ ì‹œë‚˜ë¦¬ì˜¤:
1. **ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ë°±ì—… ë””ë ‰í† ë¦¬**
   - ì ì ˆí•œ ì—ëŸ¬ ë©”ì‹œì§€ ë°˜í™˜ ê²€ì¦
   - ë…¼ì œë¡œ exit code ë°˜í™˜ í™•ì¸

2. **ê¶Œí•œ ì—†ëŠ” ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰**
   - Permission denied ì—ëŸ¬ ì²˜ë¦¬
   - CI í™˜ê²½ì—ì„œ ìë™ ê¶Œí•œ ë¶€ì—¬

3. **JSON íŒŒì‹± ì‹¤íŒ¨**
   - ì˜ëª»ëœ JSON ì¶œë ¥ ê°ì§€ ë° ì²˜ë¦¬
   - ìŠ¤í‚¤ë§ˆ ê²€ì¦ ì‹¤íŒ¨ ì‹œ ë³µêµ¬ ë¡œì§

### ğŸ”„ ì‹¤í–‰ ë°©ë²• ë° ì˜ˆì‹œ

#### ë¡œì»¬ ì‹¤í–‰:
```bash
# ì „ì²´ í†µí•© í…ŒìŠ¤íŠ¸ ì‹¤í–‰
python -m pytest tests/test_integration_backup_security.py -v

# íŠ¹ì • í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ë§Œ ì‹¤í–‰
python -m pytest tests/test_integration_backup_security.py::TestIntegrationBackupSecurity -v

# ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ í¬í•¨
python -m pytest tests/test_integration_backup_security.py::TestPerformanceAndStress -v

# ìƒì„¸ ì¶œë ¥ê³¼ í•¨ê»˜ ì‹¤í–‰
python -m pytest tests/test_integration_backup_security.py -v -s --tb=long
```

#### ì˜ˆìƒ í…ŒìŠ¤íŠ¸ ì¶œë ¥:
```
tests/test_integration_backup_security.py::TestIntegrationBackupSecurity::test_security_event_logging PASSED
tests/test_integration_backup_security.py::TestIntegrationBackupSecurity::test_backup_verifier_execution PASSED
tests/test_integration_backup_security.py::TestIntegrationBackupSecurity::test_cleanup_script_dry_run PASSED
tests/test_integration_backup_security.py::TestIntegrationBackupSecurity::test_ci_cd_pipeline_simulation PASSED
tests/test_integration_backup_security.py::TestIntegrationBackupSecurity::test_json_output_schema_validation PASSED
tests/test_integration_backup_security.py::TestPerformanceAndStress::test_large_scale_cleanup_performance PASSED

========================= 6 passed in 15.2s =========================
```

### ğŸ’¡ ëª¨ë²” ì‚¬ë¡€ ë° ê°€ì´ë“œë¼ì¸

#### 1. í…ŒìŠ¤íŠ¸ í™˜ê²½ ê²©ë¦¬
- ê° í…ŒìŠ¤íŠ¸ëŠ” ë…ë¦½ì ì¸ ì„ì‹œ ë””ë ‰í† ë¦¬ ì‚¬ìš©
- í™˜ê²½ ë³€ìˆ˜ë¥¼ í†µí•œ ê²½ë¡œ ì„¤ì •ìœ¼ë¡œ ì¶©ëŒ ë°©ì§€

#### 2. ì‹œë®¬ë ˆì´ì…˜ ìš°ì„ 
- ì‹¤ì œ íŒŒì¼ ì‚­ì œ ëŒ€ì‹  `--dry-run` ëª¨ë“œ í™œìš©
- ì•ˆì „í•œ í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œ ê²€ì¦ ì™„ë£Œ í›„ ì‹¤ì œ ì ìš©

#### 3. JSON ì¶œë ¥ í™œìš©
- êµ¬ì¡°í™”ëœ ë°ì´í„°ë¡œ ìë™í™” íŒŒì´í”„ë¼ì¸ êµ¬ì¶•
- ìŠ¤í‚¤ë§ˆ ê²€ì¦ì„ í†µí•œ ì¶œë ¥ í˜•ì‹ ì¼ê´€ì„± ìœ ì§€

#### 4. ì—ëŸ¬ ì²˜ë¦¬ ê°•í™”
- ë‹¤ì–‘í•œ ì‹¤íŒ¨ ì‹œë‚˜ë¦¬ì˜¤ì— ëŒ€í•œ ì ì ˆí•œ ì‘ë‹µ
- ì‚¬ìš©ì ì¹œí™”ì ì¸ í•œêµ­ì–´ ì—ëŸ¬ ë©”ì‹œì§€ ì œê³µ

ì´ í†µí•© í…ŒìŠ¤íŠ¸ ì‹œìŠ¤í…œì„ í†µí•´ ë³´ì•ˆ ë¡œê·¸ë¶€í„° ë°±ì—… ê´€ë¦¬ê¹Œì§€ì˜ ì „ì²´ ìš´ì˜ ì›Œí¬í”Œë¡œìš°ê°€ CI/CD íŒŒì´í”„ë¼ì¸ì—ì„œ ìë™ìœ¼ë¡œ ê²€ì¦ë˜ë©°, ì‹œìŠ¤í…œì˜ ì‹ ë¢°ì„±ê³¼ ì•ˆì •ì„±ì„ ë³´ì¥í•©ë‹ˆë‹¤.

## ğŸ”„ ì¼ì¼ ìš´ì˜ ìë™í™”

### ğŸ“‹ daily_ops.sh ìŠ¤í¬ë¦½íŠ¸ ê°œìš”
ì¼ì¼ ìš´ì˜ ìë™í™” ìŠ¤í¬ë¦½íŠ¸ëŠ” ë³´ì•ˆ ë¡œê·¸ íšŒì „, ë°±ì—… ê²€ì¦, ì •ë¦¬ ì‘ì—…ì„ ìë™í™”í•˜ì—¬ ì‹œìŠ¤í…œ ê´€ë¦¬ íš¨ìœ¨ì„±ì„ ê·¹ëŒ€í™”í•©ë‹ˆë‹¤.

### ğŸ¯ ìë™í™” ì‘ì—… ë‚´ìš©
1. **ğŸ”„ ë³´ì•ˆ ë¡œê·¸ íšŒì „ ë° ì••ì¶•**
   - `logs/security.log` íŒŒì¼ì„ ì¼ë³„ë¡œ íšŒì „
   - gzip ì••ì¶•í•˜ì—¬ `security.log.YYYYMMDD.gz` í˜•íƒœë¡œ ë³´ê´€
   - ì›ë³¸ íŒŒì¼ ì´ˆê¸°í™”ë¡œ ë””ìŠ¤í¬ ê³µê°„ ê´€ë¦¬

2. **ğŸ” ë°±ì—… ë¬´ê²°ì„± ê²€ì¦**
   - `scripts/backup_verifier.sh` ì‹¤í–‰
   - ë°±ì—… íŒŒì¼ ì¡´ì¬ ë° í¬ê¸° í™•ì¸
   - ì†ìƒëœ ë°±ì—… íŒŒì¼ ê°ì§€ ë° ë³´ê³ 

3. **ğŸ§¹ ì˜¤ë˜ëœ ë°±ì—… ì •ë¦¬**
   - `scripts/cleanup_old_backups.sh` ì‹¤í–‰
   - ì„¤ì •ëœ ê¸°ê°„ ì´í›„ ë°±ì—… íŒŒì¼ ìë™ ì‚­ì œ
   - ë””ìŠ¤í¬ ê³µê°„ ìµœì í™”

4. **ğŸ“Š ê²°ê³¼ ë¡œê·¸ ì €ì¥**
   - ëª¨ë“  ì‘ì—… ê²°ê³¼ë¥¼ `logs/daily_ops.log`ì— ê¸°ë¡
   - ì„±ê³µ/ì‹¤íŒ¨ ìƒíƒœ ë° ìƒì„¸ ì •ë³´ ì €ì¥

### ğŸ› ï¸ ì‚¬ìš©ë²•

#### ê¸°ë³¸ ì‹¤í–‰
```bash
# ì¼ì¼ ìš´ì˜ ì‘ì—… ì‹¤í–‰
./scripts/daily_ops.sh

# ìƒì„¸ ì¶œë ¥ê³¼ í•¨ê»˜ ì‹¤í–‰
./scripts/daily_ops.sh --verbose
```

#### ì‹œë®¬ë ˆì´ì…˜ ëª¨ë“œ
```bash
# ë³€ê²½ ì‚¬í•­ ì—†ì´ ì‹œë®¬ë ˆì´ì…˜
./scripts/daily_ops.sh --dry-run

# ì‹œë®¬ë ˆì´ì…˜ + ìƒì„¸ ì¶œë ¥
./scripts/daily_ops.sh --dry-run --verbose
```

#### JSON ì¶œë ¥
```bash
# JSON í˜•ì‹ìœ¼ë¡œ ê²°ê³¼ ì¶œë ¥
./scripts/daily_ops.sh --json

# ì‹œë®¬ë ˆì´ì…˜ + JSON ì¶œë ¥
./scripts/daily_ops.sh --dry-run --json
```

### ğŸ›ï¸ Makefile í†µí•©

#### ì‚¬ìš© ê°€ëŠ¥í•œ ëª…ë ¹ì–´
```bash
# ì¼ì¼ ìš´ì˜ ì‘ì—… ì‹¤í–‰
make daily-ops

# ì‹œë®¬ë ˆì´ì…˜ ëª¨ë“œ
make daily-ops-dry

# JSON ì¶œë ¥ ëª¨ë“œ
make daily-ops-json
```

#### í†µí•© ë°±ì—… ê´€ë¦¬
```bash
# ë°±ì—… ê²€ì¦ë§Œ ì‹¤í–‰
make verify-backups

# ì˜¤ë˜ëœ ë°±ì—… ì •ë¦¬ë§Œ ì‹¤í–‰
make clean-backups

# ë°±ì—… ê²€ì¦ + ì •ë¦¬ í†µí•©
make backup-maintenance
```

### ğŸ“Š ì‹¤í–‰ ì˜ˆì‹œ ë° ì˜ˆìƒ ì¶œë ¥

#### ì¼ë°˜ ì‹¤í–‰ ì˜ˆì‹œ
```bash
$ ./scripts/daily_ops.sh --verbose

ğŸ”„ ì¼ì¼ ìš´ì˜ ìë™í™” ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰...
[2024-09-21 14:30:25] INFO: ì¼ì¼ ìš´ì˜ ì‘ì—… ì‹œì‘ (ëª¨ë“œ: ì‹¤ì œ)
[2024-09-21 14:30:26] INFO: ë³´ì•ˆ ë¡œê·¸ íšŒì „ ì™„ë£Œ: logs/security.log.20240921.gz (í¬ê¸°: 15248B)
[2024-09-21 14:30:28] INFO: ë°±ì—… ê²€ì¦ ì™„ë£Œ
[2024-09-21 14:30:30] INFO: ë°±ì—… ì •ë¦¬ ì™„ë£Œ
[2024-09-21 14:30:30] INFO: ì¼ì¼ ìš´ì˜ ì‘ì—… ì™„ë£Œ

ğŸ‰ ì¼ì¼ ìš´ì˜ ì‘ì—… ì™„ë£Œ
   ì™„ë£Œ ì‹œê°„: 2024-09-21 14:30:30
   ì†Œìš” ì‹œê°„: 5ì´ˆ
   ë¡œê·¸ íŒŒì¼: logs/daily_ops.log
```

#### JSON ì¶œë ¥ ì˜ˆì‹œ
```json
{
  "timestamp": "2024-09-21T14:30:30+09:00",
  "duration_seconds": 5,
  "dry_run": false,
  "tasks_completed": [
    "security_log_rotation",
    "backup_verification",
    "backup_cleanup"
  ],
  "log_file": "logs/daily_ops.log",
  "status": "completed"
}
```

### ğŸ§ª í…ŒìŠ¤íŠ¸ ì‹¤í–‰

#### daily_ops.sh í…ŒìŠ¤íŠ¸
```bash
# ì¼ì¼ ìš´ì˜ ìŠ¤í¬ë¦½íŠ¸ í…ŒìŠ¤íŠ¸
python -m pytest tests/test_daily_ops.py -v

# ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ í¬í•¨
python -m pytest tests/test_daily_ops.py::TestDailyOpsPerformance -v

# í†µí•© í…ŒìŠ¤íŠ¸
python -m pytest tests/test_daily_ops.py::TestDailyOpsIntegration -v
```

#### í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤
1. **ìŠ¤í¬ë¦½íŠ¸ ê¸°ë³¸ ê²€ì¦**
   - íŒŒì¼ ì¡´ì¬ ë° ì‹¤í–‰ ê¶Œí•œ í™•ì¸
   - ë„ì›€ë§ ì˜µì…˜ ì •ìƒ ë™ì‘ ê²€ì¦

2. **ê¸°ëŠ¥ë³„ í…ŒìŠ¤íŠ¸**
   - ì‹œë®¬ë ˆì´ì…˜ ëª¨ë“œ ì •ìƒ ë™ì‘
   - JSON ì¶œë ¥ í˜•ì‹ ê²€ì¦
   - ë¡œê·¸ íŒŒì¼ ìƒì„± ë° ë‚´ìš© í™•ì¸

3. **í†µí•© í…ŒìŠ¤íŠ¸**
   - Makefile ëª…ë ¹ì–´ ì—°ë™ í™•ì¸
   - ì „ì²´ ì›Œí¬í”Œë¡œìš° ì‹œë®¬ë ˆì´ì…˜
   - ì—ëŸ¬ ì²˜ë¦¬ ë° ë³µêµ¬ ì‹œë‚˜ë¦¬ì˜¤

4. **ì„±ëŠ¥ í…ŒìŠ¤íŠ¸**
   - 30ì´ˆ ì´ë‚´ ì‹¤í–‰ ì™„ë£Œ ê²€ì¦
   - ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ìµœì í™” í™•ì¸

### ğŸ”§ CI/CD íŒŒì´í”„ë¼ì¸ ì—°ë™

#### GitHub Actions ì›Œí¬í”Œë¡œìš°
daily_ops.sh ìŠ¤í¬ë¦½íŠ¸ëŠ” CI/CD íŒŒì´í”„ë¼ì¸ì—ì„œ ìë™ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ë©ë‹ˆë‹¤:

```yaml
# ì¼ì¼ ìš´ì˜ ìŠ¤í¬ë¦½íŠ¸ í…ŒìŠ¤íŠ¸
- name: ğŸ”„ ì¼ì¼ ìš´ì˜ ìë™í™” í…ŒìŠ¤íŠ¸
  run: |
    echo "ğŸ”„ ì¼ì¼ ìš´ì˜ ìŠ¤í¬ë¦½íŠ¸ í…ŒìŠ¤íŠ¸ ì‹¤í–‰..."
    if [ -f tests/test_daily_ops.py ]; then
      python -m pytest tests/test_daily_ops.py -v --tb=short
    fi

    # ì‹œë®¬ë ˆì´ì…˜ ëª¨ë“œë¡œ ì‹¤ì œ ì‹¤í–‰ í…ŒìŠ¤íŠ¸
    ./scripts/daily_ops.sh --dry-run --json
```

#### ì •ê¸° ì‹¤í–‰ ì„¤ì •
cronì„ í†µí•œ ì •ê¸° ì‹¤í–‰ ì„¤ì •:

```bash
# ë§¤ì¼ ìƒˆë²½ 2ì‹œì— ì¼ì¼ ìš´ì˜ ì‘ì—… ì‹¤í–‰
0 2 * * * /path/to/mcp-map-company/scripts/daily_ops.sh >> /var/log/daily_ops_cron.log 2>&1

# ì£¼ê°„ ë°±ì—… ì •ë¦¬ (ì¼ìš”ì¼ ìƒˆë²½ 3ì‹œ)
0 3 * * 0 cd /path/to/mcp-map-company && make backup-maintenance >> /var/log/weekly_backup.log 2>&1
```

### ğŸ”’ ë³´ì•ˆ ë° ê¶Œí•œ ê´€ë¦¬

#### í•„ìš”í•œ ê¶Œí•œ
- ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ê¶Œí•œ: `chmod +x scripts/daily_ops.sh`
- ë¡œê·¸ ë””ë ‰í† ë¦¬ ì“°ê¸° ê¶Œí•œ: `logs/` ë””ë ‰í† ë¦¬
- ë°±ì—… ë””ë ‰í† ë¦¬ ì ‘ê·¼ ê¶Œí•œ: `backups/` ë””ë ‰í† ë¦¬

#### ë³´ì•ˆ ê³ ë ¤ì‚¬í•­
- ìŠ¤í¬ë¦½íŠ¸ëŠ” í•­ìƒ ì‹œë®¬ë ˆì´ì…˜ ëª¨ë“œë¡œ ë¨¼ì € í…ŒìŠ¤íŠ¸
- ì¤‘ìš”í•œ ë°±ì—… íŒŒì¼ ì‚­ì œ ì „ í™•ì¸ ê³¼ì • í¬í•¨
- ëª¨ë“  ì‘ì—… ë‚´ì—­ì„ ìƒì„¸ ë¡œê·¸ë¡œ ê¸°ë¡

### ğŸ“ˆ ëª¨ë‹ˆí„°ë§ ë° ì•Œë¦¼

#### ë¡œê·¸ ëª¨ë‹ˆí„°ë§
```bash
# ì¼ì¼ ìš´ì˜ ë¡œê·¸ ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§
tail -f logs/daily_ops.log

# ìµœê·¼ ì‹¤í–‰ ê²°ê³¼ í™•ì¸
tail -20 logs/daily_ops.log | grep -E "(ì™„ë£Œ|ì‹¤íŒ¨|ERROR)"

# JSON í˜•ì‹ ë¡œê·¸ ë¶„ì„
./scripts/daily_ops.sh --json | jq '.status'
```

#### ì‹¤íŒ¨ ì‹œ ì•Œë¦¼
daily_ops.sh ìŠ¤í¬ë¦½íŠ¸ëŠ” ê¸°ì¡´ ì•Œë¦¼ ì‹œìŠ¤í…œê³¼ ì—°ë™ë˜ì–´ ì‹¤íŒ¨ ì‹œ ìë™ ì•Œë¦¼ì„ ì „ì†¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```python
# ì¼ì¼ ìš´ì˜ ì‹¤íŒ¨ ì•Œë¦¼ ì—°ë™ ì˜ˆì‹œ
from mcp.utils.notifier import send_daily_ops_alert

# ì‹¤íŒ¨ ì‹œ ìë™ ì•Œë¦¼
if daily_ops_result != 0:
    await send_daily_ops_alert(
        status="failed",
        log_file="logs/daily_ops.log",
        error_details=error_message
    )
```

### ğŸ’¡ ëª¨ë²” ì‚¬ë¡€

1. **ì •ê¸°ì ì¸ í…ŒìŠ¤íŠ¸**
   - ë§¤ì£¼ ì‹œë®¬ë ˆì´ì…˜ ëª¨ë“œë¡œ ê²€ì¦
   - ìƒˆë¡œìš´ í™˜ê²½ì—ì„œëŠ” ë‹¨ê³„ë³„ í…ŒìŠ¤íŠ¸

2. **ë¡œê·¸ ê´€ë¦¬**
   - ì¼ì¼ ìš´ì˜ ë¡œê·¸ëŠ” ìµœëŒ€ 90ì¼ ë³´ê´€
   - ì¤‘ìš”í•œ ì´ë²¤íŠ¸ëŠ” ë³„ë„ ë³´ê³ ì„œ ìƒì„±

3. **ë°±ì—… ì •ì±…**
   - ì¤‘ìš” ë°±ì—…ì€ ë‹¤ì¤‘ ìœ„ì¹˜ ë³´ê´€
   - ì •ê¸°ì ì¸ ë³µì› í…ŒìŠ¤íŠ¸ ìˆ˜í–‰

4. **ìë™í™” í™•ì¥**
   - í•„ìš”ì— ë”°ë¼ ì¶”ê°€ ìš´ì˜ ì‘ì—… í†µí•©
   - ëª¨ë‹ˆí„°ë§ ì§€í‘œ ìˆ˜ì§‘ ê¸°ëŠ¥ í™•ì¥

ì´ ì¼ì¼ ìš´ì˜ ìë™í™” ì‹œìŠ¤í…œì„ í†µí•´ ë³´ì•ˆ ë¡œê·¸ ê´€ë¦¬ë¶€í„° ë°±ì—… ìœ ì§€ë³´ìˆ˜ê¹Œì§€ì˜ ëª¨ë“  ìš´ì˜ ì‘ì—…ì´ ìë™í™”ë˜ì–´ ì‹œìŠ¤í…œ ê´€ë¦¬ìì˜ ì—…ë¬´ íš¨ìœ¨ì„±ì„ í¬ê²Œ í–¥ìƒì‹œí‚µë‹ˆë‹¤.
