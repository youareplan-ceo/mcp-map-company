<!DOCTYPE html>
<html lang="ko" class="">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow">
    <title>MCP-MAP 관리자 대시보드</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    animation: {
                        'pulse-slow': 'pulse 2s infinite',
                        'spin-slow': 'spin 2s linear infinite',
                        'shake': 'shake 0.5s ease-in-out'
                    },
                    keyframes: {
                        shake: {
                            '0%, 100%': { transform: 'translateX(0)' },
                            '25%': { transform: 'translateX(-5px)' },
                            '75%': { transform: 'translateX(5px)' }
                        }
                    }
                }
            }
        }
    </script>
    <style>
        .toggle-switch {
            position: relative;
            width: 50px;
            height: 24px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .toggle-switch.active {
            background: #10b981;
        }

        .toggle-switch::after {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            transition: transform 0.3s ease;
        }

        .toggle-switch.active::after {
            transform: translateX(26px);
        }

        .log-level-info { color: #10b981; }
        .log-level-warning { color: #f59e0b; }
        .log-level-error { color: #ef4444; }

        /* 운영 알림 필터 버튼 스타일 */
        .ops-filter-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: rgba(255, 255, 255, 0.8);
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .ops-filter-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            transform: translateY(-1px);
        }

        .ops-filter-btn.active {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            border-color: #3b82f6;
            color: white;
            box-shadow: 0 4px 8px rgba(59, 130, 246, 0.3);
        }

        /* Dark mode에서 운영 알림 필터 버튼 */
        .dark .ops-filter-btn {
            background: rgba(75, 85, 99, 0.6);
            border-color: rgba(107, 114, 128, 0.4);
            color: rgba(243, 244, 246, 0.8);
        }

        .dark .ops-filter-btn:hover {
            background: rgba(107, 114, 128, 0.8);
            color: #f3f4f6;
        }

        .dark .ops-filter-btn.active {
            background: linear-gradient(135deg, #3b82f6, #1e40af);
            border-color: #3b82f6;
            color: white;
        }

        /* Dark mode styles for charts */
        .dark .chart-container {
            background: rgba(31, 41, 55, 0.8);
        }

        .dark .chart-wrapper {
            background: rgba(17, 24, 39, 0.9);
        }

        /* Custom scrollbar for dark mode */
        .dark ::-webkit-scrollbar {
            width: 8px;
        }

        .dark ::-webkit-scrollbar-track {
            background: #374151;
        }

        .dark ::-webkit-scrollbar-thumb {
            background: #6b7280;
            border-radius: 4px;
        }

        .dark ::-webkit-scrollbar-thumb:hover {
            background: #9ca3af;
        }

        /* Transition for theme switch */
        * {
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
        }

        /* 날짜 필터 버튼 스타일 */
        .date-filter.active {
            background: linear-gradient(45deg, #3b82f6, #8b5cf6) !important;
            color: white !important;
        }

        /* 모달 애니메이션 */
        #alertDetailModal {
            transition: opacity 0.3s ease;
        }

        #alertDetailModal.show {
            display: flex !important;
            animation: modalFadeIn 0.3s ease;
        }

        @keyframes modalFadeIn {
            from {
                opacity: 0;
                transform: scale(0.95);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* 알림 항목 hover 효과 */
        .alert-item {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            cursor: pointer;
        }

        .alert-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-blue-900 via-purple-900 to-pink-900 dark:from-gray-900 dark:via-gray-800 dark:to-black transition-all duration-300">
    <!-- Header with Dark Mode Toggle -->
    <header class="bg-white/10 dark:bg-gray-800/30 backdrop-blur-md border-b border-white/20 dark:border-gray-700/50 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center space-x-4">
                    <h1 class="text-2xl font-bold text-white dark:text-gray-100">
                        🚀 MCP-MAP 관리자 대시보드
                    </h1>
                    <span id="connectionStatus" class="px-3 py-1 rounded-full text-xs font-medium bg-green-500/20 text-green-400">
                        연결 확인 중...
                    </span>
                </div>

                <!-- Dark Mode Toggle and Controls -->
                <div class="flex items-center space-x-4">
                    <!-- Dark Mode Toggle -->
                    <div class="flex items-center space-x-2">
                        <span class="text-sm text-white dark:text-gray-300">☀️</span>
                        <button id="darkModeToggle" class="toggle-switch" aria-label="다크모드 토글">
                        </button>
                        <span class="text-sm text-white dark:text-gray-300">🌙</span>
                    </div>

                    <!-- Auto Refresh Toggle -->
                    <div class="flex items-center space-x-2">
                        <span class="text-sm text-white dark:text-gray-300">자동 새로고침</span>
                        <button id="autoRefreshToggle" class="toggle-switch" aria-label="자동 새로고침 토글">
                        </button>
                    </div>

                    <!-- Manual Refresh -->
                    <button id="refreshBtn" class="bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors duration-200 flex items-center space-x-2">
                        <span>🔄</span>
                        <span>새로고침</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <div class="max-w-7xl mx-auto p-6 space-y-8">
        <!-- System Status Cards -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
            <!-- Health Status Card -->
            <div class="bg-white/10 dark:bg-gray-800/50 backdrop-blur-md rounded-xl p-6 border border-white/20 dark:border-gray-700/50">
                <div class="flex items-center justify-between">
                    <div>
                        <h3 class="text-white dark:text-gray-100 text-sm font-medium opacity-75">시스템 상태</h3>
                        <p id="healthStatus" class="text-white dark:text-gray-100 text-2xl font-bold mt-2">확인 중...</p>
                    </div>
                    <div class="text-3xl">🏥</div>
                </div>
            </div>

            <!-- API Status Card -->
            <div class="bg-white/10 dark:bg-gray-800/50 backdrop-blur-md rounded-xl p-6 border border-white/20 dark:border-gray-700/50">
                <div class="flex items-center justify-between">
                    <div>
                        <h3 class="text-white dark:text-gray-100 text-sm font-medium opacity-75">API 상태</h3>
                        <p id="apiStatus" class="text-white dark:text-gray-100 text-2xl font-bold mt-2">확인 중...</p>
                    </div>
                    <div class="text-3xl">🔌</div>
                </div>
            </div>

            <!-- Database Status Card -->
            <div class="bg-white/10 dark:bg-gray-800/50 backdrop-blur-md rounded-xl p-6 border border-white/20 dark:border-gray-700/50">
                <div class="flex items-center justify-between">
                    <div>
                        <h3 class="text-white dark:text-gray-100 text-sm font-medium opacity-75">데이터베이스</h3>
                        <p id="dbStatus" class="text-white dark:text-gray-100 text-2xl font-bold mt-2">확인 중...</p>
                    </div>
                    <div class="text-3xl">🗄️</div>
                </div>
            </div>

            <!-- Uptime Card -->
            <div class="bg-white/10 dark:bg-gray-800/50 backdrop-blur-md rounded-xl p-6 border border-white/20 dark:border-gray-700/50">
                <div class="flex items-center justify-between">
                    <div>
                        <h3 class="text-white dark:text-gray-100 text-sm font-medium opacity-75">가동 시간</h3>
                        <p id="uptime" class="text-white dark:text-gray-100 text-2xl font-bold mt-2">-</p>
                    </div>
                    <div class="text-3xl">⏱️</div>
                </div>
            </div>
        </div>

        <!-- Real-time Metrics Panel -->
        <div class="bg-white/10 dark:bg-gray-800/50 backdrop-blur-md rounded-xl p-6 border border-white/20 dark:border-gray-700/50">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-2xl font-bold text-white dark:text-gray-100 flex items-center">
                    <span class="mr-3">📊</span>
                    실시간 메트릭
                </h2>
                <div class="flex items-center space-x-4">
                    <div class="flex items-center text-white dark:text-gray-300 text-sm">
                        <div class="w-2 h-2 bg-green-400 rounded-full mr-2 animate-pulse"></div>
                        실시간 업데이트
                    </div>
                    <button id="refreshMetricsBtn" class="bg-white bg-opacity-20 dark:bg-gray-600 dark:bg-opacity-50 hover:bg-opacity-30 text-white dark:text-gray-100 px-4 py-2 rounded-lg transition-all duration-200 flex items-center">
                        <span class="mr-2">🔄</span>
                        메트릭 새로고침
                    </button>
                </div>
            </div>

            <!-- Metrics Summary Cards -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                <div class="bg-white/10 dark:bg-gray-700/50 rounded-lg p-4 backdrop-filter backdrop-blur-sm">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-white dark:text-gray-300 text-sm opacity-75">평균 응답시간</p>
                            <p class="text-white dark:text-gray-100 text-2xl font-bold" id="avgResponseTime">-</p>
                            <p class="text-white dark:text-gray-400 text-xs opacity-60">milliseconds</p>
                        </div>
                        <div class="text-3xl">⚡</div>
                    </div>
                </div>

                <div class="bg-white/10 dark:bg-gray-700/50 rounded-lg p-4 backdrop-filter backdrop-blur-sm">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-white dark:text-gray-300 text-sm opacity-75">DB 지연시간</p>
                            <p class="text-white dark:text-gray-100 text-2xl font-bold" id="dbLatency">-</p>
                            <p class="text-white dark:text-gray-400 text-xs opacity-60">milliseconds</p>
                        </div>
                        <div class="text-3xl">🗄️</div>
                    </div>
                </div>

                <div class="bg-white/10 dark:bg-gray-700/50 rounded-lg p-4 backdrop-filter backdrop-blur-sm">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-white dark:text-gray-300 text-sm opacity-75">활성 사용자</p>
                            <p class="text-white dark:text-gray-100 text-2xl font-bold" id="activeUsers">-</p>
                            <p class="text-white dark:text-gray-400 text-xs opacity-60">last 5 minutes</p>
                        </div>
                        <div class="text-3xl">👥</div>
                    </div>
                </div>

                <div class="bg-white/10 dark:bg-gray-700/50 rounded-lg p-4 backdrop-filter backdrop-blur-sm">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-white dark:text-gray-300 text-sm opacity-75">시스템 CPU</p>
                            <p class="text-white dark:text-gray-100 text-2xl font-bold" id="systemCpu">-</p>
                            <p class="text-white dark:text-gray-400 text-xs opacity-60">percentage</p>
                        </div>
                        <div class="text-3xl">💻</div>
                    </div>
                </div>
            </div>

            <!-- Charts Grid -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- Response Time Trend Chart -->
                <div class="bg-white/10 dark:bg-gray-700/50 rounded-lg p-4 backdrop-filter backdrop-blur-sm chart-container">
                    <h3 class="text-white dark:text-gray-100 text-lg font-semibold mb-4 flex items-center">
                        <span class="mr-2">📈</span>
                        응답시간 추이
                    </h3>
                    <div class="relative chart-wrapper" style="height: 250px;">
                        <canvas id="realTimeResponseChart"></canvas>
                    </div>
                </div>

                <!-- System Resource Gauge -->
                <div class="bg-white/10 dark:bg-gray-700/50 rounded-lg p-4 backdrop-filter backdrop-blur-sm chart-container">
                    <h3 class="text-white dark:text-gray-100 text-lg font-semibold mb-4 flex items-center">
                        <span class="mr-2">🎯</span>
                        시스템 리소스
                    </h3>
                    <div class="relative chart-wrapper" style="height: 250px;">
                        <canvas id="systemResourceGauge"></canvas>
                    </div>
                </div>

                <!-- DB Performance Chart -->
                <div class="bg-white/10 dark:bg-gray-700/50 rounded-lg p-4 backdrop-filter backdrop-blur-sm chart-container">
                    <h3 class="text-white dark:text-gray-100 text-lg font-semibold mb-4 flex items-center">
                        <span class="mr-2">🗄️</span>
                        DB 성능 모니터
                    </h3>
                    <div class="relative chart-wrapper" style="height: 250px;">
                        <canvas id="dbPerformanceChart"></canvas>
                    </div>
                </div>

                <!-- API Call Distribution -->
                <div class="bg-white/10 dark:bg-gray-700/50 rounded-lg p-4 backdrop-filter backdrop-blur-sm chart-container">
                    <h3 class="text-white dark:text-gray-100 text-lg font-semibold mb-4 flex items-center">
                        <span class="mr-2">🔄</span>
                        API 호출 분포
                    </h3>
                    <div class="relative chart-wrapper" style="height: 250px;">
                        <canvas id="apiCallsChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- Recent Alerts Panel -->
        <div class="bg-white/10 dark:bg-gray-800/50 backdrop-blur-md rounded-xl p-6 border border-white/20 dark:border-gray-700/50">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-xl font-bold text-white dark:text-gray-100 flex items-center">
                    <span class="mr-3">🔔</span>
                    최근 알림
                </h2>
                <div class="flex gap-3">
                    <button id="refreshAlertsBtn" class="bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors duration-200 flex items-center">
                        <span class="mr-2">🔄</span>
                        새로고침
                    </button>
                    <button id="testAlertBtn" class="bg-green-600 hover:bg-green-700 dark:bg-green-500 dark:hover:bg-green-600 text-white px-4 py-2 rounded-lg transition-colors duration-200 flex items-center">
                        <span class="mr-2">📢</span>
                        테스트 알림
                    </button>
                </div>
            </div>

            <!-- Alert Statistics Cards -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                <div class="bg-red-500/20 dark:bg-red-600/20 border border-red-400/30 rounded-lg p-4 text-center">
                    <div class="text-2xl mb-2">🚨</div>
                    <div class="text-red-300 dark:text-red-200 text-sm font-medium">Critical</div>
                    <div id="criticalCount" class="text-red-100 text-2xl font-bold">0</div>
                </div>
                <div class="bg-orange-500/20 dark:bg-orange-600/20 border border-orange-400/30 rounded-lg p-4 text-center">
                    <div class="text-2xl mb-2">❌</div>
                    <div class="text-orange-300 dark:text-orange-200 text-sm font-medium">Error</div>
                    <div id="errorCount" class="text-orange-100 text-2xl font-bold">0</div>
                </div>
                <div class="bg-yellow-500/20 dark:bg-yellow-600/20 border border-yellow-400/30 rounded-lg p-4 text-center">
                    <div class="text-2xl mb-2">⚠️</div>
                    <div class="text-yellow-300 dark:text-yellow-200 text-sm font-medium">Warning</div>
                    <div id="warningCount" class="text-yellow-100 text-2xl font-bold">0</div>
                </div>
                <div class="bg-blue-500/20 dark:bg-blue-600/20 border border-blue-400/30 rounded-lg p-4 text-center">
                    <div class="text-2xl mb-2">ℹ️</div>
                    <div class="text-blue-300 dark:text-blue-200 text-sm font-medium">Info</div>
                    <div id="infoCount" class="text-blue-100 text-2xl font-bold">0</div>
                </div>
            </div>

            <!-- Alert Controls -->
            <div class="bg-black/20 dark:bg-gray-900/50 rounded-lg p-4 mb-4">
                <div class="flex flex-col gap-4">
                    <!-- 첫 번째 행: 검색 및 레벨 필터 -->
                    <div class="flex flex-col md:flex-row gap-4">
                        <!-- Search Box -->
                        <div class="flex-1">
                            <input
                                type="text"
                                id="alertSearch"
                                placeholder="알림 제목이나 메시지 검색..."
                                class="w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-blue-500"
                            />
                        </div>

                        <!-- Level Filter -->
                        <div>
                            <select
                                id="alertLevelFilter"
                                class="px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"
                            >
                                <option value="all">모든 레벨</option>
                                <option value="critical">🚨 Critical</option>
                                <option value="error">❌ Error</option>
                                <option value="warning">⚠️ Warning</option>
                                <option value="info">ℹ️ Info</option>
                            </select>
                        </div>

                        <!-- Clear Filters -->
                        <div>
                            <button
                                id="clearFiltersBtn"
                                class="px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg transition-colors duration-200"
                            >
                                필터 초기화
                            </button>
                        </div>
                    </div>

                    <!-- 두 번째 행: 날짜 필터 및 내보내기 -->
                    <div class="flex flex-col md:flex-row gap-4 items-center">
                        <!-- Date Filters -->
                        <div class="flex gap-2">
                            <button
                                id="dateFilterToday"
                                class="px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors duration-200 text-sm date-filter active"
                                data-filter="today"
                            >
                                📅 오늘
                            </button>
                            <button
                                id="dateFilter7days"
                                class="px-3 py-2 bg-white/10 hover:bg-white/20 text-white rounded-lg transition-colors duration-200 text-sm date-filter"
                                data-filter="7days"
                            >
                                📅 7일
                            </button>
                            <button
                                id="dateFilter30days"
                                class="px-3 py-2 bg-white/10 hover:bg-white/20 text-white rounded-lg transition-colors duration-200 text-sm date-filter"
                                data-filter="30days"
                            >
                                📅 30일
                            </button>
                            <button
                                id="dateFilterAll"
                                class="px-3 py-2 bg-white/10 hover:bg-white/20 text-white rounded-lg transition-colors duration-200 text-sm date-filter"
                                data-filter="all"
                            >
                                📅 전체
                            </button>
                        </div>

                        <!-- Export Buttons -->
                        <div class="flex gap-2 ml-auto">
                            <button
                                id="exportAlertsJSON"
                                class="px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors duration-200 text-sm flex items-center"
                            >
                                📄 JSON 내보내기
                            </button>
                            <button
                                id="exportAlertsCSV"
                                class="px-4 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded-lg transition-colors duration-200 text-sm flex items-center"
                            >
                                📊 CSV 내보내기
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Recent Alerts List -->
            <div class="bg-black/20 dark:bg-gray-900/50 rounded-lg overflow-hidden">
                <div class="p-4 border-b border-white/10 dark:border-gray-700 flex justify-between items-center">
                    <h3 class="text-white dark:text-gray-100 font-semibold">
                        <span id="alertsListTitle">최근 알림</span>
                        <span id="alertsCount" class="ml-2 text-sm text-white/60">(0개)</span>
                    </h3>
                    <div class="text-sm text-white/60">
                        <span id="currentPageInfo">페이지 1 / 1</span>
                    </div>
                </div>
                <div id="alertsList" class="max-h-80 overflow-y-auto">
                    <!-- Alert items will be populated here -->
                    <div class="p-4 text-center text-white/60 dark:text-gray-400">
                        알림을 불러오는 중...
                    </div>
                </div>

                <!-- Pagination Controls -->
                <div id="alertsPagination" class="p-4 border-t border-white/10 dark:border-gray-700 flex justify-between items-center">
                    <div class="flex items-center gap-2">
                        <span class="text-white/60 text-sm">페이지당 표시:</span>
                        <select
                            id="alertsPerPageSelect"
                            class="px-2 py-1 bg-white/10 border border-white/20 rounded text-white text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
                        >
                            <option value="10">10개</option>
                            <option value="20" selected>20개</option>
                            <option value="50">50개</option>
                            <option value="100">100개</option>
                        </select>
                    </div>

                    <div class="flex items-center gap-2">
                        <button
                            id="prevPageBtn"
                            class="px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white rounded transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed"
                            disabled
                        >
                            ← 이전
                        </button>
                        <span id="pageNumbers" class="flex gap-1">
                            <!-- Page numbers will be populated here -->
                        </span>
                        <button
                            id="nextPageBtn"
                            class="px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white rounded transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed"
                            disabled
                        >
                            다음 →
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- System Resource Monitoring Panel -->
        <div class="bg-white/10 dark:bg-gray-800/50 backdrop-blur-md rounded-xl p-6 border border-white/20 dark:border-gray-700/50">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-2xl font-bold text-white dark:text-gray-100 flex items-center">
                    <span class="mr-3">🖥️</span>
                    시스템 자원 모니터링
                </h2>
                <div class="flex items-center space-x-4">
                    <div class="flex items-center text-white dark:text-gray-300 text-sm">
                        <div class="w-2 h-2 bg-blue-400 rounded-full mr-2 animate-pulse"></div>
                        실시간 모니터링
                    </div>
                    <button id="refreshSystemMetricsBtn" class="bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors duration-200 flex items-center">
                        <span class="mr-2">🔄</span>
                        자원 새로고침
                    </button>
                </div>
            </div>

            <!-- Resource Summary Cards -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                <!-- CPU 사용률 카드 -->
                <div class="bg-white/10 dark:bg-gray-700/50 rounded-lg p-4 backdrop-filter backdrop-blur-sm">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-white dark:text-gray-300 text-sm opacity-75">CPU 사용률</p>
                            <p class="text-white dark:text-gray-100 text-2xl font-bold" id="cpuUsagePercent">-</p>
                            <p class="text-white dark:text-gray-400 text-xs opacity-60">percentage</p>
                        </div>
                        <div class="text-3xl">🔥</div>
                    </div>
                    <!-- CPU 프로그레스 바 -->
                    <div class="mt-3 bg-gray-700 rounded-full h-2">
                        <div id="cpuProgressBar" class="bg-red-500 h-2 rounded-full transition-all duration-500" style="width: 0%"></div>
                    </div>
                </div>

                <!-- 메모리 사용률 카드 -->
                <div class="bg-white/10 dark:bg-gray-700/50 rounded-lg p-4 backdrop-filter backdrop-blur-sm">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-white dark:text-gray-300 text-sm opacity-75">메모리 사용률</p>
                            <p class="text-white dark:text-gray-100 text-2xl font-bold" id="memoryUsagePercent">-</p>
                            <p class="text-white dark:text-gray-400 text-xs opacity-60">percentage</p>
                        </div>
                        <div class="text-3xl">💾</div>
                    </div>
                    <!-- 메모리 프로그레스 바 -->
                    <div class="mt-3 bg-gray-700 rounded-full h-2">
                        <div id="memoryProgressBar" class="bg-blue-500 h-2 rounded-full transition-all duration-500" style="width: 0%"></div>
                    </div>
                </div>

                <!-- 디스크 사용률 카드 -->
                <div class="bg-white/10 dark:bg-gray-700/50 rounded-lg p-4 backdrop-filter backdrop-blur-sm">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-white dark:text-gray-300 text-sm opacity-75">디스크 사용률</p>
                            <p class="text-white dark:text-gray-100 text-2xl font-bold" id="diskUsagePercent">-</p>
                            <p class="text-white dark:text-gray-400 text-xs opacity-60">percentage</p>
                        </div>
                        <div class="text-3xl">💿</div>
                    </div>
                    <!-- 디스크 프로그레스 바 -->
                    <div class="mt-3 bg-gray-700 rounded-full h-2">
                        <div id="diskProgressBar" class="bg-green-500 h-2 rounded-full transition-all duration-500" style="width: 0%"></div>
                    </div>
                </div>

                <!-- 네트워크 I/O 카드 -->
                <div class="bg-white/10 dark:bg-gray-700/50 rounded-lg p-4 backdrop-filter backdrop-blur-sm">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-white dark:text-gray-300 text-sm opacity-75">네트워크 I/O</p>
                            <p class="text-white dark:text-gray-100 text-2xl font-bold" id="networkIORate">-</p>
                            <p class="text-white dark:text-gray-400 text-xs opacity-60">MB/s</p>
                        </div>
                        <div class="text-3xl">🌐</div>
                    </div>
                    <!-- 네트워크 업로드/다운로드 표시기 -->
                    <div class="mt-3 flex justify-between text-xs">
                        <span class="text-green-400">↑ <span id="networkUpload">0</span> MB/s</span>
                        <span class="text-blue-400">↓ <span id="networkDownload">0</span> MB/s</span>
                    </div>
                </div>
            </div>

            <!-- System Resource Charts Grid -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- CPU 사용률 추이 차트 -->
                <div class="bg-white/10 dark:bg-gray-700/50 rounded-lg p-4 backdrop-filter backdrop-blur-sm chart-container">
                    <h3 class="text-white dark:text-gray-100 text-lg font-semibold mb-4 flex items-center">
                        <span class="mr-2">🔥</span>
                        CPU 사용률 추이
                    </h3>
                    <div class="relative chart-wrapper" style="height: 250px;">
                        <canvas id="cpuUsageChart"></canvas>
                    </div>
                </div>

                <!-- 메모리 사용률 추이 차트 -->
                <div class="bg-white/10 dark:bg-gray-700/50 rounded-lg p-4 backdrop-filter backdrop-blur-sm chart-container">
                    <h3 class="text-white dark:text-gray-100 text-lg font-semibold mb-4 flex items-center">
                        <span class="mr-2">💾</span>
                        메모리 사용률 추이
                    </h3>
                    <div class="relative chart-wrapper" style="height: 250px;">
                        <canvas id="memoryUsageChart"></canvas>
                    </div>
                </div>

                <!-- 디스크 I/O 차트 -->
                <div class="bg-white/10 dark:bg-gray-700/50 rounded-lg p-4 backdrop-filter backdrop-blur-sm chart-container">
                    <h3 class="text-white dark:text-gray-100 text-lg font-semibold mb-4 flex items-center">
                        <span class="mr-2">💿</span>
                        디스크 I/O 추이
                    </h3>
                    <div class="relative chart-wrapper" style="height: 250px;">
                        <canvas id="diskIOChart"></canvas>
                    </div>
                </div>

                <!-- 네트워크 I/O 차트 -->
                <div class="bg-white/10 dark:bg-gray-700/50 rounded-lg p-4 backdrop-filter backdrop-blur-sm chart-container">
                    <h3 class="text-white dark:text-gray-100 text-lg font-semibold mb-4 flex items-center">
                        <span class="mr-2">🌐</span>
                        네트워크 I/O 추이
                    </h3>
                    <div class="relative chart-wrapper" style="height: 250px;">
                        <canvas id="networkIOChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- System Information Summary -->
            <div class="mt-6 bg-black/20 dark:bg-gray-900/50 rounded-lg p-4">
                <h3 class="text-white dark:text-gray-100 font-semibold mb-4 flex items-center">
                    <span class="mr-2">ℹ️</span>
                    시스템 정보 요약
                </h3>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <!-- 시스템 상태 -->
                    <div class="text-center">
                        <div class="text-2xl font-bold text-green-400" id="systemHealthScore">95</div>
                        <div class="text-white/60 text-sm">시스템 건강도</div>
                    </div>

                    <!-- 평균 부하 -->
                    <div class="text-center">
                        <div class="text-2xl font-bold text-blue-400" id="avgLoadLevel">0.5</div>
                        <div class="text-white/60 text-sm">평균 부하</div>
                    </div>

                    <!-- 활성 프로세스 -->
                    <div class="text-center">
                        <div class="text-2xl font-bold text-yellow-400" id="activeProcesses">245</div>
                        <div class="text-white/60 text-sm">활성 프로세스</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Security Panel -->
        <div class="bg-white/10 dark:bg-gray-800/50 backdrop-blur-md rounded-xl p-6 border border-white/20 dark:border-gray-700/50">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-xl font-bold text-white dark:text-gray-100 flex items-center">
                    <span class="mr-3">🔒</span>
                    보안 모니터링
                </h2>
                <div class="flex space-x-2">
                    <button id="refreshSecurityBtn" class="bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors duration-200 flex items-center">
                        <span class="mr-2">🔄</span>
                        새로고침
                    </button>
                    <button id="testSecurityAlertBtn" class="bg-yellow-600 hover:bg-yellow-700 dark:bg-yellow-500 dark:hover:bg-yellow-600 text-white px-4 py-2 rounded-lg transition-colors duration-200 flex items-center">
                        <span class="mr-2">🔔</span>
                        테스트 알림
                    </button>
                    <button id="exportSecurityLogBtn" class="bg-green-600 hover:bg-green-700 dark:bg-green-500 dark:hover:bg-green-600 text-white px-4 py-2 rounded-lg transition-colors duration-200 flex items-center">
                        <span class="mr-2">📁</span>
                        로그 내보내기
                    </button>
                </div>
            </div>

            <!-- Security Statistics Cards -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                <div class="bg-red-500/20 dark:bg-red-600/20 border border-red-400/30 rounded-lg p-4 text-center">
                    <div class="text-2xl mb-2">🚫</div>
                    <div class="text-red-300 dark:text-red-200 text-sm font-medium">차단된 IP</div>
                    <div id="blockedIpCount" class="text-red-100 text-2xl font-bold">0</div>
                </div>
                <div class="bg-yellow-500/20 dark:bg-yellow-600/20 border border-yellow-400/30 rounded-lg p-4 text-center">
                    <div class="text-2xl mb-2">⚠️</div>
                    <div class="text-yellow-300 dark:text-yellow-200 text-sm font-medium">Rate Limit 위반</div>
                    <div id="rateLimitViolations" class="text-yellow-100 text-2xl font-bold">0</div>
                </div>
                <div class="bg-green-500/20 dark:bg-green-600/20 border border-green-400/30 rounded-lg p-4 text-center">
                    <div class="text-2xl mb-2">✅</div>
                    <div class="text-green-300 dark:text-green-200 text-sm font-medium">화이트리스트</div>
                    <div id="whitelistCount" class="text-green-100 text-2xl font-bold">0</div>
                </div>
                <div class="bg-blue-500/20 dark:bg-blue-600/20 border border-blue-400/30 rounded-lg p-4 text-center">
                    <div class="text-2xl mb-2">👀</div>
                    <div class="text-blue-300 dark:text-blue-200 text-sm font-medium">모니터링 IP</div>
                    <div id="monitoredIpCount" class="text-blue-100 text-2xl font-bold">0</div>
                </div>
            </div>

            <!-- Security Charts and Lists Grid -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- Security Events Chart -->
                <div class="bg-white/10 dark:bg-gray-700/50 rounded-lg p-4 backdrop-filter backdrop-blur-sm">
                    <h3 class="text-white dark:text-gray-100 text-lg font-semibold mb-4 flex items-center">
                        <span class="mr-2">📊</span>
                        차단 이벤트 추이
                    </h3>
                    <div class="relative h-64">
                        <canvas id="securityEventsChart"></canvas>
                    </div>
                </div>

                <!-- Blocked IPs List -->
                <div class="bg-white/10 dark:bg-gray-700/50 rounded-lg p-4 backdrop-filter backdrop-blur-sm">
                    <h3 class="text-white dark:text-gray-100 text-lg font-semibold mb-4 flex items-center">
                        <span class="mr-2">🚫</span>
                        차단된 IP 목록
                    </h3>
                    <div id="blockedIpsList" class="max-h-64 overflow-y-auto space-y-2">
                        <div class="text-center text-white/60 dark:text-gray-400 py-8">
                            차단된 IP가 없습니다.
                        </div>
                    </div>
                </div>
            </div>

            <!-- IP Whitelist Management -->
            <div class="mt-6 bg-black/20 dark:bg-gray-900/50 rounded-lg p-4">
                <h3 class="text-white dark:text-gray-100 font-semibold mb-4 flex items-center">
                    <span class="mr-2">⚪</span>
                    IP 화이트리스트 관리
                </h3>
                <div class="flex flex-col sm:flex-row gap-3">
                    <input
                        type="text"
                        id="whitelistIpInput"
                        placeholder="IP 주소 입력 (예: 192.168.1.100)"
                        class="flex-1 bg-white/10 dark:bg-gray-800/50 border border-white/30 dark:border-gray-600 rounded-lg px-4 py-2 text-white dark:text-gray-100 placeholder-white/50 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    >
                    <button
                        id="addWhitelistBtn"
                        class="bg-green-600 hover:bg-green-700 dark:bg-green-500 dark:hover:bg-green-600 text-white px-6 py-2 rounded-lg transition-colors duration-200 flex items-center"
                    >
                        <span class="mr-2">➕</span>
                        추가
                    </button>
                </div>
                <div id="whitelistResult" class="mt-3 text-sm hidden"></div>
            </div>

            <!-- Security Alerts and Trends -->
            <div class="mt-6 bg-black/20 dark:bg-gray-900/50 rounded-lg p-4">
                <h3 class="text-white dark:text-gray-100 font-semibold mb-4 flex items-center">
                    <span class="mr-2">🔔</span>
                    실시간 보안 알림 설정
                </h3>

                <!-- Alert Settings -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                    <div class="space-y-3">
                        <h4 class="text-white dark:text-gray-200 text-sm font-medium">알림 채널 설정</h4>
                        <div class="space-y-2">
                            <label class="flex items-center space-x-2">
                                <input type="checkbox" id="enableSlackAlerts" class="rounded border-gray-300">
                                <span class="text-white dark:text-gray-300 text-sm">🔔 Slack 알림</span>
                            </label>
                            <label class="flex items-center space-x-2">
                                <input type="checkbox" id="enableDiscordAlerts" class="rounded border-gray-300">
                                <span class="text-white dark:text-gray-300 text-sm">🎮 Discord 알림</span>
                            </label>
                            <label class="flex items-center space-x-2">
                                <input type="checkbox" id="enableEmailAlerts" class="rounded border-gray-300">
                                <span class="text-white dark:text-gray-300 text-sm">📧 이메일 알림</span>
                            </label>
                        </div>
                    </div>

                    <div class="space-y-3">
                        <h4 class="text-white dark:text-gray-200 text-sm font-medium">알림 임계값 설정</h4>
                        <div class="space-y-2">
                            <label class="flex items-center justify-between">
                                <span class="text-white dark:text-gray-300 text-sm">차단 임계값:</span>
                                <input type="number" id="blockThreshold" value="100" min="1" max="1000"
                                       class="w-20 px-2 py-1 bg-white/10 border border-white/30 rounded text-white text-sm">
                            </label>
                            <label class="flex items-center justify-between">
                                <span class="text-white dark:text-gray-300 text-sm">알림 간격(분):</span>
                                <input type="number" id="alertInterval" value="5" min="1" max="60"
                                       class="w-20 px-2 py-1 bg-white/10 border border-white/30 rounded text-white text-sm">
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Recent Security Events -->
                <div class="border-t border-white/10 pt-4">
                    <h4 class="text-white dark:text-gray-200 text-sm font-medium mb-3">최근 보안 이벤트</h4>
                    <div id="recentSecurityEvents" class="space-y-2 max-h-32 overflow-y-auto">
                        <div class="text-center text-white/60 dark:text-gray-400 py-4">
                            보안 이벤트가 없습니다.
                        </div>
                    </div>
                </div>
            </div>

            <!-- Security Metrics Summary -->
            <div class="mt-6 bg-black/20 dark:bg-gray-900/50 rounded-lg p-4">
                <h3 class="text-white dark:text-gray-100 font-semibold mb-4 flex items-center">
                    <span class="mr-2">📊</span>
                    보안 지표 요약
                </h3>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <!-- Today's Stats -->
                    <div class="text-center">
                        <div class="text-2xl font-bold text-blue-400" id="todayBlocked">0</div>
                        <div class="text-white/60 text-sm">오늘 차단된 IP</div>
                    </div>

                    <!-- Average Response Time -->
                    <div class="text-center">
                        <div class="text-2xl font-bold text-green-400" id="avgResponseTime">0ms</div>
                        <div class="text-white/60 text-sm">평균 응답시간</div>
                    </div>

                    <!-- Security Score -->
                    <div class="text-center">
                        <div class="text-2xl font-bold text-yellow-400" id="securityScore">95</div>
                        <div class="text-white/60 text-sm">보안 점수</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 🔐 보안 로그 패널 -->
        <div class="bg-white/10 dark:bg-gray-800/50 backdrop-blur-md rounded-xl p-6 border border-white/20 dark:border-gray-700/50">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-xl font-bold text-white dark:text-gray-100 flex items-center">
                    <span class="mr-3">🔐</span>
                    보안 로그 모니터링
                </h2>
                <button id="refreshSecurityLogsBtn" class="bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors duration-200 flex items-center">
                    <span class="mr-2">🔄</span>
                    새로고침
                </button>
            </div>

            <!-- 보안 로그 통계 카드 -->
            <div class="grid grid-cols-4 gap-4 mb-6">
                <div class="bg-red-500/20 dark:bg-red-600/20 border border-red-400/30 rounded-lg p-4 text-center">
                    <div class="text-2xl mb-2">🚫</div>
                    <div class="text-red-300 dark:text-red-200 text-sm font-medium">차단된 IP</div>
                    <div id="securityLogBlockedIpCount" class="text-red-100 text-2xl font-bold">0</div>
                </div>
                <div class="bg-yellow-500/20 dark:bg-yellow-600/20 border border-yellow-400/30 rounded-lg p-4 text-center">
                    <div class="text-2xl mb-2">⚠️</div>
                    <div class="text-yellow-300 dark:text-yellow-200 text-sm font-medium">Rate Limit 위반</div>
                    <div id="securityLogRateLimitCount" class="text-yellow-100 text-2xl font-bold">0</div>
                </div>
                <div class="bg-green-500/20 dark:bg-green-600/20 border border-green-400/30 rounded-lg p-4 text-center">
                    <div class="text-2xl mb-2">✅</div>
                    <div class="text-green-300 dark:text-green-200 text-sm font-medium">화이트리스트</div>
                    <div id="securityLogWhitelistCount" class="text-green-100 text-2xl font-bold">0</div>
                </div>
                <div class="bg-blue-500/20 dark:bg-blue-600/20 border border-blue-400/30 rounded-lg p-4 text-center">
                    <div class="text-2xl mb-2">👀</div>
                    <div class="text-blue-300 dark:text-blue-200 text-sm font-medium">모니터링 IP</div>
                    <div id="securityLogMonitoringCount" class="text-blue-100 text-2xl font-bold">0</div>
                </div>
            </div>

            <!-- 보안 로그 차트 -->
            <div class="bg-white/10 dark:bg-gray-700/50 rounded-lg p-4 backdrop-filter backdrop-blur-sm mb-6">
                <h3 class="text-white dark:text-gray-100 text-lg font-semibold mb-4 flex items-center">
                    <span class="mr-2">📊</span>
                    보안 이벤트 추이
                </h3>
                <div class="relative chart-wrapper" style="height: 120px;">
                    <canvas id="securityChart"></canvas>
                </div>
            </div>

            <!-- 보안 로그 목록 -->
            <div class="bg-black/20 dark:bg-gray-900/50 rounded-lg overflow-hidden">
                <div class="p-4 border-b border-white/10 dark:border-gray-700 flex justify-between items-center">
                    <h3 class="text-white dark:text-gray-100 font-semibold">최근 보안 로그</h3>
                    <div class="text-sm text-white/60">실시간 업데이트</div>
                </div>
                <div id="securityLogList" class="max-h-64 overflow-y-auto text-sm">
                    <div class="p-4 text-center text-white/60 dark:text-gray-400">
                        보안 로그를 불러오는 중...
                    </div>
                </div>
            </div>
        </div>

        <!-- 🔔 운영 알림 통합 패널 -->
        <div class="bg-white/10 dark:bg-gray-800/50 backdrop-blur-md rounded-xl p-6 border border-white/20 dark:border-gray-700/50">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-xl font-bold text-white dark:text-gray-100 flex items-center">
                    <span class="mr-3">🔔</span>
                    운영 알림 통합
                </h2>
                <div class="flex items-center space-x-2">
                    <button id="refreshOpsNotificationsBtn" class="bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors duration-200 flex items-center">
                        <span class="mr-2">🔄</span>
                        새로고침
                    </button>
                    <button id="testOpsNotificationBtn" class="bg-yellow-600 hover:bg-yellow-700 dark:bg-yellow-500 dark:hover:bg-yellow-600 text-white px-4 py-2 rounded-lg transition-colors duration-200 flex items-center">
                        <span class="mr-2">🔔</span>
                        테스트 알림
                    </button>
                </div>
            </div>

            <!-- 통합 알림 통계 카드 -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                <div class="bg-red-500/20 dark:bg-red-600/20 border border-red-400/30 rounded-lg p-4 text-center">
                    <div class="text-2xl mb-2">🚨</div>
                    <div class="text-red-300 dark:text-red-200 text-sm font-medium">긴급 알림</div>
                    <div id="opsNotificationsCriticalCount" class="text-red-100 text-2xl font-bold">0</div>
                </div>
                <div class="bg-orange-500/20 dark:bg-orange-600/20 border border-orange-400/30 rounded-lg p-4 text-center">
                    <div class="text-2xl mb-2">❌</div>
                    <div class="text-orange-300 dark:text-orange-200 text-sm font-medium">오류 알림</div>
                    <div id="opsNotificationsErrorCount" class="text-orange-100 text-2xl font-bold">0</div>
                </div>
                <div class="bg-yellow-500/20 dark:bg-yellow-600/20 border border-yellow-400/30 rounded-lg p-4 text-center">
                    <div class="text-2xl mb-2">⚠️</div>
                    <div class="text-yellow-300 dark:text-yellow-200 text-sm font-medium">경고 알림</div>
                    <div id="opsNotificationsWarningCount" class="text-yellow-100 text-2xl font-bold">0</div>
                </div>
                <div class="bg-blue-500/20 dark:bg-blue-600/20 border border-blue-400/30 rounded-lg p-4 text-center">
                    <div class="text-2xl mb-2">ℹ️</div>
                    <div class="text-blue-300 dark:text-blue-200 text-sm font-medium">정보 알림</div>
                    <div id="opsNotificationsInfoCount" class="text-blue-100 text-2xl font-bold">0</div>
                </div>
            </div>

            <!-- 최근 운영 알림 목록 -->
            <div class="bg-black/20 dark:bg-gray-900/50 rounded-lg overflow-hidden">
                <div class="p-4 border-b border-white/10 dark:border-gray-700 flex justify-between items-center">
                    <h3 class="text-white dark:text-gray-100 font-semibold">최근 운영 알림</h3>
                    <div class="flex items-center space-x-2">
                        <div class="text-sm text-white/60">실시간 업데이트</div>
                        <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
                    </div>
                </div>
                <div id="opsNotificationsList" class="max-h-80 overflow-y-auto">
                    <div class="p-4 text-center text-white/60 dark:text-gray-400">
                        운영 알림을 불러오는 중...
                    </div>
                </div>
            </div>

            <!-- 소스별 필터 버튼 -->
            <div class="mt-4 flex flex-wrap gap-2">
                <button class="ops-filter-btn active" data-filter="all">
                    📊 전체
                </button>
                <button class="ops-filter-btn" data-filter="security">
                    🔒 보안
                </button>
                <button class="ops-filter-btn" data-filter="backup">
                    🔧 백업
                </button>
                <button class="ops-filter-btn" data-filter="system">
                    🖥️ 시스템
                </button>
            </div>
        </div>

        <!-- System Logs Panel -->
        <div class="bg-white/10 dark:bg-gray-800/50 backdrop-blur-md rounded-xl p-6 border border-white/20 dark:border-gray-700/50">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-xl font-bold text-white dark:text-gray-100 flex items-center">
                    <span class="mr-3">📋</span>
                    시스템 로그
                </h2>
                <button id="clearLogsBtn" class="bg-red-600 hover:bg-red-700 dark:bg-red-500 dark:hover:bg-red-600 text-white px-4 py-2 rounded-lg transition-colors duration-200">
                    로그 지우기
                </button>
            </div>
            <div id="logContainer" class="bg-black/20 dark:bg-gray-900/50 rounded-lg p-4 h-64 overflow-y-auto font-mono text-sm">
                <div class="text-green-400 dark:text-green-300">시스템 로그를 불러오는 중...</div>
            </div>
        </div>

        <!-- 📊 CI/CD 성능 리포트 패널 -->
        <div class="bg-white/10 dark:bg-gray-800/50 backdrop-blur-md rounded-xl p-6 border border-white/20 dark:border-gray-700/50">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-xl font-bold text-white dark:text-gray-100 flex items-center">
                    <span class="mr-3">📊</span>
                    CI/CD 성능 리포트
                </h2>
                <div class="flex items-center space-x-2">
                    <button id="refreshCIReportsBtn" class="bg-green-600 hover:bg-green-700 dark:bg-green-500 dark:hover:bg-green-600 text-white px-4 py-2 rounded-lg transition-colors duration-200 flex items-center">
                        <span class="mr-2">🔄</span>
                        새로고침
                    </button>
                    <button id="downloadCIReportMdBtn" class="bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors duration-200 flex items-center">
                        <span class="mr-2">📄</span>
                        Markdown
                    </button>
                    <button id="downloadCIReportJsonBtn" class="bg-purple-600 hover:bg-purple-700 dark:bg-purple-500 dark:hover:bg-purple-600 text-white px-4 py-2 rounded-lg transition-colors duration-200 flex items-center">
                        <span class="mr-2">📋</span>
                        JSON
                    </button>
                    <button id="toggleCIJsonViewBtn" class="bg-gray-600 hover:bg-gray-700 dark:bg-gray-500 dark:hover:bg-gray-600 text-white px-4 py-2 rounded-lg transition-colors duration-200 flex items-center">
                        <span class="mr-2">👁️</span>
                        JSON 보기
                    </button>
                </div>
            </div>

            <!-- CI/CD 성능 통계 카드 -->
            <div class="grid grid-cols-1 md:grid-cols-5 gap-4 mb-6">
                <!-- 성공률 카드 -->
                <div class="bg-green-500/20 dark:bg-green-600/20 border border-green-400/30 rounded-lg p-4 text-center">
                    <div class="text-2xl mb-2">✅</div>
                    <div class="text-green-300 dark:text-green-200 text-sm font-medium">성공률</div>
                    <div id="ciSuccessRate" class="text-green-100 text-2xl font-bold">-</div>
                    <div class="text-green-400 dark:text-green-300 text-xs">%</div>
                </div>

                <!-- 실패율 카드 (성능 이슈 하이라이트) -->
                <div id="ciFailureRateCard" class="bg-red-500/20 dark:bg-red-600/20 border border-red-400/30 rounded-lg p-4 text-center transition-all duration-300">
                    <div class="text-2xl mb-2">❌</div>
                    <div class="text-red-300 dark:text-red-200 text-sm font-medium">실패율</div>
                    <div id="ciFailureRate" class="text-red-100 text-2xl font-bold">-</div>
                    <div class="text-red-400 dark:text-red-300 text-xs">%</div>
                    <!-- 경고 표시 (실패율 >10% 시) -->
                    <div id="ciFailureWarning" class="hidden mt-2 text-xs text-red-200 bg-red-500/30 rounded px-2 py-1">
                        ⚠️ 임계값 초과
                    </div>
                </div>

                <!-- 평균 실행 시간 카드 -->
                <div class="bg-blue-500/20 dark:bg-blue-600/20 border border-blue-400/30 rounded-lg p-4 text-center">
                    <div class="text-2xl mb-2">⏱️</div>
                    <div class="text-blue-300 dark:text-blue-200 text-sm font-medium">평균 실행 시간</div>
                    <div id="ciAvgExecutionTime" class="text-blue-100 text-2xl font-bold">-</div>
                    <div class="text-blue-400 dark:text-blue-300 text-xs">분</div>
                </div>

                <!-- 총 실행 횟수 카드 -->
                <div class="bg-purple-500/20 dark:bg-purple-600/20 border border-purple-400/30 rounded-lg p-4 text-center">
                    <div class="text-2xl mb-2">🔄</div>
                    <div class="text-purple-300 dark:text-purple-200 text-sm font-medium">총 실행</div>
                    <div id="ciTotalRuns" class="text-purple-100 text-2xl font-bold">-</div>
                    <div class="text-purple-400 dark:text-purple-300 text-xs">개</div>
                </div>

                <!-- 최근 실행 날짜 카드 -->
                <div class="bg-gray-500/20 dark:bg-gray-600/20 border border-gray-400/30 rounded-lg p-4 text-center">
                    <div class="text-2xl mb-2">📅</div>
                    <div class="text-gray-300 dark:text-gray-200 text-sm font-medium">최근 실행</div>
                    <div id="ciLastExecution" class="text-gray-100 text-lg font-bold">-</div>
                    <div class="text-gray-400 dark:text-gray-300 text-xs">시간</div>
                </div>
            </div>

            <!-- CI/CD 성능 차트 -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                <!-- 최근 빌드 트렌드 차트 (Chart.js 라인 차트, 최근 10회 실행) -->
                <div class="bg-black/20 dark:bg-gray-900/50 rounded-lg p-4">
                    <h3 class="text-white dark:text-gray-100 text-lg font-semibold mb-4 flex items-center">
                        <span class="mr-2">📈</span>
                        최근 빌드 트렌드 (최근 10회)
                    </h3>
                    <div class="relative" style="height: 280px;">
                        <canvas id="ciBuildTrendChart"></canvas>
                    </div>
                </div>

                <!-- 성공/실패 분포 도넛 차트 -->
                <div class="bg-black/20 dark:bg-gray-900/50 rounded-lg p-4">
                    <h3 class="text-white dark:text-gray-100 text-lg font-semibold mb-4 flex items-center">
                        <span class="mr-2">🍩</span>
                        성공/실패 분포
                    </h3>
                    <div class="relative" style="height: 280px;">
                        <canvas id="ciSuccessDistributionChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- 최근 CI 리포트 목록 -->
            <div class="bg-black/20 dark:bg-gray-900/50 rounded-lg overflow-hidden">
                <div class="p-4 border-b border-white/10 dark:border-gray-700 flex justify-between items-center">
                    <h3 class="text-white dark:text-gray-100 font-semibold">최근 CI 리포트</h3>
                    <div class="flex items-center space-x-2">
                        <!-- 상태 필터 버튼 -->
                        <button id="ciFilterAllBtn" class="ci-status-filter-btn bg-blue-600 text-white px-3 py-1 rounded-lg text-sm transition-colors duration-200">
                            전체
                        </button>
                        <button id="ciFilterSuccessBtn" class="ci-status-filter-btn bg-white/10 text-white/80 px-3 py-1 rounded-lg text-sm transition-colors duration-200">
                            성공
                        </button>
                        <button id="ciFilterFailureBtn" class="ci-status-filter-btn bg-white/10 text-white/80 px-3 py-1 rounded-lg text-sm transition-colors duration-200">
                            실패
                        </button>
                    </div>
                </div>

                <div id="ciReportsList" class="max-h-80 overflow-y-auto p-4 space-y-3">
                    <!-- CI 리포트 목록이 여기에 동적으로 추가됩니다 -->
                    <div class="text-center text-gray-400 py-8">
                        <div class="text-4xl mb-2">📊</div>
                        <div>CI 리포트 데이터를 로드하는 중...</div>
                    </div>
                </div>
            </div>

            <!-- JSON 보기 토글 섹션 (초기에는 숨김) -->
            <div id="ciJsonViewSection" class="hidden mt-6">
                <div class="bg-black/40 dark:bg-gray-900/60 rounded-lg p-4">
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="text-white dark:text-gray-100 font-semibold">JSON 데이터 원본</h4>
                        <button id="copyCIJsonBtn" class="bg-gray-600 hover:bg-gray-700 text-white px-3 py-1 rounded text-sm transition-colors duration-200">
                            📋 복사
                        </button>
                    </div>
                    <pre id="ciJsonContent" class="bg-gray-900 text-green-400 p-4 rounded overflow-x-auto text-sm max-h-64 overflow-y-auto"></pre>
                </div>
            </div>
        </div>

        <!-- 🚨 CI/CD 에러 로그 분석 패널 -->
        <div class="bg-white/10 dark:bg-gray-800/50 backdrop-blur-md rounded-xl p-6 border border-white/20 dark:border-gray-700/50">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-xl font-bold text-white dark:text-gray-100 flex items-center">
                    <span class="mr-3">🚨</span>
                    CI/CD 에러 로그 분석
                </h2>
                <div class="flex items-center space-x-2">
                    <button id="refreshErrorAnalysisBtn" class="bg-red-600 hover:bg-red-700 dark:bg-red-500 dark:hover:bg-red-600 text-white px-4 py-2 rounded-lg transition-colors duration-200 flex items-center">
                        <span class="mr-2">🔄</span>
                        새로고침
                    </button>
                    <button id="runErrorAnalysisBtn" class="bg-orange-600 hover:bg-orange-700 dark:bg-orange-500 dark:hover:bg-orange-600 text-white px-4 py-2 rounded-lg transition-colors duration-200 flex items-center">
                        <span class="mr-2">🔍</span>
                        분석 실행
                    </button>
                    <button id="downloadErrorReportBtn" class="bg-purple-600 hover:bg-purple-700 dark:bg-purple-500 dark:hover:bg-purple-600 text-white px-4 py-2 rounded-lg transition-colors duration-200 flex items-center">
                        <span class="mr-2">📥</span>
                        리포트 다운로드
                    </button>
                </div>
            </div>

            <!-- 에러 통계 카드 -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                <!-- 실패율 카드 -->
                <div id="errorFailureRateCard" class="bg-gradient-to-br from-red-500/20 to-red-600/30 border border-red-400/30 rounded-lg p-4 text-center">
                    <div class="flex items-center justify-center mb-2">
                        <span class="text-2xl mr-2">📊</span>
                        <div class="text-red-300 text-sm font-medium">실패율</div>
                    </div>
                    <div id="errorFailureRate" class="text-red-100 text-3xl font-bold mb-1">-</div>
                    <div class="text-red-200 text-xs">%</div>
                    <div id="errorFailureWarning" class="hidden mt-2 text-red-200 text-xs animate-pulse">
                        ⚠️ 임계치 초과
                    </div>
                </div>

                <!-- 총 에러 수 카드 -->
                <div class="bg-gradient-to-br from-orange-500/20 to-orange-600/30 border border-orange-400/30 rounded-lg p-4 text-center">
                    <div class="flex items-center justify-center mb-2">
                        <span class="text-2xl mr-2">🔢</span>
                        <div class="text-orange-300 text-sm font-medium">총 에러 수</div>
                    </div>
                    <div id="errorTotalCount" class="text-orange-100 text-3xl font-bold mb-1">-</div>
                    <div class="text-orange-200 text-xs">개</div>
                </div>

                <!-- 에러 유형 수 카드 -->
                <div class="bg-gradient-to-br from-yellow-500/20 to-yellow-600/30 border border-yellow-400/30 rounded-lg p-4 text-center">
                    <div class="flex items-center justify-center mb-2">
                        <span class="text-2xl mr-2">📋</span>
                        <div class="text-yellow-300 text-sm font-medium">에러 유형</div>
                    </div>
                    <div id="errorTypeCount" class="text-yellow-100 text-3xl font-bold mb-1">-</div>
                    <div class="text-yellow-200 text-xs">종류</div>
                </div>

                <!-- 분석 기간 카드 -->
                <div class="bg-gradient-to-br from-blue-500/20 to-blue-600/30 border border-blue-400/30 rounded-lg p-4 text-center">
                    <div class="flex items-center justify-center mb-2">
                        <span class="text-2xl mr-2">📅</span>
                        <div class="text-blue-300 text-sm font-medium">분석 기간</div>
                    </div>
                    <div id="errorAnalysisPeriod" class="text-blue-100 text-3xl font-bold mb-1">7</div>
                    <div class="text-blue-200 text-xs">일</div>
                </div>
            </div>

            <!-- 에러 분포 차트 -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                <!-- 에러 유형별 분포 차트 -->
                <div class="bg-black/20 dark:bg-gray-900/50 rounded-lg p-4">
                    <h3 class="text-white dark:text-gray-100 text-lg font-semibold mb-4 flex items-center">
                        <span class="mr-2">📊</span>
                        에러 유형별 분포
                    </h3>
                    <div class="relative h-64">
                        <canvas id="errorTypeDistributionChart"></canvas>
                    </div>
                </div>

                <!-- 에러 빈도 추이 차트 -->
                <div class="bg-black/20 dark:bg-gray-900/50 rounded-lg p-4">
                    <h3 class="text-white dark:text-gray-100 text-lg font-semibold mb-4 flex items-center">
                        <span class="mr-2">📈</span>
                        일별 에러 발생 추이
                    </h3>
                    <div class="relative h-64">
                        <canvas id="errorTrendChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- 최근 실패 사례 로그 미리보기 -->
            <div class="bg-black/20 dark:bg-gray-900/50 rounded-lg overflow-hidden mb-6">
                <div class="p-4 border-b border-white/10 dark:border-gray-700 flex justify-between items-center">
                    <h3 class="text-white dark:text-gray-100 font-semibold">최근 실패 사례 (Top 10)</h3>
                    <div class="flex items-center space-x-2">
                        <!-- 에러 유형 필터 -->
                        <select id="errorTypeFilter" class="bg-gray-700 text-white px-3 py-1 rounded text-sm border border-gray-600">
                            <option value="all">전체 유형</option>
                            <option value="BUILD_ERROR">빌드 에러</option>
                            <option value="TEST_FAILURE">테스트 실패</option>
                            <option value="TIMEOUT_ERROR">타임아웃</option>
                            <option value="MODULE_ERROR">모듈 에러</option>
                            <option value="SYNTAX_ERROR">문법 에러</option>
                        </select>
                    </div>
                </div>

                <div id="errorCasesList" class="max-h-80 overflow-y-auto p-4 space-y-3">
                    <!-- 에러 사례 목록이 여기에 동적으로 추가됩니다 -->
                    <div class="text-center text-gray-400 py-8">
                        <div class="text-4xl mb-2">🚨</div>
                        <div>에러 분석 데이터를 로드하는 중...</div>
                    </div>
                </div>
            </div>

            <!-- 알림 임계치 설정 UI -->
            <div class="bg-black/20 dark:bg-gray-900/50 rounded-lg p-4">
                <h3 class="text-white dark:text-gray-100 font-semibold mb-4 flex items-center">
                    <span class="mr-2">⚙️</span>
                    알림 임계치 설정
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                    <!-- Critical 임계치 -->
                    <div class="space-y-2">
                        <label class="text-red-300 text-sm font-medium">🚨 Critical (%)</label>
                        <input
                            id="criticalThreshold"
                            type="number"
                            value="10"
                            min="0"
                            max="100"
                            class="w-full bg-gray-700 text-white px-3 py-2 rounded border border-gray-600 focus:border-red-500 focus:outline-none"
                        >
                        <div class="text-red-200 text-xs">실패율 > 10%</div>
                    </div>

                    <!-- Error 임계치 -->
                    <div class="space-y-2">
                        <label class="text-orange-300 text-sm font-medium">❌ Error (%)</label>
                        <input
                            id="errorThreshold"
                            type="number"
                            value="5"
                            min="0"
                            max="100"
                            class="w-full bg-gray-700 text-white px-3 py-2 rounded border border-gray-600 focus:border-orange-500 focus:outline-none"
                        >
                        <div class="text-orange-200 text-xs">실패율 5-10%</div>
                    </div>

                    <!-- Warning 임계치 -->
                    <div class="space-y-2">
                        <label class="text-yellow-300 text-sm font-medium">⚠️ Warning (%)</label>
                        <input
                            id="warningThreshold"
                            type="number"
                            value="1"
                            min="0"
                            max="100"
                            class="w-full bg-gray-700 text-white px-3 py-2 rounded border border-gray-600 focus:border-yellow-500 focus:outline-none"
                        >
                        <div class="text-yellow-200 text-xs">실패율 1-5%</div>
                    </div>

                    <!-- 설정 저장 버튼 -->
                    <div class="space-y-2">
                        <label class="text-gray-300 text-sm font-medium">설정 관리</label>
                        <button id="saveThresholdsBtn" class="w-full bg-green-600 hover:bg-green-700 text-white px-3 py-2 rounded transition-colors duration-200">
                            💾 저장
                        </button>
                        <div class="text-gray-300 text-xs">임계치 저장</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 📅 연간 운영 리포트 패널 -->
        <div class="bg-white/10 dark:bg-gray-800/50 backdrop-blur-md rounded-xl p-6 border border-white/20 dark:border-gray-700/50">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-xl font-bold text-white dark:text-gray-100 flex items-center">
                    <span class="mr-3">📅</span>
                    연간 운영 리포트
                </h2>
                <div class="flex items-center space-x-2">
                    <button id="refreshYearlyReportBtn" class="bg-amber-600 hover:bg-amber-700 dark:bg-amber-500 dark:hover:bg-amber-600 text-white px-4 py-2 rounded-lg transition-colors duration-200 flex items-center">
                        <span class="mr-2">🔄</span>
                        새로고침
                    </button>
                    <button id="generateYearlyReportBtn" class="bg-indigo-600 hover:bg-indigo-700 dark:bg-indigo-500 dark:hover:bg-indigo-600 text-white px-4 py-2 rounded-lg transition-colors duration-200 flex items-center">
                        <span class="mr-2">📊</span>
                        리포트 생성
                    </button>
                    <button id="downloadYearlyReportMdBtn" class="bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors duration-200 flex items-center">
                        <span class="mr-2">📄</span>
                        Markdown
                    </button>
                    <button id="downloadYearlyReportJsonBtn" class="bg-purple-600 hover:bg-purple-700 dark:bg-purple-500 dark:hover:bg-purple-600 text-white px-4 py-2 rounded-lg transition-colors duration-200 flex items-center">
                        <span class="mr-2">📋</span>
                        JSON
                    </button>
                    <button id="sendYearlyNotificationBtn" class="bg-green-600 hover:bg-green-700 dark:bg-green-500 dark:hover:bg-green-600 text-white px-4 py-2 rounded-lg transition-colors duration-200 flex items-center">
                        <span class="mr-2">📢</span>
                        알림 전송
                    </button>
                </div>
            </div>

            <!-- 연간 성과 점수 카드 -->
            <div class="grid grid-cols-1 md:grid-cols-5 gap-4 mb-6">
                <!-- 종합 성과 카드 -->
                <div class="bg-gradient-to-br from-purple-500/20 to-purple-600/30 border border-purple-400/30 rounded-lg p-4 text-center">
                    <div class="flex items-center justify-center mb-2">
                        <span class="text-2xl mr-2">🏆</span>
                        <div class="text-purple-300 text-sm font-medium">종합 성과</div>
                    </div>
                    <div id="yearlyTotalScore" class="text-purple-100 text-3xl font-bold mb-1">-</div>
                    <div class="text-purple-200 text-xs">/100점</div>
                    <div id="yearlyGrade" class="text-purple-200 text-sm font-medium mt-1">-</div>
                </div>

                <!-- 보안 점수 카드 -->
                <div class="bg-gradient-to-br from-red-500/20 to-red-600/30 border border-red-400/30 rounded-lg p-4 text-center">
                    <div class="flex items-center justify-center mb-2">
                        <span class="text-2xl mr-2">🛡️</span>
                        <div class="text-red-300 text-sm font-medium">보안 점수</div>
                    </div>
                    <div id="yearlySecurityScore" class="text-red-100 text-3xl font-bold mb-1">-</div>
                    <div class="text-red-200 text-xs">/30점</div>
                </div>

                <!-- 백업 점수 카드 -->
                <div class="bg-gradient-to-br from-blue-500/20 to-blue-600/30 border border-blue-400/30 rounded-lg p-4 text-center">
                    <div class="flex items-center justify-center mb-2">
                        <span class="text-2xl mr-2">📦</span>
                        <div class="text-blue-300 text-sm font-medium">백업 점수</div>
                    </div>
                    <div id="yearlyBackupScore" class="text-blue-100 text-3xl font-bold mb-1">-</div>
                    <div class="text-blue-200 text-xs">/30점</div>
                </div>

                <!-- 시스템 점수 카드 -->
                <div class="bg-gradient-to-br from-orange-500/20 to-orange-600/30 border border-orange-400/30 rounded-lg p-4 text-center">
                    <div class="flex items-center justify-center mb-2">
                        <span class="text-2xl mr-2">⚙️</span>
                        <div class="text-orange-300 text-sm font-medium">시스템 점수</div>
                    </div>
                    <div id="yearlySystemScore" class="text-orange-100 text-3xl font-bold mb-1">-</div>
                    <div class="text-orange-200 text-xs">/20점</div>
                </div>

                <!-- CI/CD 점수 카드 -->
                <div class="bg-gradient-to-br from-green-500/20 to-green-600/30 border border-green-400/30 rounded-lg p-4 text-center">
                    <div class="flex items-center justify-center mb-2">
                        <span class="text-2xl mr-2">🚀</span>
                        <div class="text-green-300 text-sm font-medium">CI/CD 점수</div>
                    </div>
                    <div id="yearlyCIScore" class="text-green-100 text-3xl font-bold mb-1">-</div>
                    <div class="text-green-200 text-xs">/20점</div>
                </div>
            </div>

            <!-- 연간 추이 차트 -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                <!-- 분기별 성과 추이 차트 -->
                <div class="bg-black/20 dark:bg-gray-900/30 rounded-lg p-4">
                    <h3 class="text-white dark:text-gray-100 font-semibold mb-4 flex items-center">
                        <span class="mr-2">📈</span>
                        분기별 성과 추이
                    </h3>
                    <div style="height: 250px;">
                        <canvas id="yearlyQuarterlyChart"></canvas>
                    </div>
                </div>

                <!-- 연간 성과 분포 차트 -->
                <div class="bg-black/20 dark:bg-gray-900/30 rounded-lg p-4">
                    <h3 class="text-white dark:text-gray-100 font-semibold mb-4 flex items-center">
                        <span class="mr-2">🍰</span>
                        성과 영역별 분포
                    </h3>
                    <div style="height: 250px;">
                        <canvas id="yearlyDistributionChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- 이벤트 집중 구간 및 치명적 이벤트 -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                <!-- 치명적 이벤트 Top5 -->
                <div class="bg-black/20 dark:bg-gray-900/30 rounded-lg p-4">
                    <h3 class="text-white dark:text-gray-100 font-semibold mb-4 flex items-center">
                        <span class="mr-2">🚨</span>
                        치명적 이벤트 Top5
                    </h3>
                    <div id="yearlyCriticalEventsList" class="space-y-3">
                        <div class="text-gray-400 dark:text-gray-500 text-center py-4">
                            데이터를 불러오는 중...
                        </div>
                    </div>
                </div>

                <!-- 연간 통계 요약 -->
                <div class="bg-black/20 dark:bg-gray-900/30 rounded-lg p-4">
                    <h3 class="text-white dark:text-gray-100 font-semibold mb-4 flex items-center">
                        <span class="mr-2">📊</span>
                        연간 통계 요약
                    </h3>
                    <div id="yearlyStatsSummary" class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-gray-300 dark:text-gray-400">보안 이벤트:</span>
                            <span id="yearlySecurityEvents" class="text-white font-medium">-</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-300 dark:text-gray-400">백업 성공률:</span>
                            <span id="yearlyBackupSuccessRate" class="text-white font-medium">-</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-300 dark:text-gray-400">시스템 가동시간:</span>
                            <span id="yearlySystemUptime" class="text-white font-medium">-</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-300 dark:text-gray-400">CI 빌드 수:</span>
                            <span id="yearlyCIBuilds" class="text-white font-medium">-</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-300 dark:text-gray-400">테스트 커버리지:</span>
                            <span id="yearlyTestCoverage" class="text-white font-medium">-</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 리포트 생성/다운로드 컨트롤 -->
            <div class="bg-black/20 dark:bg-gray-900/30 rounded-lg p-4">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-white dark:text-gray-100 font-semibold flex items-center">
                        <span class="mr-2">📋</span>
                        리포트 관리
                    </h3>
                    <div class="flex items-center space-x-2">
                        <select id="yearlyReportYearSelect" class="bg-gray-800 dark:bg-gray-700 text-white border border-gray-600 rounded px-3 py-1 text-sm">
                            <option value="2024">2024년</option>
                            <option value="2023">2023년</option>
                            <option value="2022">2022년</option>
                        </select>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <!-- 리포트 생성 상태 -->
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-gray-300 dark:text-gray-400">리포트 상태:</span>
                            <span id="yearlyReportStatus" class="text-yellow-400 font-medium">준비 중</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-300 dark:text-gray-400">마지막 생성:</span>
                            <span id="yearlyReportLastGenerated" class="text-white font-medium">-</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-300 dark:text-gray-400">파일 크기:</span>
                            <span id="yearlyReportFileSize" class="text-white font-medium">-</span>
                        </div>
                    </div>

                    <!-- 알림 및 공유 -->
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-gray-300 dark:text-gray-400">마지막 알림:</span>
                            <span id="yearlyLastNotification" class="text-white font-medium">-</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-300 dark:text-gray-400">알림 채널:</span>
                            <div class="flex space-x-1">
                                <span id="yearlySlackStatus" class="text-xs px-2 py-1 rounded bg-gray-600 text-gray-300">Slack</span>
                                <span id="yearlyDiscordStatus" class="text-xs px-2 py-1 rounded bg-gray-600 text-gray-300">Discord</span>
                                <span id="yearlyEmailStatus" class="text-xs px-2 py-1 rounded bg-gray-600 text-gray-300">Email</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 진행률 표시 (리포트 생성 중일 때) -->
                <div id="yearlyReportProgress" class="hidden mt-4">
                    <div class="flex items-center justify-between mb-2">
                        <span class="text-gray-300 text-sm">리포트 생성 중...</span>
                        <span id="yearlyProgressPercent" class="text-white text-sm font-medium">0%</span>
                    </div>
                    <div class="w-full bg-gray-700 rounded-full h-2">
                        <div id="yearlyProgressBar" class="bg-gradient-to-r from-blue-500 to-purple-600 h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 📅 월간 운영 리포트 패널 -->
        <div class="bg-white/10 dark:bg-gray-800/50 backdrop-blur-md rounded-xl p-6 border border-white/20 dark:border-gray-700/50">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-xl font-bold text-white dark:text-gray-100 flex items-center">
                    <span class="mr-3">📅</span>
                    월간 운영 리포트
                </h2>
                <div class="flex items-center space-x-2">
                    <button id="refreshMonthlyReportBtn" class="bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors duration-200 flex items-center">
                        <span class="mr-2">🔄</span>
                        새로고침
                    </button>
                    <button id="generateMonthlyReportBtn" class="bg-green-600 hover:bg-green-700 dark:bg-green-500 dark:hover:bg-green-600 text-white px-4 py-2 rounded-lg transition-colors duration-200 flex items-center">
                        <span class="mr-2">📊</span>
                        리포트 생성
                    </button>
                    <button id="downloadMonthlyReportBtn" class="bg-purple-600 hover:bg-purple-700 dark:bg-purple-500 dark:hover:bg-purple-600 text-white px-4 py-2 rounded-lg transition-colors duration-200 flex items-center">
                        <span class="mr-2">📥</span>
                        다운로드
                    </button>
                </div>
            </div>

            <!-- 월간 성과 점수 카드들 -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                <!-- 보안 점수 카드 -->
                <div class="bg-gradient-to-br from-red-500/20 to-red-600/30 border border-red-400/30 rounded-lg p-4 text-center">
                    <div class="flex items-center justify-center mb-2">
                        <span class="text-2xl mr-2">🛡️</span>
                        <div class="text-red-300 dark:text-red-200 text-sm font-medium">보안 점수</div>
                    </div>
                    <div id="monthlySecurityScore" class="text-red-100 text-3xl font-bold mb-1">0</div>
                    <div class="text-red-200 text-xs">/40점</div>
                </div>

                <!-- 백업 점수 카드 -->
                <div class="bg-gradient-to-br from-blue-500/20 to-blue-600/30 border border-blue-400/30 rounded-lg p-4 text-center">
                    <div class="flex items-center justify-center mb-2">
                        <span class="text-2xl mr-2">📦</span>
                        <div class="text-blue-300 dark:text-blue-200 text-sm font-medium">백업 점수</div>
                    </div>
                    <div id="monthlyBackupScore" class="text-blue-100 text-3xl font-bold mb-1">0</div>
                    <div class="text-blue-200 text-xs">/40점</div>
                </div>

                <!-- 시스템 점수 카드 -->
                <div class="bg-gradient-to-br from-green-500/20 to-green-600/30 border border-green-400/30 rounded-lg p-4 text-center">
                    <div class="flex items-center justify-center mb-2">
                        <span class="text-2xl mr-2">💾</span>
                        <div class="text-green-300 dark:text-green-200 text-sm font-medium">시스템 점수</div>
                    </div>
                    <div id="monthlySystemScore" class="text-green-100 text-3xl font-bold mb-1">0</div>
                    <div class="text-green-200 text-xs">/20점</div>
                </div>

                <!-- 총점 및 등급 카드 -->
                <div class="bg-gradient-to-br from-yellow-500/20 to-yellow-600/30 border border-yellow-400/30 rounded-lg p-4 text-center">
                    <div class="flex items-center justify-center mb-2">
                        <span class="text-2xl mr-2">📈</span>
                        <div class="text-yellow-300 dark:text-yellow-200 text-sm font-medium">종합 성과</div>
                    </div>
                    <div id="monthlyTotalScore" class="text-yellow-100 text-3xl font-bold mb-1">0</div>
                    <div id="monthlyPerformanceGrade" class="text-yellow-200 text-xs font-medium">등급 확인 중...</div>
                </div>
            </div>

            <!-- 월간 성과 추이 차트 -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                <!-- 성과 점수 추이 차트 -->
                <div class="bg-black/20 dark:bg-gray-900/50 rounded-lg p-4">
                    <h3 class="text-white dark:text-gray-100 text-lg font-semibold mb-4 flex items-center">
                        <span class="mr-2">📊</span>
                        월별 성과 점수 추이 (최근 6개월)
                    </h3>
                    <div class="relative" style="height: 300px;">
                        <canvas id="monthlyPerformanceTrendChart"></canvas>
                    </div>
                </div>

                <!-- 성과 등급 분포 차트 -->
                <div class="bg-black/20 dark:bg-gray-900/50 rounded-lg p-4">
                    <h3 class="text-white dark:text-gray-100 text-lg font-semibold mb-4 flex items-center">
                        <span class="mr-2">🏆</span>
                        월별 성과 등급 분포
                    </h3>
                    <div class="relative" style="height: 300px;">
                        <canvas id="monthlyGradeDistributionChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- 월간 리포트 상세 정보 -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
                <!-- 보안 현황 요약 -->
                <div class="bg-red-500/10 dark:bg-red-600/10 border border-red-400/20 rounded-lg p-4">
                    <h4 class="text-red-300 dark:text-red-200 font-semibold mb-3 flex items-center">
                        <span class="mr-2">🛡️</span>
                        보안 현황 (30일)
                    </h4>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span class="text-red-200">총 차단 IP:</span>
                            <span id="monthlyBlockedIPs" class="text-red-100 font-medium">0회</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-red-200">고유 차단 IP:</span>
                            <span id="monthlyUniqueIPs" class="text-red-100 font-medium">0개</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-red-200">Rate Limit 위반:</span>
                            <span id="monthlyRateLimit" class="text-red-100 font-medium">0회</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-red-200">보안 이벤트:</span>
                            <span id="monthlySecurityEvents" class="text-red-100 font-medium">0회</span>
                        </div>
                    </div>
                </div>

                <!-- 백업 현황 요약 -->
                <div class="bg-blue-500/10 dark:bg-blue-600/10 border border-blue-400/20 rounded-lg p-4">
                    <h4 class="text-blue-300 dark:text-blue-200 font-semibold mb-3 flex items-center">
                        <span class="mr-2">📦</span>
                        백업 현황 (30일)
                    </h4>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span class="text-blue-200">성공한 백업:</span>
                            <span id="monthlySuccessfulBackups" class="text-blue-100 font-medium">0회</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-blue-200">실패한 백업:</span>
                            <span id="monthlyFailedBackups" class="text-blue-100 font-medium">0회</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-blue-200">성공률:</span>
                            <span id="monthlyBackupSuccessRate" class="text-blue-100 font-medium">0%</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-blue-200">정리 작업:</span>
                            <span id="monthlyCleanupOps" class="text-blue-100 font-medium">0회</span>
                        </div>
                    </div>
                </div>

                <!-- 시스템 리소스 요약 -->
                <div class="bg-green-500/10 dark:bg-green-600/10 border border-green-400/20 rounded-lg p-4">
                    <h4 class="text-green-300 dark:text-green-200 font-semibold mb-3 flex items-center">
                        <span class="mr-2">💾</span>
                        시스템 리소스 (30일)
                    </h4>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span class="text-green-200">평균 디스크 사용률:</span>
                            <span id="monthlyAvgDiskUsage" class="text-green-100 font-medium">0%</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-green-200">최대 디스크 사용률:</span>
                            <span id="monthlyMaxDiskUsage" class="text-green-100 font-medium">0%</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-green-200">보안 로그 크기:</span>
                            <span id="monthlyLogSize" class="text-green-100 font-medium">0MB</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-green-200">백업 저장소 크기:</span>
                            <span id="monthlyBackupSize" class="text-green-100 font-medium">0GB</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 최신 월간 리포트 목록 및 다운로드 -->
            <div class="bg-black/20 dark:bg-gray-900/50 rounded-lg overflow-hidden">
                <div class="p-4 border-b border-white/10 dark:border-gray-700 flex justify-between items-center">
                    <h3 class="text-white dark:text-gray-100 font-semibold">최근 월간 리포트</h3>
                    <div class="flex items-center space-x-2">
                        <!-- 기간 선택 드롭다운 -->
                        <select id="monthlyReportPeriodSelect" class="bg-gray-700 text-white px-3 py-1 rounded text-sm border border-gray-600 focus:outline-none focus:border-blue-500">
                            <option value="current">이번 달</option>
                            <option value="last-1">지난 달</option>
                            <option value="last-2">2개월 전</option>
                            <option value="last-3">3개월 전</option>
                            <option value="last-6">6개월 전</option>
                        </select>
                        <!-- 포맷 선택 버튼 -->
                        <button id="downloadMarkdownBtn" class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded-lg text-sm transition-colors duration-200">
                            Markdown
                        </button>
                        <button id="downloadJsonBtn" class="bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded-lg text-sm transition-colors duration-200">
                            JSON
                        </button>
                    </div>
                </div>

                <div id="monthlyReportsList" class="max-h-64 overflow-y-auto p-4 space-y-3">
                    <!-- 월간 리포트 목록이 여기에 동적으로 추가됩니다 -->
                    <div class="text-center text-gray-400 py-8">
                        <div class="text-4xl mb-2">📅</div>
                        <div>월간 리포트 데이터를 로드하는 중...</div>
                        <div class="text-sm text-gray-500 mt-2">첫 번째 리포트 생성까지 시간이 걸릴 수 있습니다.</div>
                    </div>
                </div>
            </div>

            <!-- 월간 리포트 권장사항 -->
            <div id="monthlyRecommendationsSection" class="mt-6 hidden">
                <div class="bg-yellow-500/10 dark:bg-yellow-600/10 border border-yellow-400/20 rounded-lg p-4">
                    <h4 class="text-yellow-300 dark:text-yellow-200 font-semibold mb-3 flex items-center">
                        <span class="mr-2">💡</span>
                        월간 권장사항
                    </h4>
                    <div id="monthlyRecommendationsList" class="space-y-2 text-sm text-yellow-200">
                        <!-- 권장사항이 동적으로 추가됩니다 -->
                    </div>
                </div>
            </div>

            <!-- 다음 달 목표 -->
            <div id="nextMonthGoalsSection" class="mt-6 hidden">
                <div class="bg-purple-500/10 dark:bg-purple-600/10 border border-purple-400/20 rounded-lg p-4">
                    <h4 class="text-purple-300 dark:text-purple-200 font-semibold mb-3 flex items-center">
                        <span class="mr-2">🎯</span>
                        다음 달 목표
                    </h4>
                    <div id="nextMonthGoalsList" class="space-y-2 text-sm text-purple-200">
                        <div>• 종합 성과 점수 85점 이상 달성</div>
                        <div>• 보안 이벤트 20% 감소</div>
                        <div>• 백업 성공률 98% 이상 유지</div>
                        <div>• 시스템 자동화 및 모니터링 강화</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 📊 분기별 운영 리포트 패널 -->
        <div class="bg-white/10 dark:bg-gray-800/50 backdrop-blur-md rounded-xl p-6 border border-white/20 dark:border-gray-700/50">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-xl font-bold text-white dark:text-gray-100 flex items-center">
                    <span class="mr-3">📊</span>
                    분기별 운영 리포트
                </h2>
                <div class="flex items-center space-x-2">
                    <select id="quarterlyReportQuarterSelect" class="bg-gray-700 text-white px-3 py-2 rounded text-sm border border-gray-600 focus:outline-none focus:border-blue-500">
                        <option value="Q1">Q1 (1-3월)</option>
                        <option value="Q2">Q2 (4-6월)</option>
                        <option value="Q3">Q3 (7-9월)</option>
                        <option value="Q4">Q4 (10-12월)</option>
                    </select>
                    <button id="refreshQuarterlyReportBtn" class="bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors duration-200 flex items-center">
                        <span class="mr-2">🔄</span>
                        새로고침
                    </button>
                    <button id="generateQuarterlyReportBtn" class="bg-green-600 hover:bg-green-700 dark:bg-green-500 dark:hover:bg-green-600 text-white px-4 py-2 rounded-lg transition-colors duration-200 flex items-center">
                        <span class="mr-2">📊</span>
                        리포트 생성
                    </button>
                    <button id="downloadQuarterlyReportBtn" class="bg-purple-600 hover:bg-purple-700 dark:bg-purple-500 dark:hover:bg-purple-600 text-white px-4 py-2 rounded-lg transition-colors duration-200 flex items-center">
                        <span class="mr-2">📥</span>
                        다운로드
                    </button>
                </div>
            </div>

            <!-- 분기별 성과 점수 카드들 -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                <!-- 보안 점수 카드 -->
                <div class="bg-gradient-to-br from-red-500/20 to-red-600/30 border border-red-400/30 rounded-lg p-4 text-center">
                    <div class="flex items-center justify-center mb-2">
                        <span class="text-2xl mr-2">🛡️</span>
                        <div class="text-red-300 dark:text-red-200 text-sm font-medium">보안 점수</div>
                    </div>
                    <div id="quarterlySecurityScore" class="text-red-100 text-3xl font-bold mb-1">0</div>
                    <div class="text-red-200 text-xs">/30점</div>
                </div>

                <!-- 백업 점수 카드 -->
                <div class="bg-gradient-to-br from-blue-500/20 to-blue-600/30 border border-blue-400/30 rounded-lg p-4 text-center">
                    <div class="flex items-center justify-center mb-2">
                        <span class="text-2xl mr-2">📦</span>
                        <div class="text-blue-300 dark:text-blue-200 text-sm font-medium">백업 점수</div>
                    </div>
                    <div id="quarterlyBackupScore" class="text-blue-100 text-3xl font-bold mb-1">0</div>
                    <div class="text-blue-200 text-xs">/30점</div>
                </div>

                <!-- 시스템 점수 카드 -->
                <div class="bg-gradient-to-br from-green-500/20 to-green-600/30 border border-green-400/30 rounded-lg p-4 text-center">
                    <div class="flex items-center justify-center mb-2">
                        <span class="text-2xl mr-2">⚙️</span>
                        <div class="text-green-300 dark:text-green-200 text-sm font-medium">시스템 점수</div>
                    </div>
                    <div id="quarterlySystemScore" class="text-green-100 text-3xl font-bold mb-1">0</div>
                    <div class="text-green-200 text-xs">/20점</div>
                </div>

                <!-- 총합 점수 카드 -->
                <div class="bg-gradient-to-br from-yellow-500/20 to-yellow-600/30 border border-yellow-400/30 rounded-lg p-4 text-center">
                    <div class="flex items-center justify-center mb-2">
                        <span class="text-2xl mr-2">🏆</span>
                        <div class="text-yellow-300 dark:text-yellow-200 text-sm font-medium">총합 점수</div>
                    </div>
                    <div id="quarterlyTotalScore" class="text-yellow-100 text-3xl font-bold mb-1">0</div>
                    <div id="quarterlyPerformanceGrade" class="text-yellow-200 text-xs font-medium">등급 확인 중...</div>
                </div>
            </div>

            <!-- 분기별 성과 차트들 -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                <!-- 월별 추이 차트 -->
                <div class="bg-gray-800/30 border border-gray-600/30 rounded-lg p-4">
                    <h3 class="text-white dark:text-gray-100 font-semibold mb-4 flex items-center">
                        <span class="mr-2">📈</span>
                        월별 성과 추이
                    </h3>
                    <div class="h-64">
                        <canvas id="quarterlyMonthlyTrendChart"></canvas>
                    </div>
                </div>

                <!-- 영역별 점수 분포 차트 -->
                <div class="bg-gray-800/30 border border-gray-600/30 rounded-lg p-4">
                    <h3 class="text-white dark:text-gray-100 font-semibold mb-4 flex items-center">
                        <span class="mr-2">🎯</span>
                        영역별 점수 분포
                    </h3>
                    <div class="h-64">
                        <canvas id="quarterlyScoreDistributionChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- 분기별 리포트 상세 정보 -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                <!-- 보안 상세 -->
                <div class="bg-red-500/10 dark:bg-red-600/10 border border-red-400/20 rounded-lg p-4">
                    <h4 class="text-red-300 dark:text-red-200 font-semibold mb-3 flex items-center">
                        <span class="mr-2">🛡️</span>
                        보안 현황
                    </h4>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span class="text-red-200">차단 IP:</span>
                            <span id="quarterlyBlockedIPs" class="text-red-100 font-medium">0개</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-red-200">보안 이벤트:</span>
                            <span id="quarterlySecurityEvents" class="text-red-100 font-medium">0건</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-red-200">Rate Limit:</span>
                            <span id="quarterlyRateLimit" class="text-red-100 font-medium">0회</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-red-200">화이트리스트 추가:</span>
                            <span id="quarterlyWhitelistAdded" class="text-red-100 font-medium">0개</span>
                        </div>
                    </div>
                </div>

                <!-- 백업 상세 -->
                <div class="bg-blue-500/10 dark:bg-blue-600/10 border border-blue-400/20 rounded-lg p-4">
                    <h4 class="text-blue-300 dark:text-blue-200 font-semibold mb-3 flex items-center">
                        <span class="mr-2">📦</span>
                        백업 현황
                    </h4>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span class="text-blue-200">성공 백업:</span>
                            <span id="quarterlySuccessfulBackups" class="text-blue-100 font-medium">0회</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-blue-200">실패 백업:</span>
                            <span id="quarterlyFailedBackups" class="text-blue-100 font-medium">0회</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-blue-200">성공률:</span>
                            <span id="quarterlyBackupSuccessRate" class="text-blue-100 font-medium">0%</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-blue-200">정리 작업:</span>
                            <span id="quarterlyCleanupOps" class="text-blue-100 font-medium">0회</span>
                        </div>
                    </div>
                </div>

                <!-- 시스템 상세 -->
                <div class="bg-green-500/10 dark:bg-green-600/10 border border-green-400/20 rounded-lg p-4">
                    <h4 class="text-green-300 dark:text-green-200 font-semibold mb-3 flex items-center">
                        <span class="mr-2">⚙️</span>
                        시스템 현황
                    </h4>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span class="text-green-200">평균 CPU:</span>
                            <span id="quarterlyAvgCpu" class="text-green-100 font-medium">0%</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-green-200">평균 메모리:</span>
                            <span id="quarterlyAvgMemory" class="text-green-100 font-medium">0%</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-green-200">평균 디스크:</span>
                            <span id="quarterlyAvgDisk" class="text-green-100 font-medium">0%</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-green-200">업타임:</span>
                            <span id="quarterlyUptime" class="text-green-100 font-medium">0일</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 최신 분기별 리포트 목록 및 다운로드 -->
            <div class="bg-gray-800/30 border border-gray-600/30 rounded-lg p-4">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-white dark:text-gray-100 font-semibold">최근 분기별 리포트</h3>
                    <div class="flex items-center space-x-2">
                        <select id="quarterlyReportYearSelect" class="bg-gray-700 text-white px-3 py-1 rounded text-sm border border-gray-600 focus:outline-none focus:border-blue-500">
                            <option value="2024">2024년</option>
                            <option value="2023">2023년</option>
                        </select>
                    </div>
                </div>

                <div id="quarterlyReportsList" class="max-h-64 overflow-y-auto p-4 space-y-3">
                    <!-- 분기별 리포트 목록이 여기에 동적으로 추가됩니다 -->
                    <div class="text-center text-gray-400 py-8">
                        <div class="text-4xl mb-2">📊</div>
                        <div>분기별 리포트 데이터를 로드하는 중...</div>
                        <div class="text-sm text-gray-500 mt-2">첫 번째 리포트 생성까지 시간이 걸릴 수 있습니다.</div>
                    </div>
                </div>
            </div>

            <!-- 분기별 리포트 권장사항 -->
            <div id="quarterlyRecommendationsSection" class="mt-6 hidden">
                <div class="bg-yellow-500/10 dark:bg-yellow-600/10 border border-yellow-400/20 rounded-lg p-4">
                    <h4 class="text-yellow-300 dark:text-yellow-200 font-semibold mb-3 flex items-center">
                        <span class="mr-2">💡</span>
                        분기별 권장사항
                    </h4>
                    <div id="quarterlyRecommendationsList" class="space-y-2 text-sm text-yellow-200">
                        <!-- 권장사항이 동적으로 추가됩니다 -->
                    </div>
                </div>
            </div>

            <!-- 주요 이슈 기간 -->
            <div id="quarterlyCriticalPeriodsSection" class="mt-6 hidden">
                <div class="bg-red-500/10 dark:bg-red-600/10 border border-red-400/20 rounded-lg p-4">
                    <h4 class="text-red-300 dark:text-red-200 font-semibold mb-3 flex items-center">
                        <span class="mr-2">⚠️</span>
                        주요 이슈 기간
                    </h4>
                    <div id="quarterlyCriticalPeriodsList" class="space-y-2 text-sm text-red-200">
                        <!-- 주요 이슈 기간이 동적으로 추가됩니다 -->
                    </div>
                </div>
            </div>

            <!-- 다음 분기 목표 -->
            <div id="nextQuarterGoalsSection" class="mt-6 hidden">
                <div class="bg-purple-500/10 dark:bg-purple-600/10 border border-purple-400/20 rounded-lg p-4">
                    <h4 class="text-purple-300 dark:text-purple-200 font-semibold mb-3 flex items-center">
                        <span class="mr-2">🎯</span>
                        다음 분기 목표
                    </h4>
                    <div id="nextQuarterGoalsList" class="space-y-2 text-sm text-purple-200">
                        <div>• 종합 성과 점수 90점 이상 달성</div>
                        <div>• 보안 이벤트 15% 감소</div>
                        <div>• 백업 성공률 99% 이상 유지</div>
                        <div>• 시스템 자동화 및 CI/CD 성능 향상</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="text-center text-white/70 dark:text-gray-400 text-sm">
            © 2024 MCP-MAP Company. All rights reserved.
        </div>
    </div>

    <script>
        // =============================================
        // Dark Mode Toggle Implementation
        // =============================================

        class DarkModeManager {
            constructor() {
                this.darkMode = false;
                this.toggleButton = document.getElementById('darkModeToggle');
                this.init();
            }

            init() {
                // Load saved theme from localStorage
                this.loadTheme();

                // Set up event listener for toggle button
                this.toggleButton.addEventListener('click', () => {
                    this.toggle();
                });

                // Apply initial theme
                this.applyTheme();
            }

            loadTheme() {
                const saved = localStorage.getItem('mcp-map-dark-mode');
                if (saved !== null) {
                    this.darkMode = JSON.parse(saved);
                } else {
                    // Default to system preference
                    this.darkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
                }
            }

            saveTheme() {
                localStorage.setItem('mcp-map-dark-mode', JSON.stringify(this.darkMode));
            }

            toggle() {
                this.darkMode = !this.darkMode;
                this.saveTheme();
                this.applyTheme();
                this.notifyCharts();
            }

            applyTheme() {
                const html = document.documentElement;
                const toggle = this.toggleButton;

                if (this.darkMode) {
                    html.classList.add('dark');
                    toggle.classList.add('active');
                } else {
                    html.classList.remove('dark');
                    toggle.classList.remove('active');
                }

                // Update chart colors if charts are initialized
                setTimeout(() => {
                    this.updateChartColors();
                }, 100);
            }

            notifyCharts() {
                // Trigger chart color update
                const event = new CustomEvent('themeChanged', {
                    detail: { darkMode: this.darkMode }
                });
                document.dispatchEvent(event);
            }

            updateChartColors() {
                const charts = [
                    window.realTimeResponseChart,
                    window.systemResourceGauge,
                    window.dbPerformanceChart,
                    window.apiCallsChart,
                    window.securityEventsChart,
                    // 시스템 자원 모니터링 차트들 추가
                    window.cpuUsageChart,
                    window.memoryUsageChart,
                    window.diskIOChart,
                    window.networkIOChart
                ];

                charts.forEach(chart => {
                    if (chart) {
                        this.updateSingleChart(chart);
                    }
                });

                // 연간 운영 리포트 차트 업데이트
                if (yearlyReportManager) {
                    yearlyReportManager.updateChartsForTheme();
                }
            }

            updateSingleChart(chart) {
                const textColor = this.darkMode ? '#f3f4f6' : '#ffffff';
                const gridColor = this.darkMode ? 'rgba(156, 163, 175, 0.2)' : 'rgba(255, 255, 255, 0.1)';

                if (chart.options.scales) {
                    if (chart.options.scales.x) {
                        chart.options.scales.x.ticks.color = textColor;
                        chart.options.scales.x.grid.color = gridColor;
                    }
                    if (chart.options.scales.y) {
                        chart.options.scales.y.ticks.color = textColor;
                        chart.options.scales.y.grid.color = gridColor;
                    }
                }

                if (chart.options.plugins && chart.options.plugins.legend) {
                    chart.options.plugins.legend.labels.color = textColor;
                }

                chart.update('none');
            }

            isDarkMode() {
                return this.darkMode;
            }
        }

        // =============================================
        // Dashboard Configuration and Data
        // =============================================

        const CONFIG = {
            BASE_URL: window.location.hostname === 'localhost'
                ? 'http://localhost:8000'
                : 'https://mcp-map-company.onrender.com',
            REFRESH_INTERVAL: 10000, // 10 seconds for real-time updates
            API_KEY: ''
        };

        // Chart variables
        let realTimeResponseChart = null;
        let systemResourceGauge = null;
        let dbPerformanceChart = null;
        let apiCallsChart = null;

        // 시스템 자원 모니터링 차트 변수들
        let cpuUsageChart = null;
        let memoryUsageChart = null;
        let diskIOChart = null;
        let networkIOChart = null;

        // Real-time metrics data storage
        const metricsData = {
            timestamps: [],
            responseTimeHistory: [],
            dbLatencyHistory: [],
            cpuUsageHistory: [],
            memoryUsageHistory: [],
            activeUsersHistory: [],
            apiCallsByEndpoint: {},
            maxDataPoints: 30
        };

        // 시스템 자원 모니터링 데이터 저장소
        const systemResourceData = {
            timestamps: [],
            cpuHistory: [],
            memoryHistory: [],
            diskIOHistory: [],
            networkInHistory: [],
            networkOutHistory: [],
            maxDataPoints: 30,
            currentMetrics: {
                cpu: 0,
                memory: 0,
                disk: 0,
                networkIn: 0,
                networkOut: 0
            }
        };

        // Auto refresh state
        let autoRefreshEnabled = false;
        let refreshInterval = null;

        // Dark mode manager
        let darkModeManager = null;

        // =============================================
        // Utility Functions
        // =============================================

        function addLog(message, level = 'info') {
            const container = document.getElementById('logContainer');
            const now = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.className = `log-level-${level}`;
            logEntry.textContent = `[${now}] ${message}`;

            container.appendChild(logEntry);
            container.scrollTop = container.scrollHeight;

            // Keep only last 100 log entries
            while (container.children.length > 100) {
                container.removeChild(container.firstChild);
            }
        }

        function updateTimestamp() {
            const now = new Date().toLocaleString('ko-KR');
            document.getElementById('lastUpdated')?.textContent = `마지막 업데이트: ${now}`;
        }

        // =============================================
        // Chart Initialization Functions
        // =============================================

        function initRealTimeMetricsCharts() {
            const isDark = darkModeManager.isDarkMode();
            const textColor = isDark ? '#f3f4f6' : '#ffffff';
            const gridColor = isDark ? 'rgba(156, 163, 175, 0.2)' : 'rgba(255, 255, 255, 0.1)';

            // Initialize Real-time Response Chart
            const realTimeCtx = document.getElementById('realTimeResponseChart')?.getContext('2d');
            if (realTimeCtx) {
                window.realTimeResponseChart = realTimeResponseChart = new Chart(realTimeCtx, {
                    type: 'line',
                    data: {
                        labels: metricsData.timestamps,
                        datasets: [{
                            label: '응답시간 (ms)',
                            data: metricsData.responseTimeHistory,
                            borderColor: '#60a5fa',
                            backgroundColor: 'rgba(96, 165, 250, 0.1)',
                            borderWidth: 2,
                            fill: true,
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                labels: { color: textColor }
                            }
                        },
                        scales: {
                            x: {
                                ticks: { color: textColor },
                                grid: { color: gridColor }
                            },
                            y: {
                                ticks: { color: textColor },
                                grid: { color: gridColor }
                            }
                        }
                    }
                });
            }

            // Initialize System Resource Gauge
            const systemCtx = document.getElementById('systemResourceGauge')?.getContext('2d');
            if (systemCtx) {
                window.systemResourceGauge = systemResourceGauge = new Chart(systemCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['CPU', 'Memory', 'Disk'],
                        datasets: [{
                            data: [0, 0, 0],
                            backgroundColor: [
                                'rgba(239, 68, 68, 0.8)',   // CPU - Red
                                'rgba(59, 130, 246, 0.8)',  // Memory - Blue
                                'rgba(16, 185, 129, 0.8)'   // Disk - Green
                            ],
                            borderColor: [
                                'rgba(239, 68, 68, 1)',
                                'rgba(59, 130, 246, 1)',
                                'rgba(16, 185, 129, 1)'
                            ],
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                labels: { color: textColor },
                                position: 'bottom'
                            }
                        }
                    }
                });
            }

            // Initialize DB Performance Chart
            const dbCtx = document.getElementById('dbPerformanceChart')?.getContext('2d');
            if (dbCtx) {
                window.dbPerformanceChart = dbPerformanceChart = new Chart(dbCtx, {
                    type: 'line',
                    data: {
                        labels: metricsData.timestamps,
                        datasets: [{
                            label: 'DB 지연시간 (ms)',
                            data: metricsData.dbLatencyHistory,
                            borderColor: '#8b5cf6',
                            backgroundColor: 'rgba(139, 92, 246, 0.1)',
                            borderWidth: 2,
                            fill: true,
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                labels: { color: textColor }
                            }
                        },
                        scales: {
                            x: {
                                ticks: { color: textColor },
                                grid: { color: gridColor }
                            },
                            y: {
                                ticks: { color: textColor },
                                grid: { color: gridColor }
                            }
                        }
                    }
                });
            }

            // Initialize API Calls Chart
            const apiCtx = document.getElementById('apiCallsChart')?.getContext('2d');
            if (apiCtx) {
                window.apiCallsChart = apiCallsChart = new Chart(apiCtx, {
                    type: 'bar',
                    data: {
                        labels: [],
                        datasets: [{
                            label: 'API 호출 수',
                            data: [],
                            backgroundColor: [
                                'rgba(34, 197, 94, 0.8)',
                                'rgba(59, 130, 246, 0.8)',
                                'rgba(239, 68, 68, 0.8)',
                                'rgba(245, 158, 11, 0.8)',
                                'rgba(139, 92, 246, 0.8)'
                            ],
                            borderColor: [
                                'rgba(34, 197, 94, 1)',
                                'rgba(59, 130, 246, 1)',
                                'rgba(239, 68, 68, 1)',
                                'rgba(245, 158, 11, 1)',
                                'rgba(139, 92, 246, 1)'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                labels: { color: textColor }
                            }
                        },
                        scales: {
                            x: {
                                ticks: { color: textColor },
                                grid: { color: gridColor }
                            },
                            y: {
                                ticks: { color: textColor },
                                grid: { color: gridColor }
                            }
                        }
                    }
                });
            }

            addLog('실시간 메트릭 차트 초기화 완료', 'info');
        }

        // =============================================
        // 시스템 자원 모니터링 차트 초기화 함수
        // =============================================

        function initSystemResourceCharts() {
            const isDark = darkModeManager.isDarkMode();
            const textColor = isDark ? '#f3f4f6' : '#ffffff';
            const gridColor = isDark ? 'rgba(156, 163, 175, 0.2)' : 'rgba(255, 255, 255, 0.1)';

            // CPU 사용률 차트 초기화
            const cpuCtx = document.getElementById('cpuUsageChart')?.getContext('2d');
            if (cpuCtx) {
                window.cpuUsageChart = cpuUsageChart = new Chart(cpuCtx, {
                    type: 'line',
                    data: {
                        labels: systemResourceData.timestamps,
                        datasets: [{
                            label: 'CPU 사용률 (%)',
                            data: systemResourceData.cpuHistory,
                            borderColor: '#ef4444',
                            backgroundColor: 'rgba(239, 68, 68, 0.1)',
                            borderWidth: 2,
                            fill: true,
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                labels: { color: textColor }
                            }
                        },
                        scales: {
                            x: {
                                ticks: { color: textColor },
                                grid: { color: gridColor }
                            },
                            y: {
                                ticks: { color: textColor },
                                grid: { color: gridColor },
                                beginAtZero: true,
                                max: 100
                            }
                        }
                    }
                });
            }

            // 메모리 사용률 차트 초기화
            const memoryCtx = document.getElementById('memoryUsageChart')?.getContext('2d');
            if (memoryCtx) {
                window.memoryUsageChart = memoryUsageChart = new Chart(memoryCtx, {
                    type: 'line',
                    data: {
                        labels: systemResourceData.timestamps,
                        datasets: [{
                            label: '메모리 사용률 (%)',
                            data: systemResourceData.memoryHistory,
                            borderColor: '#3b82f6',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            borderWidth: 2,
                            fill: true,
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                labels: { color: textColor }
                            }
                        },
                        scales: {
                            x: {
                                ticks: { color: textColor },
                                grid: { color: gridColor }
                            },
                            y: {
                                ticks: { color: textColor },
                                grid: { color: gridColor },
                                beginAtZero: true,
                                max: 100
                            }
                        }
                    }
                });
            }

            // 디스크 I/O 차트 초기화
            const diskCtx = document.getElementById('diskIOChart')?.getContext('2d');
            if (diskCtx) {
                window.diskIOChart = diskIOChart = new Chart(diskCtx, {
                    type: 'line',
                    data: {
                        labels: systemResourceData.timestamps,
                        datasets: [{
                            label: '디스크 사용률 (%)',
                            data: systemResourceData.diskIOHistory,
                            borderColor: '#10b981',
                            backgroundColor: 'rgba(16, 185, 129, 0.1)',
                            borderWidth: 2,
                            fill: true,
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                labels: { color: textColor }
                            }
                        },
                        scales: {
                            x: {
                                ticks: { color: textColor },
                                grid: { color: gridColor }
                            },
                            y: {
                                ticks: { color: textColor },
                                grid: { color: gridColor },
                                beginAtZero: true,
                                max: 100
                            }
                        }
                    }
                });
            }

            // 네트워크 I/O 차트 초기화
            const networkCtx = document.getElementById('networkIOChart')?.getContext('2d');
            if (networkCtx) {
                window.networkIOChart = networkIOChart = new Chart(networkCtx, {
                    type: 'line',
                    data: {
                        labels: systemResourceData.timestamps,
                        datasets: [{
                            label: '업로드 (MB/s)',
                            data: systemResourceData.networkInHistory,
                            borderColor: '#10b981',
                            backgroundColor: 'rgba(16, 185, 129, 0.1)',
                            borderWidth: 2,
                            fill: false,
                            tension: 0.4
                        }, {
                            label: '다운로드 (MB/s)',
                            data: systemResourceData.networkOutHistory,
                            borderColor: '#3b82f6',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            borderWidth: 2,
                            fill: false,
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                labels: { color: textColor }
                            }
                        },
                        scales: {
                            x: {
                                ticks: { color: textColor },
                                grid: { color: gridColor }
                            },
                            y: {
                                ticks: { color: textColor },
                                grid: { color: gridColor },
                                beginAtZero: true
                            }
                        }
                    }
                });
            }

            addLog('시스템 자원 모니터링 차트 초기화 완료', 'info');
        }

        // =============================================
        // Data Fetching Functions
        // =============================================

        async function checkHealth() {
            try {
                const response = await fetch(`${CONFIG.BASE_URL}/health`);
                const data = await response.json();

                document.getElementById('healthStatus').textContent = '정상';
                document.getElementById('healthStatus').className = 'text-green-400 text-2xl font-bold mt-2';

                addLog('시스템 상태 점검 완료 - 정상', 'info');
                return true;
            } catch (error) {
                document.getElementById('healthStatus').textContent = '오류';
                document.getElementById('healthStatus').className = 'text-red-400 text-2xl font-bold mt-2';

                addLog(`시스템 상태 점검 실패: ${error.message}`, 'error');
                return false;
            }
        }

        async function checkAPI() {
            try {
                const response = await fetch(`${CONFIG.BASE_URL}/api/v1/health`);
                const data = await response.json();

                document.getElementById('apiStatus').textContent = '연결됨';
                document.getElementById('apiStatus').className = 'text-green-400 text-2xl font-bold mt-2';

                addLog('API 상태 점검 완료 - 연결됨', 'info');
                return true;
            } catch (error) {
                document.getElementById('apiStatus').textContent = '오류';
                document.getElementById('apiStatus').className = 'text-red-400 text-2xl font-bold mt-2';

                addLog(`API 상태 점검 실패: ${error.message}`, 'error');
                return false;
            }
        }

        async function refreshRealTimeMetrics() {
            try {
                // Simulate metrics data for demo
                const mockMetrics = {
                    timestamp: new Date().toISOString(),
                    system: {
                        cpu_percent: Math.random() * 100,
                        memory_percent: Math.random() * 100,
                        disk_percent: Math.random() * 100
                    },
                    application: {
                        avg_response_time: Math.random() * 200 + 50,
                        active_users: Math.floor(Math.random() * 50),
                        uptime_hours: Math.random() * 24
                    },
                    database: {
                        avg_latency: Math.random() * 50 + 10,
                        active_connections: Math.floor(Math.random() * 20)
                    }
                };

                updateRealTimeMetrics(mockMetrics);
                addLog('실시간 메트릭 업데이트 완료', 'info');

            } catch (error) {
                addLog(`실시간 메트릭 업데이트 실패: ${error.message}`, 'error');
            }
        }

        function updateRealTimeMetrics(metrics) {
            // Update summary cards
            document.getElementById('avgResponseTime').textContent =
                metrics.application?.avg_response_time?.toFixed(1) || '-';
            document.getElementById('dbLatency').textContent =
                metrics.database?.avg_latency?.toFixed(1) || '-';
            document.getElementById('activeUsers').textContent =
                metrics.application?.active_users || '-';
            document.getElementById('systemCpu').textContent =
                metrics.system?.cpu_percent?.toFixed(1) + '%' || '-';

            // Add new data point to time series
            const now = new Date().toLocaleTimeString('ko-KR', {
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });

            metricsData.timestamps.push(now);
            metricsData.responseTimeHistory.push(metrics.application?.avg_response_time || 0);
            metricsData.dbLatencyHistory.push(metrics.database?.avg_latency || 0);
            metricsData.cpuUsageHistory.push(metrics.system?.cpu_percent || 0);
            metricsData.memoryUsageHistory.push(metrics.system?.memory_percent || 0);
            metricsData.activeUsersHistory.push(metrics.application?.active_users || 0);

            // Keep only recent data points
            if (metricsData.timestamps.length > metricsData.maxDataPoints) {
                metricsData.timestamps.shift();
                metricsData.responseTimeHistory.shift();
                metricsData.dbLatencyHistory.shift();
                metricsData.cpuUsageHistory.shift();
                metricsData.memoryUsageHistory.shift();
                metricsData.activeUsersHistory.shift();
            }

            // Update charts
            updateRealTimeCharts(metrics);
        }

        // =============================================
        // 시스템 자원 모니터링 데이터 함수들
        // =============================================

        async function fetchSystemMetrics() {
            try {
                // API에서 시스템 메트릭 데이터 가져오기 시도
                const response = await fetch(`${CONFIG.BASE_URL}/api/v1/metrics/system`).catch(() => null);

                let systemMetrics;
                if (response && response.ok) {
                    systemMetrics = await response.json();
                    addLog('시스템 메트릭 API에서 데이터 로드 완료', 'info');
                } else {
                    // API를 사용할 수 없는 경우 모의 데이터 생성
                    systemMetrics = generateMockSystemMetrics();
                    addLog('API 연결 실패 - 모의 시스템 메트릭 데이터 사용', 'warning');
                }

                updateSystemResourceMetrics(systemMetrics);
                addLog('시스템 자원 메트릭 업데이트 완료', 'info');

            } catch (error) {
                addLog(`시스템 메트릭 가져오기 실패: ${error.message}`, 'error');
                // 오류 발생 시 모의 데이터 사용
                const fallbackMetrics = generateMockSystemMetrics();
                updateSystemResourceMetrics(fallbackMetrics);
            }
        }

        function generateMockSystemMetrics() {
            // 실제 시스템과 유사한 패턴의 모의 데이터 생성
            const now = Date.now();
            const timeVariation = Math.sin(now / 300000) * 0.3; // 5분 주기 변동

            return {
                timestamp: new Date().toISOString(),
                cpu: Math.max(0, Math.min(100, 15 + Math.random() * 50 + timeVariation * 20)),
                memory: Math.max(0, Math.min(100, 40 + Math.random() * 30 + timeVariation * 15)),
                disk: Math.max(0, Math.min(100, 60 + Math.random() * 20 + timeVariation * 10)),
                network: {
                    in: Math.random() * 50 + timeVariation * 10,
                    out: Math.random() * 30 + timeVariation * 8
                },
                system_info: {
                    load_average: (Math.random() * 2).toFixed(2),
                    processes: Math.floor(200 + Math.random() * 100),
                    health_score: Math.floor(85 + Math.random() * 15)
                }
            };
        }

        function updateSystemResourceMetrics(metrics) {
            // 현재 메트릭 업데이트
            systemResourceData.currentMetrics = {
                cpu: metrics.cpu || 0,
                memory: metrics.memory || 0,
                disk: metrics.disk || 0,
                networkIn: metrics.network?.in || 0,
                networkOut: metrics.network?.out || 0
            };

            // UI 카드 업데이트
            updateSystemResourceCards(metrics);

            // 시간별 데이터 히스토리에 추가
            const now = new Date().toLocaleTimeString('ko-KR', {
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });

            systemResourceData.timestamps.push(now);
            systemResourceData.cpuHistory.push(metrics.cpu || 0);
            systemResourceData.memoryHistory.push(metrics.memory || 0);
            systemResourceData.diskIOHistory.push(metrics.disk || 0);
            systemResourceData.networkInHistory.push(metrics.network?.in || 0);
            systemResourceData.networkOutHistory.push(metrics.network?.out || 0);

            // 최대 데이터 포인트 수 제한
            if (systemResourceData.timestamps.length > systemResourceData.maxDataPoints) {
                systemResourceData.timestamps.shift();
                systemResourceData.cpuHistory.shift();
                systemResourceData.memoryHistory.shift();
                systemResourceData.diskIOHistory.shift();
                systemResourceData.networkInHistory.shift();
                systemResourceData.networkOutHistory.shift();
            }

            // 차트 업데이트
            updateSystemResourceCharts();
        }

        function updateSystemResourceCards(metrics) {
            // CPU 사용률 카드 업데이트
            const cpuPercent = metrics.cpu?.toFixed(1) || '-';
            document.getElementById('cpuUsagePercent').textContent = `${cpuPercent}%`;

            const cpuProgressBar = document.getElementById('cpuProgressBar');
            if (cpuProgressBar) {
                cpuProgressBar.style.width = `${metrics.cpu || 0}%`;
                // CPU 사용률에 따른 색상 변경
                if (metrics.cpu > 80) {
                    cpuProgressBar.className = 'bg-red-500 h-2 rounded-full transition-all duration-500';
                } else if (metrics.cpu > 60) {
                    cpuProgressBar.className = 'bg-yellow-500 h-2 rounded-full transition-all duration-500';
                } else {
                    cpuProgressBar.className = 'bg-green-500 h-2 rounded-full transition-all duration-500';
                }
            }

            // 메모리 사용률 카드 업데이트
            const memoryPercent = metrics.memory?.toFixed(1) || '-';
            document.getElementById('memoryUsagePercent').textContent = `${memoryPercent}%`;

            const memoryProgressBar = document.getElementById('memoryProgressBar');
            if (memoryProgressBar) {
                memoryProgressBar.style.width = `${metrics.memory || 0}%`;
                // 메모리 사용률에 따른 색상 변경
                if (metrics.memory > 80) {
                    memoryProgressBar.className = 'bg-red-500 h-2 rounded-full transition-all duration-500';
                } else if (metrics.memory > 60) {
                    memoryProgressBar.className = 'bg-yellow-500 h-2 rounded-full transition-all duration-500';
                } else {
                    memoryProgressBar.className = 'bg-blue-500 h-2 rounded-full transition-all duration-500';
                }
            }

            // 디스크 사용률 카드 업데이트
            const diskPercent = metrics.disk?.toFixed(1) || '-';
            document.getElementById('diskUsagePercent').textContent = `${diskPercent}%`;

            const diskProgressBar = document.getElementById('diskProgressBar');
            if (diskProgressBar) {
                diskProgressBar.style.width = `${metrics.disk || 0}%`;
                // 디스크 사용률에 따른 색상 변경
                if (metrics.disk > 90) {
                    diskProgressBar.className = 'bg-red-500 h-2 rounded-full transition-all duration-500';
                } else if (metrics.disk > 75) {
                    diskProgressBar.className = 'bg-yellow-500 h-2 rounded-full transition-all duration-500';
                } else {
                    diskProgressBar.className = 'bg-green-500 h-2 rounded-full transition-all duration-500';
                }
            }

            // 네트워크 I/O 카드 업데이트
            const networkIn = metrics.network?.in?.toFixed(1) || '0';
            const networkOut = metrics.network?.out?.toFixed(1) || '0';
            const totalIO = ((metrics.network?.in || 0) + (metrics.network?.out || 0)).toFixed(1);

            document.getElementById('networkIORate').textContent = `${totalIO}`;
            document.getElementById('networkUpload').textContent = networkOut;
            document.getElementById('networkDownload').textContent = networkIn;

            // 시스템 정보 요약 업데이트
            if (metrics.system_info) {
                document.getElementById('avgLoadLevel').textContent = metrics.system_info.load_average || '0.0';
                document.getElementById('activeProcesses').textContent = metrics.system_info.processes || '0';
                document.getElementById('systemHealthScore').textContent = metrics.system_info.health_score || '95';
            }
        }

        function updateSystemResourceCharts() {
            // CPU 사용률 차트 업데이트
            if (cpuUsageChart) {
                cpuUsageChart.data.labels = [...systemResourceData.timestamps];
                cpuUsageChart.data.datasets[0].data = [...systemResourceData.cpuHistory];
                cpuUsageChart.update('none');
            }

            // 메모리 사용률 차트 업데이트
            if (memoryUsageChart) {
                memoryUsageChart.data.labels = [...systemResourceData.timestamps];
                memoryUsageChart.data.datasets[0].data = [...systemResourceData.memoryHistory];
                memoryUsageChart.update('none');
            }

            // 디스크 I/O 차트 업데이트
            if (diskIOChart) {
                diskIOChart.data.labels = [...systemResourceData.timestamps];
                diskIOChart.data.datasets[0].data = [...systemResourceData.diskIOHistory];
                diskIOChart.update('none');
            }

            // 네트워크 I/O 차트 업데이트
            if (networkIOChart) {
                networkIOChart.data.labels = [...systemResourceData.timestamps];
                networkIOChart.data.datasets[0].data = [...systemResourceData.networkInHistory];
                networkIOChart.data.datasets[1].data = [...systemResourceData.networkOutHistory];
                networkIOChart.update('none');
            }
        }

        async function refreshSystemMetrics() {
            addLog('시스템 자원 메트릭 새로고침 중...', 'info');
            await fetchSystemMetrics();
        }

        function updateRealTimeCharts(metrics) {
            // Update real-time response chart
            if (realTimeResponseChart) {
                realTimeResponseChart.data.labels = [...metricsData.timestamps];
                realTimeResponseChart.data.datasets[0].data = [...metricsData.responseTimeHistory];
                realTimeResponseChart.update('none');
            }

            // Update system resource gauge
            if (systemResourceGauge) {
                systemResourceGauge.data.datasets[0].data = [
                    metrics.system?.cpu_percent || 0,
                    metrics.system?.memory_percent || 0,
                    metrics.system?.disk_percent || 0
                ];
                systemResourceGauge.update('none');
            }

            // Update DB performance chart
            if (dbPerformanceChart) {
                dbPerformanceChart.data.labels = [...metricsData.timestamps];
                dbPerformanceChart.data.datasets[0].data = [...metricsData.dbLatencyHistory];
                dbPerformanceChart.update('none');
            }

            // Update API calls chart with mock data
            if (apiCallsChart) {
                const endpoints = ['/api/health', '/api/metrics', '/api/status', '/api/data'];
                const calls = endpoints.map(() => Math.floor(Math.random() * 100));

                apiCallsChart.data.labels = endpoints;
                apiCallsChart.data.datasets[0].data = calls;
                apiCallsChart.update('none');
            }
        }

        // =============================================
        // Auto Refresh Functions
        // =============================================

        function toggleAutoRefresh() {
            autoRefreshEnabled = !autoRefreshEnabled;
            const toggle = document.getElementById('autoRefreshToggle');

            if (autoRefreshEnabled) {
                toggle.classList.add('active');
                startAutoRefresh();
                addLog('자동 새로고침 활성화', 'info');
            } else {
                toggle.classList.remove('active');
                stopAutoRefresh();
                addLog('자동 새로고침 비활성화', 'info');
            }
        }

        function startAutoRefresh() {
            if (refreshInterval) {
                clearInterval(refreshInterval);
            }

            refreshInterval = setInterval(async () => {
                await refreshAll();
            }, CONFIG.REFRESH_INTERVAL);
        }

        function stopAutoRefresh() {
            if (refreshInterval) {
                clearInterval(refreshInterval);
                refreshInterval = null;
            }
        }

        async function refreshAll() {
            addLog('전체 데이터 새로고침 시작', 'info');
            updateTimestamp();

            try {
                await Promise.allSettled([
                    checkHealth(),
                    checkAPI(),
                    refreshRealTimeMetrics(),
                    fetchSystemMetrics()  // 시스템 자원 메트릭도 자동 새로고침에 포함
                ]);

                addLog('전체 데이터 새로고침 완료', 'info');
            } catch (error) {
                addLog(`새로고침 중 오류 발생: ${error.message}`, 'error');
            }
        }

        // =============================================
        // Enhanced Alerts Panel Functions
        // =============================================

        // Alerts data and state management
        let allAlertsData = [];
        let filteredAlertsData = [];
        let alertsStats = { critical: 0, error: 0, warning: 0, info: 0 };
        let currentPage = 1;
        let alertsPerPage = 20;
        let searchTerm = '';
        let levelFilter = 'all';
        let dateFilter = 'today'; // 날짜 필터 변수 추가

        function generateMockAlerts() {
            const alertTypes = ['critical', 'error', 'warning', 'info'];
            const alertTitles = [
                'Database Connection Lost',
                'High Memory Usage Detected',
                'API Rate Limit Exceeded',
                'System Backup Completed',
                'New User Registration',
                'Service Restart Required',
                'Cache Clear Warning',
                'Security Alert Triggered',
                'Performance Degradation',
                'Health Check Success',
                'SSL Certificate Expiring',
                'Disk Space Warning',
                'Network Latency High',
                'Scheduled Maintenance',
                'Data Sync Complete',
                'Login Failure Detected',
                'File Upload Error',
                'Payment Processing Issue',
                'Email Service Down',
                'CDN Response Slow'
            ];

            const channels = ['Slack', 'Discord', 'Email', 'SMS'];
            const statuses = ['sent', 'failed', 'pending', 'retry'];

            const alerts = [];
            // Generate 100 alerts for better pagination testing
            for (let i = 0; i < 100; i++) {
                const type = alertTypes[Math.floor(Math.random() * alertTypes.length)];
                const title = alertTitles[Math.floor(Math.random() * alertTitles.length)];
                const timestamp = new Date(Date.now() - Math.random() * 30 * 24 * 60 * 60 * 1000); // Last 30 days

                // 로그 링크 생성 (심각도별)
                const logLinks = getLogLinksForType(type);

                // 추가 정보 생성
                const additionalInfo = getAdditionalInfoForAlert(type, title);

                // 로그 내용 (Critical과 Error의 경우만)
                const logContent = (type === 'critical' || type === 'error') ? generateMockLogContent(type) : null;

                alerts.push({
                    id: `alert-${String(i + 1).padStart(6, '0')}`, // alert-000001 형식
                    type: type,
                    title: title,
                    message: getAlertMessage(type, title),
                    timestamp: timestamp,
                    resolved: Math.random() > 0.7,
                    source: ['API', 'Database', 'Security', 'System', 'Network'][Math.floor(Math.random() * 5)],
                    channel: channels[Math.floor(Math.random() * channels.length)],
                    status: statuses[Math.floor(Math.random() * statuses.length)],
                    logLinks: logLinks,
                    additionalInfo: additionalInfo,
                    logContent: logContent,
                    retryCount: type === 'critical' || type === 'error' ? Math.floor(Math.random() * 3) : 0
                });
            }

            // Sort by timestamp (newest first)
            return alerts.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
        }

        // 심각도별 로그 링크 생성 함수
        function getLogLinksForType(type) {
            const baseUrl = 'http://localhost:8088/logs';
            const links = [];

            if (type === 'critical' || type === 'error') {
                links.push(
                    { name: '보안 로그', url: `${baseUrl}/security.log` },
                    { name: 'API 로그', url: `${baseUrl}/api.log` },
                    { name: '시스템 로그', url: `${baseUrl}/app.log` }
                );
            } else if (type === 'warning') {
                links.push(
                    { name: 'API 로그', url: `${baseUrl}/api.log` },
                    { name: '시스템 로그', url: `${baseUrl}/app.log` }
                );
            } else {
                links.push(
                    { name: '시스템 로그', url: `${baseUrl}/app.log` }
                );
            }

            return links;
        }

        // 추가 정보 생성 함수
        function getAdditionalInfoForAlert(type, title) {
            const additionalInfoMap = {
                'Database Connection Lost': {
                    'Connection Pool': '15/20 사용 중',
                    'Last Successful Connection': '2024-01-15 14:30:25',
                    'Error Code': 'DB_CONN_TIMEOUT_001'
                },
                'High Memory Usage Detected': {
                    'Memory Usage': '85% (6.8GB / 8GB)',
                    'Top Process': 'mcp-api (2.3GB)',
                    'Threshold': '80%'
                },
                'API Rate Limit Exceeded': {
                    'Client IP': '192.168.1.100',
                    'Request Count': '156/100 (분당)',
                    'Endpoint': '/api/v1/portfolio'
                },
                'Security Alert Triggered': {
                    'Event Type': 'Suspicious Login',
                    'Source IP': '203.0.113.50',
                    'Risk Level': 'High'
                }
            };

            return additionalInfoMap[title] || {
                'Alert ID': `ALT-${Math.floor(Math.random() * 100000)}`,
                'Source': 'MCP-MAP System',
                'Priority': type === 'critical' ? 'P1' : type === 'error' ? 'P2' : 'P3'
            };
        }

        // 모의 로그 내용 생성 함수
        function generateMockLogContent(type) {
            const criticalLogs = [
                '2024-01-15 14:30:25 [CRITICAL] Database connection pool exhausted',
                '2024-01-15 14:30:24 [ERROR] Failed to acquire database connection after 30s timeout',
                '2024-01-15 14:30:23 [WARN] Connection pool usage above 90%',
                '2024-01-15 14:30:22 [INFO] New connection request queued',
                '2024-01-15 14:30:21 [DEBUG] Active connections: 19/20'
            ];

            const errorLogs = [
                '2024-01-15 14:30:25 [ERROR] API request failed with status 500',
                '2024-01-15 14:30:24 [WARN] High response time detected: 2.5s',
                '2024-01-15 14:30:23 [INFO] Processing request from 192.168.1.100',
                '2024-01-15 14:30:22 [DEBUG] Request validation successful'
            ];

            return type === 'critical' ? criticalLogs.join('\n') : errorLogs.join('\n');
        }

        function getAlertMessage(type, title) {
            const messages = {
                critical: [
                    'Immediate attention required - system stability at risk',
                    'Service unavailable - critical failure detected',
                    'Data integrity compromised - urgent action needed'
                ],
                error: [
                    'Service error detected - user experience impacted',
                    'API request failed - retry mechanism activated',
                    'Process crashed - automatic restart attempted'
                ],
                warning: [
                    'Resource usage approaching threshold limits',
                    'Performance degradation observed in subsystem',
                    'Scheduled maintenance window approaching'
                ],
                info: [
                    'Routine operation completed successfully',
                    'System checkpoint reached normally',
                    'Regular maintenance task executed'
                ]
            };

            const typeMessages = messages[type] || messages.info;
            return typeMessages[Math.floor(Math.random() * typeMessages.length)];
        }

        function getAlertIcon(type) {
            const icons = {
                critical: '🚨',
                error: '❌',
                warning: '⚠️',
                info: 'ℹ️'
            };
            return icons[type] || 'ℹ️';
        }

        function getAlertColorClasses(type) {
            const colors = {
                critical: {
                    bg: 'bg-red-500/10 dark:bg-red-600/10',
                    border: 'border-l-red-500 dark:border-l-red-400',
                    text: 'text-red-300 dark:text-red-200',
                    time: 'text-red-400 dark:text-red-300'
                },
                error: {
                    bg: 'bg-orange-500/10 dark:bg-orange-600/10',
                    border: 'border-l-orange-500 dark:border-l-orange-400',
                    text: 'text-orange-300 dark:text-orange-200',
                    time: 'text-orange-400 dark:text-orange-300'
                },
                warning: {
                    bg: 'bg-yellow-500/10 dark:bg-yellow-600/10',
                    border: 'border-l-yellow-500 dark:border-l-yellow-400',
                    text: 'text-yellow-300 dark:text-yellow-200',
                    time: 'text-yellow-400 dark:text-yellow-300'
                },
                info: {
                    bg: 'bg-blue-500/10 dark:bg-blue-600/10',
                    border: 'border-l-blue-500 dark:border-l-blue-400',
                    text: 'text-blue-300 dark:text-blue-200',
                    time: 'text-blue-400 dark:text-blue-300'
                }
            };
            return colors[type] || colors.info;
        }

        function filterAlerts() {
            // Start with all alerts
            let filtered = [...allAlertsData];

            // Apply date filter (날짜 필터 적용)
            if (dateFilter !== 'all') {
                const now = new Date();
                const cutoffDate = new Date();

                switch (dateFilter) {
                    case 'today':
                        cutoffDate.setHours(0, 0, 0, 0); // 오늘 00:00:00
                        break;
                    case '7days':
                        cutoffDate.setDate(now.getDate() - 7); // 7일 전
                        break;
                    case '30days':
                        cutoffDate.setDate(now.getDate() - 30); // 30일 전
                        break;
                }

                filtered = filtered.filter(alert => new Date(alert.timestamp) >= cutoffDate);
            }

            // Apply level filter
            if (levelFilter !== 'all') {
                filtered = filtered.filter(alert => alert.type === levelFilter);
            }

            // Apply search filter
            if (searchTerm) {
                const searchLower = searchTerm.toLowerCase();
                filtered = filtered.filter(alert =>
                    alert.title.toLowerCase().includes(searchLower) ||
                    alert.message.toLowerCase().includes(searchLower) ||
                    alert.source.toLowerCase().includes(searchLower) ||
                    alert.id.toLowerCase().includes(searchLower)
                );
            }

            filteredAlertsData = filtered;
            currentPage = 1; // Reset to first page after filtering
            updateAlertsDisplay();
        }

        function updateAlertsStats() {
            alertsStats = { critical: 0, error: 0, warning: 0, info: 0 };

            allAlertsData.forEach(alert => {
                if (!alert.resolved && alertsStats.hasOwnProperty(alert.type)) {
                    alertsStats[alert.type]++;
                }
            });

            // Update UI
            document.getElementById('criticalCount').textContent = alertsStats.critical;
            document.getElementById('errorCount').textContent = alertsStats.error;
            document.getElementById('warningCount').textContent = alertsStats.warning;
            document.getElementById('infoCount').textContent = alertsStats.info;
        }

        function updateAlertsDisplay() {
            renderAlertsList();
            renderPagination();
            updateAlertsCounter();
        }

        function updateAlertsCounter() {
            const totalFiltered = filteredAlertsData.length;
            const totalPages = Math.ceil(totalFiltered / alertsPerPage);

            document.getElementById('alertsCount').textContent = `(${totalFiltered}개)`;
            document.getElementById('currentPageInfo').textContent = `페이지 ${currentPage} / ${totalPages}`;
        }

        function renderAlertsList() {
            const alertsList = document.getElementById('alertsList');

            if (filteredAlertsData.length === 0) {
                alertsList.innerHTML = `
                    <div class="p-4 text-center text-white/60 dark:text-gray-400">
                        ${searchTerm || levelFilter !== 'all' ? '검색 조건에 맞는 알림이 없습니다.' : '현재 표시할 알림이 없습니다.'}
                    </div>
                `;
                return;
            }

            // Calculate pagination
            const startIndex = (currentPage - 1) * alertsPerPage;
            const endIndex = startIndex + alertsPerPage;
            const pageAlerts = filteredAlertsData.slice(startIndex, endIndex);

            const alertsHtml = pageAlerts.map(alert => {
                const colors = getAlertColorClasses(alert.type);
                const icon = getAlertIcon(alert.type);
                const timeStr = alert.timestamp.toLocaleDateString('ko-KR', {
                    month: 'short',
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });

                const resolvedClass = alert.resolved ? 'opacity-60' : '';
                const resolvedBadge = alert.resolved ? '<span class="text-green-400 text-xs ml-2">✓ 해결됨</span>' : '';

                return `
                    <div class="border-b border-white/10 dark:border-gray-700 last:border-b-0 ${resolvedClass}">
                        <div class="p-4 ${colors.bg} ${colors.border} border-l-4 alert-item" onclick="showAlertDetailModal('${alert.id}')">
                            <div class="flex items-start justify-between">
                                <div class="flex-1">
                                    <div class="flex items-center mb-2">
                                        <span class="text-lg mr-2">${icon}</span>
                                        <span class="font-medium ${colors.text} text-sm uppercase tracking-wide">${alert.type}</span>
                                        ${resolvedBadge}
                                        <span class="text-white/60 text-xs ml-2">#${alert.id}</span>
                                    </div>
                                    <h4 class="text-white dark:text-gray-100 font-semibold mb-1">${alert.title}</h4>
                                    <p class="text-white/80 dark:text-gray-300 text-sm mb-2">${alert.message}</p>
                                    <div class="flex items-center space-x-4 text-xs text-white/60">
                                        <span>📡 ${alert.channel}</span>
                                        <span>📊 ${alert.source}</span>
                                        <span class="${alert.status === 'sent' ? 'text-green-400' : alert.status === 'failed' ? 'text-red-400' : 'text-yellow-400'}">
                                            ${alert.status === 'sent' ? '✅' : alert.status === 'failed' ? '❌' : '⏳'} ${alert.status}
                                        </span>
                                    </div>
                                </div>
                                <div class="text-right ml-4">
                                    <div class="${colors.time} text-xs">${timeStr}</div>
                                    <div class="text-white/60 text-xs mt-1">클릭하여 세부정보 보기</div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');

            alertsList.innerHTML = alertsHtml;
        }

        function renderPagination() {
            const totalPages = Math.ceil(filteredAlertsData.length / alertsPerPage);

            // Update pagination buttons
            const prevBtn = document.getElementById('prevPageBtn');
            const nextBtn = document.getElementById('nextPageBtn');
            const pageNumbers = document.getElementById('pageNumbers');

            prevBtn.disabled = currentPage === 1;
            nextBtn.disabled = currentPage === totalPages || totalPages === 0;

            // Generate page numbers
            let pageNumbersHtml = '';
            const maxVisiblePages = 5;
            let startPage = Math.max(1, currentPage - Math.floor(maxVisiblePages / 2));
            let endPage = Math.min(totalPages, startPage + maxVisiblePages - 1);

            if (endPage - startPage + 1 < maxVisiblePages) {
                startPage = Math.max(1, endPage - maxVisiblePages + 1);
            }

            for (let i = startPage; i <= endPage; i++) {
                const isActive = i === currentPage;
                pageNumbersHtml += `
                    <button
                        onclick="goToPage(${i})"
                        class="px-2 py-1 text-sm rounded transition-colors duration-200 ${isActive
                            ? 'bg-blue-600 text-white'
                            : 'bg-white/10 text-white/70 hover:bg-white/20'
                        }"
                    >
                        ${i}
                    </button>
                `;
            }

            pageNumbers.innerHTML = pageNumbersHtml;
        }

        function goToPage(page) {
            const totalPages = Math.ceil(filteredAlertsData.length / alertsPerPage);
            if (page >= 1 && page <= totalPages) {
                currentPage = page;
                updateAlertsDisplay();
            }
        }

        function changePage(direction) {
            const totalPages = Math.ceil(filteredAlertsData.length / alertsPerPage);
            let newPage = currentPage + direction;

            if (newPage >= 1 && newPage <= totalPages) {
                currentPage = newPage;
                updateAlertsDisplay();
            }
        }

        function changeAlertsPerPage(newPerPage) {
            alertsPerPage = newPerPage;
            currentPage = 1; // Reset to first page
            updateAlertsDisplay();
        }

        async function initializeAlerts() {
            try {
                // For now, use mock data. In production, this would fetch from API
                allAlertsData = generateMockAlerts();
                filteredAlertsData = [...allAlertsData];
                updateAlertsStats();
                updateAlertsDisplay();

                // Set up event listeners for filtering and pagination
                setupAlertsEventListeners();

                addLog('알림 패널 초기화 완료', 'info');
            } catch (error) {
                addLog(`알림 초기화 오류: ${error.message}`, 'error');
            }
        }

        function setupAlertsEventListeners() {
            // Search input
            const searchInput = document.getElementById('alertSearch');
            if (searchInput) {
                searchInput.addEventListener('input', function(e) {
                    searchTerm = e.target.value.trim();
                    filterAlerts();
                });
            }

            // Level filter
            const levelFilterSelect = document.getElementById('alertLevelFilter');
            if (levelFilterSelect) {
                levelFilterSelect.addEventListener('change', function(e) {
                    levelFilter = e.target.value;
                    filterAlerts();
                });
            }

            // Clear filters button
            const clearFiltersBtn = document.getElementById('clearFiltersBtn');
            if (clearFiltersBtn) {
                clearFiltersBtn.addEventListener('click', function() {
                    searchTerm = '';
                    levelFilter = 'all';
                    searchInput.value = '';
                    levelFilterSelect.value = 'all';
                    filterAlerts();
                });
            }

            // Pagination controls
            const prevPageBtn = document.getElementById('prevPageBtn');
            const nextPageBtn = document.getElementById('nextPageBtn');
            const alertsPerPageSelect = document.getElementById('alertsPerPageSelect');

            if (prevPageBtn) {
                prevPageBtn.addEventListener('click', () => changePage(-1));
            }

            if (nextPageBtn) {
                nextPageBtn.addEventListener('click', () => changePage(1));
            }

            if (alertsPerPageSelect) {
                alertsPerPageSelect.addEventListener('change', function(e) {
                    changeAlertsPerPage(parseInt(e.target.value));
                });
            }
        }

        async function refreshAlerts() {
            addLog('알림 데이터 새로고침 중...', 'info');

            try {
                // In production, this would fetch from the actual alerts API
                // For now, regenerate mock data to simulate refresh
                allAlertsData = generateMockAlerts();
                updateAlertsStats();
                filterAlerts(); // This will update the display with current filters
                addLog(`알림 새로고침 완료 - ${allAlertsData.length}개 알림 로드됨`, 'info');
            } catch (error) {
                addLog(`알림 새로고침 오류: ${error.message}`, 'error');
            }
        }

        async function sendTestAlert() {
            addLog('테스트 알림 전송 중...', 'info');

            try {
                // Create a test alert
                const testAlert = {
                    id: `test-alert-${Date.now()}`,
                    type: 'info',
                    title: 'Test Alert from Dashboard',
                    message: '관리자 대시보드에서 전송된 테스트 알림입니다.',
                    timestamp: new Date(),
                    resolved: false,
                    source: 'Dashboard'
                };

                // Add to the beginning of the alerts array
                allAlertsData.unshift(testAlert);

                // Keep only the latest 100 alerts
                if (allAlertsData.length > 100) {
                    allAlertsData = allAlertsData.slice(0, 100);
                }

                updateAlertsStats();
                filterAlerts(); // This will update the display with current filters
                addLog('테스트 알림이 성공적으로 생성되었습니다', 'info');

                // In production, this would also send the alert via the notification system
                // await fetch('/api/alerts/test', { method: 'POST', ... });

            } catch (error) {
                addLog(`테스트 알림 전송 오류: ${error.message}`, 'error');
            }
        }

        // =============================================
        // 새로운 알림 패널 기능들
        // =============================================

        // 알림 세부 정보 모달 표시 함수
        function showAlertDetailModal(alertId) {
            const alert = allAlertsData.find(a => a.id === alertId);
            if (!alert) {
                addLog(`알림을 찾을 수 없습니다: ${alertId}`, 'error');
                return;
            }

            // 모달 데이터 채우기
            const modal = document.getElementById('alertDetailModal');

            // 아이콘 설정
            const iconMap = {
                'critical': '🚨',
                'error': '❌',
                'warning': '⚠️',
                'info': 'ℹ️'
            };
            document.getElementById('modalAlertIcon').textContent = iconMap[alert.type] || '📢';

            // 기본 정보 설정
            document.getElementById('modalAlertTitle').textContent = alert.title;
            document.getElementById('modalAlertLevel').innerHTML = `<span class="${getAlertColorClasses(alert.type).text}">${iconMap[alert.type]} ${alert.type.toUpperCase()}</span>`;
            document.getElementById('modalAlertTime').textContent = alert.timestamp.toLocaleString('ko-KR');
            document.getElementById('modalAlertId').textContent = alert.id;
            document.getElementById('modalAlertChannel').textContent = alert.channel;

            // 상태 설정 (상태별 색상 적용)
            const statusElement = document.getElementById('modalAlertStatus');
            const statusColors = {
                'sent': 'text-green-600 dark:text-green-400',
                'failed': 'text-red-600 dark:text-red-400',
                'pending': 'text-yellow-600 dark:text-yellow-400',
                'retry': 'text-blue-600 dark:text-blue-400'
            };
            const statusIcons = {
                'sent': '✅',
                'failed': '❌',
                'pending': '⏳',
                'retry': '🔄'
            };
            statusElement.innerHTML = `<span class="${statusColors[alert.status] || ''}">${statusIcons[alert.status] || '❓'} ${alert.status}</span>`;

            // 메시지 설정
            document.getElementById('modalAlertMessage').textContent = alert.message;

            // 로그 링크 설정
            const logLinksContainer = document.getElementById('modalLogLinks');
            if (alert.logLinks && alert.logLinks.length > 0) {
                logLinksContainer.innerHTML = alert.logLinks.map(link => `
                    <a href="${link.url}" target="_blank"
                       class="inline-flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors duration-200 text-sm">
                        🔗 ${link.name}
                    </a>
                `).join('');
            } else {
                logLinksContainer.innerHTML = '<p class="text-gray-500 dark:text-gray-400 text-sm">관련 로그가 없습니다.</p>';
            }

            // 추가 정보 설정
            const additionalInfoElement = document.getElementById('modalAdditionalInfo');
            const additionalInfoContent = document.getElementById('modalAdditionalInfoContent');
            if (alert.additionalInfo && Object.keys(alert.additionalInfo).length > 0) {
                additionalInfoElement.classList.remove('hidden');
                additionalInfoContent.innerHTML = Object.entries(alert.additionalInfo)
                    .map(([key, value]) => `<div class="mb-2"><strong>${key}:</strong> ${value}</div>`)
                    .join('');
            } else {
                additionalInfoElement.classList.add('hidden');
            }

            // 로그 내용 설정
            const logContentElement = document.getElementById('modalLogContent');
            const logContentText = document.getElementById('modalLogContentText');
            if (alert.logContent) {
                logContentElement.classList.remove('hidden');
                logContentText.textContent = alert.logContent;
            } else {
                logContentElement.classList.add('hidden');
            }

            // 모달 표시
            modal.classList.remove('hidden');
            modal.classList.add('show');

            // 현재 선택된 알림 ID 저장 (내보내기용)
            modal.dataset.currentAlertId = alertId;

            addLog(`알림 세부 정보 모달 열림: ${alert.title}`, 'info');
        }

        // 알림 세부 정보 모달 숨김 함수
        function hideAlertDetailModal() {
            const modal = document.getElementById('alertDetailModal');
            modal.classList.add('hidden');
            modal.classList.remove('show');
            delete modal.dataset.currentAlertId;
            addLog('알림 세부 정보 모달 닫힘', 'info');
        }

        // 알림 내보내기 함수 (JSON/CSV)
        function exportAlerts(format) {
            const dataToExport = filteredAlertsData.length > 0 ? filteredAlertsData : allAlertsData;

            if (dataToExport.length === 0) {
                addLog('내보낼 알림이 없습니다', 'warning');
                return;
            }

            const timestamp = new Date().toISOString().replace(/[:.]/g, '-').slice(0, -5);
            const filename = `mcp-alerts-${timestamp}`;

            if (format === 'json') {
                exportAlertsAsJSON(dataToExport, filename);
            } else if (format === 'csv') {
                exportAlertsAsCSV(dataToExport, filename);
            }

            addLog(`알림 데이터 ${format.toUpperCase()} 내보내기 완료: ${dataToExport.length}개 항목`, 'info');
        }

        // JSON 형식으로 알림 내보내기
        function exportAlertsAsJSON(data, filename) {
            const exportData = data.map(alert => ({
                id: alert.id,
                type: alert.type,
                title: alert.title,
                message: alert.message,
                timestamp: alert.timestamp.toISOString(),
                resolved: alert.resolved,
                source: alert.source,
                channel: alert.channel,
                status: alert.status,
                retryCount: alert.retryCount,
                additionalInfo: alert.additionalInfo
            }));

            const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
            downloadFile(blob, `${filename}.json`);
        }

        // CSV 형식으로 알림 내보내기
        function exportAlertsAsCSV(data, filename) {
            const headers = ['ID', '심각도', '제목', '메시지', '발생시간', '해결여부', '소스', '채널', '상태', '재시도횟수'];
            const csvContent = [
                headers.join(','),
                ...data.map(alert => [
                    `"${alert.id}"`,
                    `"${alert.type}"`,
                    `"${alert.title.replace(/"/g, '""')}"`,
                    `"${alert.message.replace(/"/g, '""')}"`,
                    `"${alert.timestamp.toLocaleString('ko-KR')}"`,
                    `"${alert.resolved ? '해결됨' : '미해결'}"`,
                    `"${alert.source}"`,
                    `"${alert.channel}"`,
                    `"${alert.status}"`,
                    `"${alert.retryCount || 0}"`
                ].join(','))
            ].join('\n');

            // UTF-8 BOM 추가 (한글 깨짐 방지)
            const blob = new Blob(['\uFEFF' + csvContent], { type: 'text/csv;charset=utf-8;' });
            downloadFile(blob, `${filename}.csv`);
        }

        // 현재 모달의 알림 세부 정보 내보내기
        function exportCurrentAlertDetail() {
            const modal = document.getElementById('alertDetailModal');
            const alertId = modal.dataset.currentAlertId;

            if (!alertId) {
                addLog('내보낼 알림 정보가 없습니다', 'warning');
                return;
            }

            const alert = allAlertsData.find(a => a.id === alertId);
            if (!alert) {
                addLog('알림을 찾을 수 없습니다', 'error');
                return;
            }

            // 상세 정보를 포함한 JSON 생성
            const detailData = {
                id: alert.id,
                type: alert.type,
                title: alert.title,
                message: alert.message,
                timestamp: alert.timestamp.toISOString(),
                resolved: alert.resolved,
                source: alert.source,
                channel: alert.channel,
                status: alert.status,
                retryCount: alert.retryCount,
                logLinks: alert.logLinks,
                additionalInfo: alert.additionalInfo,
                logContent: alert.logContent,
                exportedAt: new Date().toISOString()
            };

            const timestamp = new Date().toISOString().replace(/[:.]/g, '-').slice(0, -5);
            const filename = `alert-detail-${alert.id}-${timestamp}.json`;

            const blob = new Blob([JSON.stringify(detailData, null, 2)], { type: 'application/json' });
            downloadFile(blob, filename);

            addLog(`알림 세부 정보 내보내기 완료: ${alert.title}`, 'info');
        }

        // 파일 다운로드 헬퍼 함수
        function downloadFile(blob, filename) {
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.style.display = 'none';
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            window.URL.revokeObjectURL(url);
            document.body.removeChild(a);
        }

        // =============================================
        // Security Panel Functions
        // =============================================

        // Security data storage
        let securityData = {
            blockedIps: [],
            violations: [],
            whitelist: [],
            stats: {
                blockedCount: 0,
                violationCount: 0,
                whitelistCount: 0,
                monitoredCount: 0
            }
        };

        let securityEventsChart = null;

        function generateMockSecurityData() {
            // Mock blocked IPs with violation details
            const mockBlockedIps = [
                { ip: '192.168.100.45', violations: 156, lastViolation: new Date(Date.now() - 30000), country: 'Unknown' },
                { ip: '203.142.78.23', violations: 89, lastViolation: new Date(Date.now() - 120000), country: 'CN' },
                { ip: '45.76.158.207', violations: 245, lastViolation: new Date(Date.now() - 300000), country: 'RU' },
                { ip: '178.128.45.91', violations: 67, lastViolation: new Date(Date.now() - 600000), country: 'SG' },
                { ip: '159.203.184.72', violations: 134, lastViolation: new Date(Date.now() - 900000), country: 'US' }
            ];

            // Generate violation events for chart (last 24 hours)
            const violationEvents = [];
            const now = Date.now();
            for (let i = 23; i >= 0; i--) {
                const hour = new Date(now - (i * 60 * 60 * 1000));
                const violations = Math.floor(Math.random() * 20) + (i < 6 ? Math.random() * 30 : 0); // More activity in recent hours
                violationEvents.push({
                    time: hour,
                    violations: violations
                });
            }

            // Mock whitelist (load from localStorage if available)
            const savedWhitelist = localStorage.getItem('mcp-security-whitelist');
            const mockWhitelist = savedWhitelist ? JSON.parse(savedWhitelist) : [
                '127.0.0.1',
                '::1',
                '192.168.1.0/24',
                '10.0.0.0/8'
            ];

            return {
                blockedIps: mockBlockedIps,
                violations: violationEvents,
                whitelist: mockWhitelist,
                stats: {
                    blockedCount: mockBlockedIps.length,
                    violationCount: violationEvents.reduce((sum, event) => sum + event.violations, 0),
                    whitelistCount: mockWhitelist.length,
                    monitoredCount: mockBlockedIps.length + Math.floor(Math.random() * 50) + 20
                }
            };
        }

        function updateSecurityStats() {
            // Update stats cards
            document.getElementById('blockedIpCount').textContent = securityData.stats.blockedCount;
            document.getElementById('rateLimitViolations').textContent = securityData.stats.violationCount;
            document.getElementById('whitelistCount').textContent = securityData.stats.whitelistCount;
            document.getElementById('monitoredIpCount').textContent = securityData.stats.monitoredCount;
        }

        function renderBlockedIpsList() {
            const blockedIpsList = document.getElementById('blockedIpsList');

            if (securityData.blockedIps.length === 0) {
                blockedIpsList.innerHTML = `
                    <div class="text-center text-white/60 dark:text-gray-400 py-8">
                        차단된 IP가 없습니다.
                    </div>
                `;
                return;
            }

            const ipsHtml = securityData.blockedIps.map(ipData => {
                const timeStr = ipData.lastViolation.toLocaleDateString('ko-KR', {
                    month: 'short',
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });

                const countryFlag = getCountryFlag(ipData.country);

                return `
                    <div class="bg-red-500/10 dark:bg-red-600/10 border border-red-400/30 rounded-lg p-3">
                        <div class="flex items-center justify-between">
                            <div class="flex-1">
                                <div class="flex items-center">
                                    <span class="font-mono text-white dark:text-gray-100 font-semibold">${ipData.ip}</span>
                                    <span class="ml-2 text-lg">${countryFlag}</span>
                                </div>
                                <div class="text-red-300 dark:text-red-200 text-sm mt-1">
                                    ${ipData.violations}회 위반 • 마지막: ${timeStr}
                                </div>
                            </div>
                            <button onclick="unblockIp('${ipData.ip}')" class="text-red-300 hover:text-red-100 transition-colors duration-200">
                                🗑️
                            </button>
                        </div>
                    </div>
                `;
            }).join('');

            blockedIpsList.innerHTML = ipsHtml;
        }

        function getCountryFlag(countryCode) {
            const flags = {
                'US': '🇺🇸', 'CN': '🇨🇳', 'RU': '🇷🇺', 'SG': '🇸🇬',
                'DE': '🇩🇪', 'JP': '🇯🇵', 'KR': '🇰🇷', 'GB': '🇬🇧',
                'FR': '🇫🇷', 'CA': '🇨🇦', 'Unknown': '🏴‍☠️'
            };
            return flags[countryCode] || '🌍';
        }

        function createSecurityEventsChart() {
            const ctx = document.getElementById('securityEventsChart').getContext('2d');

            // Prepare chart data
            const labels = securityData.violations.map(event =>
                event.time.toLocaleDateString('ko-KR', { hour: '2-digit', minute: '2-digit' })
            );
            const data = securityData.violations.map(event => event.violations);

            const isDark = darkModeManager && darkModeManager.isDarkMode();
            const textColor = isDark ? '#f3f4f6' : '#ffffff';
            const gridColor = isDark ? 'rgba(156, 163, 175, 0.2)' : 'rgba(255, 255, 255, 0.1)';

            securityEventsChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: '차단 이벤트',
                        data: data,
                        borderColor: '#ef4444',
                        backgroundColor: 'rgba(239, 68, 68, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            labels: { color: textColor }
                        }
                    },
                    scales: {
                        x: {
                            ticks: {
                                color: textColor,
                                maxTicksLimit: 6
                            },
                            grid: { color: gridColor }
                        },
                        y: {
                            ticks: { color: textColor },
                            grid: { color: gridColor },
                            beginAtZero: true
                        }
                    }
                }
            });

            // Store chart reference globally for theme updates
            window.securityEventsChart = securityEventsChart;
        }

        async function fetchSecurityData() {
            try {
                addLog('보안 데이터 로드 중...', 'info');

                // In production, this would fetch from the actual security API
                // For now, use mock data
                const response = await fetch('/api/v1/security/stats').catch(() => null);

                if (response && response.ok) {
                    const apiData = await response.json();
                    // Merge API data with mock data
                    securityData = {
                        ...generateMockSecurityData(),
                        stats: {
                            ...generateMockSecurityData().stats,
                            ...apiData
                        }
                    };
                } else {
                    // Use mock data if API is not available
                    securityData = generateMockSecurityData();
                }

                addLog(`보안 데이터 로드 완료 - 차단된 IP: ${securityData.stats.blockedCount}개`, 'info');
                return true;
            } catch (error) {
                addLog(`보안 데이터 로드 오류: ${error.message}`, 'error');
                // Fallback to mock data
                securityData = generateMockSecurityData();
                return false;
            }
        }

        async function refreshSecurityData() {
            addLog('보안 데이터 새로고침 중...', 'info');

            try {
                await fetchSecurityData();
                updateSecurityStats();
                renderBlockedIpsList();

                // Update chart if it exists
                if (securityEventsChart) {
                    const labels = securityData.violations.map(event =>
                        event.time.toLocaleDateString('ko-KR', { hour: '2-digit', minute: '2-digit' })
                    );
                    const data = securityData.violations.map(event => event.violations);

                    securityEventsChart.data.labels = labels;
                    securityEventsChart.data.datasets[0].data = data;
                    securityEventsChart.update('none');
                }

                addLog('보안 데이터 새로고침 완료', 'info');
            } catch (error) {
                addLog(`보안 데이터 새로고침 오류: ${error.message}`, 'error');
            }
        }

        async function addIpToWhitelist() {
            const ipInput = document.getElementById('whitelistIpInput');
            const resultDiv = document.getElementById('whitelistResult');
            const ip = ipInput.value.trim();

            if (!ip) {
                showWhitelistResult('IP 주소를 입력해주세요.', 'error');
                return;
            }

            // Basic IP validation
            const ipRegex = /^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/;
            if (!ipRegex.test(ip) && !ip.includes('/')) {
                showWhitelistResult('올바른 IP 주소 형식이 아닙니다.', 'error');
                return;
            }

            try {
                addLog(`IP 화이트리스트 추가 시도: ${ip}`, 'info');

                // Try to call the API
                const response = await fetch(`/api/v1/security/whitelist/${encodeURIComponent(ip)}`, {
                    method: 'POST'
                }).catch(() => null);

                let success = false;
                if (response && response.ok) {
                    const result = await response.json();
                    success = result.success;
                } else {
                    // Fallback to localStorage for demo
                    const existingWhitelist = localStorage.getItem('mcp-security-whitelist');
                    const whitelist = existingWhitelist ? JSON.parse(existingWhitelist) : [];

                    if (!whitelist.includes(ip)) {
                        whitelist.push(ip);
                        localStorage.setItem('mcp-security-whitelist', JSON.stringify(whitelist));
                        success = true;
                    }
                }

                if (success) {
                    showWhitelistResult(`IP ${ip}가 화이트리스트에 추가되었습니다.`, 'success');
                    ipInput.value = '';

                    // Update security data
                    if (!securityData.whitelist.includes(ip)) {
                        securityData.whitelist.push(ip);
                        securityData.stats.whitelistCount++;
                        updateSecurityStats();
                    }

                    addLog(`IP 화이트리스트 추가 완료: ${ip}`, 'info');
                } else {
                    showWhitelistResult('화이트리스트 추가에 실패했습니다.', 'error');
                }
            } catch (error) {
                showWhitelistResult(`오류: ${error.message}`, 'error');
                addLog(`IP 화이트리스트 추가 오류: ${error.message}`, 'error');
            }
        }

        function showWhitelistResult(message, type) {
            const resultDiv = document.getElementById('whitelistResult');
            resultDiv.textContent = message;
            resultDiv.className = `mt-3 text-sm ${type === 'success' ? 'text-green-400' : 'text-red-400'}`;
            resultDiv.classList.remove('hidden');

            // Hide after 3 seconds
            setTimeout(() => {
                resultDiv.classList.add('hidden');
            }, 3000);
        }

        function unblockIp(ip) {
            if (confirm(`IP ${ip}의 차단을 해제하시겠습니까?`)) {
                // Remove from blocked list
                securityData.blockedIps = securityData.blockedIps.filter(item => item.ip !== ip);
                securityData.stats.blockedCount = securityData.blockedIps.length;

                updateSecurityStats();
                renderBlockedIpsList();
                addLog(`IP 차단 해제: ${ip}`, 'info');
            }
        }

        async function initializeSecurity() {
            try {
                addLog('보안 패널 초기화 중...', 'info');

                await fetchSecurityData();
                updateSecurityStats();
                renderBlockedIpsList();
                createSecurityEventsChart();

                addLog('보안 패널 초기화 완료', 'info');
            } catch (error) {
                addLog(`보안 패널 초기화 오류: ${error.message}`, 'error');
            }
        }

        // =============================================
        // 보안 로그 패널 Functions
        // =============================================

        // 보안 로그 데이터 가져오기
        async function fetchSecurityLogs() {
            try {
                const res = await fetch("/api/v1/security/logs", {
                    headers: {"X-API-KEY": localStorage.getItem("api_key")}
                });

                if (res.ok) {
                    const data = await res.json();

                    // UI 업데이트
                    document.getElementById("securityLogBlockedIpCount").innerText = data.blocked || 0;
                    document.getElementById("securityLogRateLimitCount").innerText = data.violations || 0;
                    document.getElementById("securityLogWhitelistCount").innerText = data.whitelist || 0;
                    document.getElementById("securityLogMonitoringCount").innerText = data.monitoring || 0;

                    // 로그 리스트 렌더링
                    const list = data.logs.map(log => `<div class="p-2 border-b border-white/10 text-white/80">[${log.level}] ${log.time} - ${log.msg}</div>`).join("");
                    document.getElementById("securityLogList").innerHTML = list || '<div class="p-4 text-center text-white/60">보안 로그가 없습니다.</div>';

                    addLog('보안 로그 업데이트 완료', 'info');
                } else {
                    // Mock 데이터 사용
                    updateSecurityLogsMockData();
                }
            } catch (err) {
                console.error("보안 로그 불러오기 실패", err);
                addLog(`보안 로그 불러오기 실패: ${err.message}`, 'error');
                // Mock 데이터로 대체
                updateSecurityLogsMockData();
            }
        }

        // Mock 데이터로 보안 로그 업데이트
        function updateSecurityLogsMockData() {
            // Mock 통계 데이터
            document.getElementById("securityLogBlockedIpCount").innerText = Math.floor(Math.random() * 50);
            document.getElementById("securityLogRateLimitCount").innerText = Math.floor(Math.random() * 25);
            document.getElementById("securityLogWhitelistCount").innerText = Math.floor(Math.random() * 10) + 5;
            document.getElementById("securityLogMonitoringCount").innerText = Math.floor(Math.random() * 100);

            // Mock 로그 데이터
            const mockLogs = [
                { level: 'INFO', time: new Date().toLocaleTimeString(), msg: '정상적인 API 요청 처리' },
                { level: 'WARN', time: new Date(Date.now() - 60000).toLocaleTimeString(), msg: 'Rate limit 임계값 근접 (IP: 192.168.1.100)' },
                { level: 'ERROR', time: new Date(Date.now() - 120000).toLocaleTimeString(), msg: '의심스러운 IP 차단됨 (IP: 10.0.0.1)' },
                { level: 'INFO', time: new Date(Date.now() - 180000).toLocaleTimeString(), msg: '화이트리스트 IP 접근 허용' },
                { level: 'WARN', time: new Date(Date.now() - 240000).toLocaleTimeString(), msg: '비정상적인 요청 패턴 감지' }
            ];

            const logElements = mockLogs.map(log =>
                `<div class="p-2 border-b border-white/10 text-white/80 flex">
                    <span class="w-16 text-xs ${log.level === 'ERROR' ? 'text-red-400' : log.level === 'WARN' ? 'text-yellow-400' : 'text-green-400'}">[${log.level}]</span>
                    <span class="w-20 text-xs text-white/60">${log.time}</span>
                    <span class="flex-1 text-sm">${log.msg}</span>
                </div>`
            ).join("");

            document.getElementById("securityLogList").innerHTML = logElements;
        }

        // 보안 로그 차트 초기화
        function initSecurityLogChart() {
            const ctx = document.getElementById('securityChart');
            if (!ctx) return;

            const isDark = darkModeManager?.isDarkMode() || false;
            const textColor = isDark ? '#f3f4f6' : '#ffffff';
            const gridColor = isDark ? 'rgba(156, 163, 175, 0.2)' : 'rgba(255, 255, 255, 0.1)';

            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['1시간 전', '50분 전', '40분 전', '30분 전', '20분 전', '10분 전', '현재'],
                    datasets: [{
                        label: '차단된 요청',
                        data: [12, 8, 15, 6, 20, 3, 7],
                        borderColor: '#ef4444',
                        backgroundColor: 'rgba(239, 68, 68, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4
                    }, {
                        label: 'Rate Limit 위반',
                        data: [5, 12, 8, 14, 9, 6, 11],
                        borderColor: '#f59e0b',
                        backgroundColor: 'rgba(245, 158, 11, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            labels: { color: textColor }
                        }
                    },
                    scales: {
                        x: {
                            ticks: { color: textColor },
                            grid: { color: gridColor }
                        },
                        y: {
                            ticks: { color: textColor },
                            grid: { color: gridColor }
                        }
                    }
                }
            });
        }

        // =============================================
        // Initialization
        // =============================================

        document.addEventListener('DOMContentLoaded', async function() {
            // Initialize dark mode manager
            darkModeManager = new DarkModeManager();

            // Initialize charts
            initRealTimeMetricsCharts();
            initSystemResourceCharts();

            // Set up event listeners
            document.getElementById('refreshBtn').addEventListener('click', refreshAll);
            document.getElementById('autoRefreshToggle').addEventListener('click', toggleAutoRefresh);
            document.getElementById('refreshMetricsBtn').addEventListener('click', refreshRealTimeMetrics);

            // 시스템 자원 모니터링 이벤트 리스너 추가
            document.getElementById('refreshSystemMetricsBtn').addEventListener('click', refreshSystemMetrics);
            document.getElementById('clearLogsBtn').addEventListener('click', () => {
                document.getElementById('logContainer').innerHTML = '';
                addLog('로그가 지워졌습니다', 'info');
            });

            // Alerts Panel Event Listeners
            document.getElementById('refreshAlertsBtn').addEventListener('click', refreshAlerts);
            document.getElementById('testAlertBtn').addEventListener('click', sendTestAlert);

            // 새로운 알림 패널 기능 이벤트 리스너들
            // 날짜 필터 버튼들
            document.querySelectorAll('.date-filter').forEach(button => {
                button.addEventListener('click', function() {
                    // 모든 날짜 필터 버튼의 active 클래스 제거
                    document.querySelectorAll('.date-filter').forEach(btn => btn.classList.remove('active'));
                    // 클릭한 버튼에 active 클래스 추가
                    this.classList.add('active');
                    // 날짜 필터 설정
                    dateFilter = this.dataset.filter;
                    // 필터 적용
                    filterAlerts();
                });
            });

            // 내보내기 버튼들
            document.getElementById('exportAlertsJSON').addEventListener('click', () => exportAlerts('json'));
            document.getElementById('exportAlertsCSV').addEventListener('click', () => exportAlerts('csv'));

            // 모달 관련 이벤트 리스너들
            document.getElementById('closeModalBtn').addEventListener('click', hideAlertDetailModal);
            document.getElementById('modalCloseBtn').addEventListener('click', hideAlertDetailModal);
            document.getElementById('modalExportBtn').addEventListener('click', exportCurrentAlertDetail);

            // 모달 배경 클릭 시 닫기
            document.getElementById('alertDetailModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    hideAlertDetailModal();
                }
            });

            // ESC 키로 모달 닫기
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && !document.getElementById('alertDetailModal').classList.contains('hidden')) {
                    hideAlertDetailModal();
                }
            });

            // Listen for theme changes
            document.addEventListener('themeChanged', (event) => {
                addLog(`테마 변경: ${event.detail.darkMode ? '다크모드' : '라이트모드'}`, 'info');
            });

            // Initialize alerts panel
            await initializeAlerts();
            await initializeSecurity();

            // Set up security event listeners
            document.getElementById('refreshSecurityBtn').addEventListener('click', refreshSecurityData);
            document.getElementById('addWhitelistBtn').addEventListener('click', addIpToWhitelist);
            document.getElementById('whitelistIpInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    addIpToWhitelist();
                }
            });

            // 보안 로그 패널 이벤트 리스너 추가
            document.getElementById('refreshSecurityLogsBtn').addEventListener('click', fetchSecurityLogs);

            // Initial load
            await refreshAll();

            // 시스템 자원 메트릭 초기 로드
            await fetchSystemMetrics();

            // 보안 로그 패널 초기화
            initSecurityLogChart();
            await fetchSecurityLogs();

            // 보안 로그 30초마다 자동 새로고침
            setInterval(fetchSecurityLogs, 30000);

            // Set up uptime counter
            let startTime = Date.now();
            setInterval(() => {
                const uptime = Date.now() - startTime;
                const hours = Math.floor(uptime / (1000 * 60 * 60));
                const minutes = Math.floor((uptime % (1000 * 60 * 60)) / (1000 * 60));
                document.getElementById('uptime').textContent = `${hours}h ${minutes}m`;
            }, 60000);

            addLog('대시보드 초기화 완료', 'info');
        });

        // =============================================
        // Global Error Handler
        // =============================================

        window.addEventListener('error', function(event) {
            addLog(`JavaScript 오류: ${event.error?.message || event.message}`, 'error');
        });

        window.addEventListener('unhandledrejection', function(event) {
            addLog(`처리되지 않은 Promise 거부: ${event.reason}`, 'error');
        });

        // =============================================
        // 🔔 운영 알림 통합 패널 JavaScript Implementation
        // =============================================

        class OpsNotificationManager {
            constructor() {
                this.notifications = [];
                this.filteredNotifications = [];
                this.currentFilter = 'all';
                this.autoRefreshInterval = null;
                this.init();
            }

            init() {
                // DOM 요소 바인딩
                this.bindElements();

                // 이벤트 리스너 설정
                this.setupEventListeners();

                // 초기 데이터 로드
                this.loadNotifications();

                // 자동 새로고침 시작 (30초마다)
                this.startAutoRefresh();

                // 페이지 언로드 시 자동 새로고침 정리
                window.addEventListener('beforeunload', () => {
                    this.stopAutoRefresh();
                });
            }

            bindElements() {
                // 필터 버튼들
                this.filterAllBtn = document.getElementById('filterAllBtn');
                this.filterSecurityBtn = document.getElementById('filterSecurityBtn');
                this.filterBackupBtn = document.getElementById('filterBackupBtn');
                this.filterSystemBtn = document.getElementById('filterSystemBtn');

                // 새로고침 버튼
                this.refreshBtn = document.getElementById('refreshOpsNotificationsBtn');

                // 통계 카드들
                this.criticalCountEl = document.getElementById('criticalNotificationCount');
                this.errorCountEl = document.getElementById('errorNotificationCount');
                this.warningCountEl = document.getElementById('warningNotificationCount');
                this.infoCountEl = document.getElementById('infoNotificationCount');

                // 알림 목록 컨테이너
                this.notificationListEl = document.getElementById('opsNotificationsList');

                // JSON 데이터 모달 요소들
                this.jsonModal = document.getElementById('jsonDataModal');
                this.jsonContentEl = document.getElementById('jsonContent');
                this.closeJsonModalBtn = document.getElementById('closeJsonModalBtn');
            }

            setupEventListeners() {
                // 필터 버튼 이벤트
                this.filterAllBtn?.addEventListener('click', () => this.setFilter('all'));
                this.filterSecurityBtn?.addEventListener('click', () => this.setFilter('security'));
                this.filterBackupBtn?.addEventListener('click', () => this.setFilter('backup'));
                this.filterSystemBtn?.addEventListener('click', () => this.setFilter('system'));

                // 새로고침 버튼 이벤트
                this.refreshBtn?.addEventListener('click', () => this.loadNotifications());

                // JSON 모달 닫기 이벤트
                this.closeJsonModalBtn?.addEventListener('click', () => this.closeJsonModal());
                this.jsonModal?.addEventListener('click', (e) => {
                    if (e.target === this.jsonModal) {
                        this.closeJsonModal();
                    }
                });
            }

            async loadNotifications() {
                try {
                    // 로딩 상태 표시
                    this.showLoadingState();

                    // 모의 데이터 생성 (실제 구현에서는 API 호출)
                    await this.generateMockNotifications();

                    // 통계 업데이트
                    this.updateStatistics();

                    // 필터링된 알림 목록 표시
                    this.displayNotifications();

                    // 로딩 상태 해제
                    this.hideLoadingState();

                    addLog('운영 알림 데이터가 성공적으로 로드되었습니다.', 'info');
                } catch (error) {
                    console.error('알림 로드 중 오류:', error);
                    addLog(`운영 알림 로드 실패: ${error.message}`, 'error');
                    this.hideLoadingState();
                }
            }

            async generateMockNotifications() {
                // 실제 환경에서는 이 부분을 API 호출로 대체
                const mockData = [
                    {
                        id: `ops-${Date.now()}-1`,
                        type: 'security',
                        level: 'critical',
                        title: '🚨 보안 침입 시도 탐지',
                        message: '비정상적인 로그인 시도가 감지되었습니다. IP: 192.168.1.100에서 5분간 50회 실패',
                        timestamp: new Date(Date.now() - 300000).toISOString(),
                        source: 'Security Logger',
                        status: 'active',
                        jsonData: {
                            ip_address: '192.168.1.100',
                            failed_attempts: 50,
                            duration_minutes: 5,
                            blocked: true,
                            action_taken: 'IP 차단'
                        }
                    },
                    {
                        id: `ops-${Date.now()}-2`,
                        type: 'backup',
                        level: 'warning',
                        title: '⚠️ 백업 검증 경고',
                        message: '일부 백업 파일의 체크섬이 일치하지 않습니다. 즉시 확인이 필요합니다.',
                        timestamp: new Date(Date.now() - 600000).toISOString(),
                        source: 'Backup Verifier',
                        status: 'pending',
                        jsonData: {
                            backup_date: '2024-01-15',
                            corrupted_files: 3,
                            total_files: 127,
                            integrity_percentage: 97.6
                        }
                    },
                    {
                        id: `ops-${Date.now()}-3`,
                        type: 'system',
                        level: 'info',
                        title: 'ℹ️ 시스템 정기 점검 완료',
                        message: '정기 시스템 점검이 성공적으로 완료되었습니다.',
                        timestamp: new Date(Date.now() - 1800000).toISOString(),
                        source: 'System Monitor',
                        status: 'completed',
                        jsonData: {
                            check_duration: '15분',
                            checked_services: 23,
                            issues_found: 0,
                            next_check: '2024-01-16 02:00:00'
                        }
                    }
                ];

                // 시뮬레이션을 위한 지연
                await new Promise(resolve => setTimeout(resolve, 500));

                this.notifications = mockData;
                this.applyCurrentFilter();
            }

            setFilter(filterType) {
                this.currentFilter = filterType;

                // 버튼 상태 업데이트
                this.updateFilterButtons();

                // 필터 적용 및 표시
                this.applyCurrentFilter();
                this.displayNotifications();

                addLog(`알림 필터가 '${filterType}'로 변경되었습니다.`, 'info');
            }

            updateFilterButtons() {
                const buttons = [this.filterAllBtn, this.filterSecurityBtn, this.filterBackupBtn, this.filterSystemBtn];
                const filters = ['all', 'security', 'backup', 'system'];

                buttons.forEach((btn, index) => {
                    if (!btn) return;

                    if (filters[index] === this.currentFilter) {
                        btn.classList.add('bg-blue-600', 'text-white', 'border-blue-600');
                        btn.classList.remove('bg-white/10', 'text-white/80', 'border-white/20');
                    } else {
                        btn.classList.remove('bg-blue-600', 'text-white', 'border-blue-600');
                        btn.classList.add('bg-white/10', 'text-white/80', 'border-white/20');
                    }
                });
            }

            applyCurrentFilter() {
                if (this.currentFilter === 'all') {
                    this.filteredNotifications = [...this.notifications];
                } else {
                    this.filteredNotifications = this.notifications.filter(
                        notification => notification.type === this.currentFilter
                    );
                }
            }

            updateStatistics() {
                const stats = {
                    critical: this.notifications.filter(n => n.level === 'critical').length,
                    error: this.notifications.filter(n => n.level === 'error').length,
                    warning: this.notifications.filter(n => n.level === 'warning').length,
                    info: this.notifications.filter(n => n.level === 'info').length
                };

                if (this.criticalCountEl) this.criticalCountEl.textContent = stats.critical;
                if (this.errorCountEl) this.errorCountEl.textContent = stats.error;
                if (this.warningCountEl) this.warningCountEl.textContent = stats.warning;
                if (this.infoCountEl) this.infoCountEl.textContent = stats.info;
            }

            displayNotifications() {
                if (!this.notificationListEl) {
                    console.warn('알림 목록 요소를 찾을 수 없습니다.');
                    return;
                }

                if (this.filteredNotifications.length === 0) {
                    this.notificationListEl.innerHTML = `
                        <div class="text-center text-gray-400 py-8">
                            <div class="text-4xl mb-2">📭</div>
                            <div>현재 표시할 알림이 없습니다.</div>
                        </div>
                    `;
                    return;
                }

                const notificationHtml = this.filteredNotifications.map(notification => {
                    const levelIcon = this.getLevelIcon(notification.level);
                    const levelColor = this.getLevelColor(notification.level);
                    const typeIcon = this.getTypeIcon(notification.type);
                    const statusBadge = this.getStatusBadge(notification.status);

                    return `
                        <div class="bg-white/10 dark:bg-gray-700/50 rounded-lg p-4 backdrop-filter backdrop-blur-sm border border-${levelColor}-500/30">
                            <div class="flex items-start justify-between">
                                <div class="flex items-start space-x-3 flex-1">
                                    <div class="text-2xl">${levelIcon}</div>
                                    <div class="flex-1">
                                        <div class="flex items-center space-x-2 mb-1">
                                            <h4 class="text-white dark:text-gray-100 font-semibold">${notification.title}</h4>
                                            <span class="text-xs px-2 py-1 rounded-full bg-gray-700 text-gray-300">${typeIcon} ${notification.type}</span>
                                            ${statusBadge}
                                        </div>
                                        <p class="text-white/80 dark:text-gray-300 text-sm mb-2">${notification.message}</p>
                                        <div class="flex items-center justify-between text-xs text-white/60 dark:text-gray-400">
                                            <span>📅 ${new Date(notification.timestamp).toLocaleString('ko-KR')}</span>
                                            <span>📡 ${notification.source}</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="flex items-center space-x-2 ml-4">
                                    <button
                                        onclick="opsNotificationManager.showJsonData('${notification.id}')"
                                        class="text-xs px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors duration-200"
                                        title="JSON 데이터 보기"
                                    >
                                        📄 JSON
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');

                this.notificationListEl.innerHTML = notificationHtml;
            }

            getLevelIcon(level) {
                const icons = {
                    critical: '🚨',
                    error: '❌',
                    warning: '⚠️',
                    info: 'ℹ️'
                };
                return icons[level] || 'ℹ️';
            }

            getLevelColor(level) {
                const colors = {
                    critical: 'red',
                    error: 'red',
                    warning: 'yellow',
                    info: 'blue'
                };
                return colors[level] || 'blue';
            }

            getTypeIcon(type) {
                const icons = {
                    security: '🛡️',
                    backup: '💾',
                    system: '⚙️'
                };
                return icons[type] || '⚙️';
            }

            getStatusBadge(status) {
                const badges = {
                    active: '<span class="text-xs px-2 py-1 rounded-full bg-red-600 text-white">활성</span>',
                    pending: '<span class="text-xs px-2 py-1 rounded-full bg-yellow-600 text-white">대기</span>',
                    completed: '<span class="text-xs px-2 py-1 rounded-full bg-green-600 text-white">완료</span>'
                };
                return badges[status] || '';
            }

            showJsonData(notificationId) {
                const notification = this.notifications.find(n => n.id === notificationId);
                if (!notification) {
                    addLog('해당 알림을 찾을 수 없습니다.', 'error');
                    return;
                }

                if (this.jsonContentEl) {
                    this.jsonContentEl.textContent = JSON.stringify(notification.jsonData, null, 2);
                }

                if (this.jsonModal) {
                    this.jsonModal.classList.remove('hidden');
                    this.jsonModal.classList.add('flex');
                }

                addLog(`알림 ID ${notificationId}의 JSON 데이터를 표시합니다.`, 'info');
            }

            closeJsonModal() {
                if (this.jsonModal) {
                    this.jsonModal.classList.add('hidden');
                    this.jsonModal.classList.remove('flex');
                }
            }

            showLoadingState() {
                if (this.notificationListEl) {
                    this.notificationListEl.innerHTML = `
                        <div class="text-center text-gray-400 py-8">
                            <div class="animate-spin text-4xl mb-2">🔄</div>
                            <div>운영 알림 데이터를 로드하는 중...</div>
                        </div>
                    `;
                }

                if (this.refreshBtn) {
                    this.refreshBtn.disabled = true;
                    this.refreshBtn.innerHTML = '<span class="mr-2">🔄</span>로딩 중...';
                }
            }

            hideLoadingState() {
                if (this.refreshBtn) {
                    this.refreshBtn.disabled = false;
                    this.refreshBtn.innerHTML = '<span class="mr-2">🔄</span>새로고침';
                }
            }

            startAutoRefresh() {
                this.stopAutoRefresh(); // 기존 인터벌 정리
                this.autoRefreshInterval = setInterval(() => {
                    this.loadNotifications();
                }, 30000); // 30초마다 새로고침
            }

            stopAutoRefresh() {
                if (this.autoRefreshInterval) {
                    clearInterval(this.autoRefreshInterval);
                    this.autoRefreshInterval = null;
                }
            }
        }

        // =============================================
        // 📊 CI/CD 성능 리포트 패널 JavaScript Implementation
        // =============================================

        class CIReportManager {
            constructor() {
                this.reports = [];
                this.filteredReports = [];
                this.currentFilter = 'all';
                this.charts = {};
                this.jsonViewVisible = false;
                this.autoRefreshInterval = null;
                this.currentData = null; // 현재 로드된 데이터 저장
                this.init();
            }

            init() {
                // DOM 요소 바인딩
                this.bindElements();

                // 이벤트 리스너 설정
                this.setupEventListeners();

                // 초기 데이터 로드
                this.loadCIReports();

                // 자동 새로고침 시작 (60초마다)
                this.startAutoRefresh();

                // 차트 초기화
                this.initializeCharts();
            }

            bindElements() {
                // 버튼 요소들
                this.refreshBtn = document.getElementById('refreshCIReportsBtn');
                this.jsonToggleBtn = document.getElementById('toggleCIJsonViewBtn');
                this.copyJsonBtn = document.getElementById('copyCIJsonBtn');
                this.downloadMdBtn = document.getElementById('downloadCIReportMdBtn');
                this.downloadJsonBtn = document.getElementById('downloadCIReportJsonBtn');

                // 필터 버튼들
                this.filterAllBtn = document.getElementById('ciFilterAllBtn');
                this.filterSuccessBtn = document.getElementById('ciFilterSuccessBtn');
                this.filterFailureBtn = document.getElementById('ciFilterFailureBtn');

                // 통계 표시 요소들
                this.successRateEl = document.getElementById('ciSuccessRate');
                this.failureRateEl = document.getElementById('ciFailureRate');
                this.avgExecutionTimeEl = document.getElementById('ciAvgExecutionTime');
                this.totalRunsEl = document.getElementById('ciTotalRuns');
                this.lastExecutionEl = document.getElementById('ciLastExecution');
                this.failureRateCardEl = document.getElementById('ciFailureRateCard');
                this.failureWarningEl = document.getElementById('ciFailureWarning');

                // 기타 요소들
                this.reportsListEl = document.getElementById('ciReportsList');
                this.jsonViewSectionEl = document.getElementById('ciJsonViewSection');
                this.jsonContentEl = document.getElementById('ciJsonContent');
            }

            setupEventListeners() {
                // 새로고침 버튼
                this.refreshBtn?.addEventListener('click', () => this.loadCIReports());

                // JSON 토글 버튼
                this.jsonToggleBtn?.addEventListener('click', () => this.toggleJsonView());

                // JSON 복사 버튼
                this.copyJsonBtn?.addEventListener('click', () => this.copyJsonToClipboard());

                // 다운로드 버튼들
                this.downloadMdBtn?.addEventListener('click', () => this.downloadReport('markdown'));
                this.downloadJsonBtn?.addEventListener('click', () => this.downloadReport('json'));

                // 필터 버튼들
                this.filterAllBtn?.addEventListener('click', () => this.setFilter('all'));
                this.filterSuccessBtn?.addEventListener('click', () => this.setFilter('success'));
                this.filterFailureBtn?.addEventListener('click', () => this.setFilter('failure'));
            }

            async loadCIReports() {
                try {
                    // 로딩 상태 표시
                    this.showLoadingState();

                    // API에서 CI 리포트 데이터 가져오기
                    const response = await fetch('/api/v1/reports/ci/summary');
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }

                    const data = await response.json();
                    this.currentData = data;

                    // 통계 카드 업데이트
                    this.updateStatisticsCards(data);

                    // 차트 업데이트
                    this.updateCharts(data);

                    // 리포트 목록 업데이트
                    this.updateReportsList(data.recent_workflows || []);

                    // JSON 데이터 업데이트
                    if (this.jsonContentEl) {
                        this.jsonContentEl.textContent = JSON.stringify(data, null, 2);
                    }

                    addLog('✅ CI/CD 성능 리포트가 성공적으로 로드되었습니다.', 'info');

                    // 로딩 상태 해제
                    this.hideLoadingState();
                } catch (error) {
                    console.error('CI 리포트 로드 중 오류:', error);
                    addLog(`📊 CI 리포트 로드 실패: ${error.message}`, 'error');
                    this.hideLoadingState();

                    // 오류 발생 시 모의 데이터 사용
                    this.loadFallbackData();
                }
            }

            // 통계 카드 업데이트
            updateStatisticsCards(data) {
                if (data.performance_summary) {
                    const summary = data.performance_summary;

                    // 성공률 업데이트
                    if (this.successRateEl) {
                        this.successRateEl.textContent = summary.success_rate ? summary.success_rate.toFixed(1) : '-';
                    }

                    // 실패율 업데이트 및 경고 표시
                    if (this.failureRateEl) {
                        const failureRate = summary.failure_rate || 0;
                        this.failureRateEl.textContent = failureRate.toFixed(1);

                        // 실패율이 10% 초과 시 경고 표시
                        if (failureRate > 10) {
                            this.failureRateCardEl?.classList.add('animate-pulse');
                            this.failureWarningEl?.classList.remove('hidden');
                            addLog(`⚠️ CI/CD 실패율이 임계값(10%)을 초과했습니다: ${failureRate.toFixed(1)}%`, 'warning');
                        } else {
                            this.failureRateCardEl?.classList.remove('animate-pulse');
                            this.failureWarningEl?.classList.add('hidden');
                        }
                    }

                    // 평균 실행 시간 업데이트 (초를 분으로 변환)
                    if (this.avgExecutionTimeEl) {
                        const avgMinutes = summary.avg_duration_seconds ? (summary.avg_duration_seconds / 60).toFixed(1) : '-';
                        this.avgExecutionTimeEl.textContent = avgMinutes;
                    }

                    // 총 실행 횟수 업데이트
                    if (this.totalRunsEl) {
                        this.totalRunsEl.textContent = summary.total_runs || '-';
                    }
                }

                // 최근 실행 시간 업데이트
                if (data.recent_workflows && data.recent_workflows.length > 0) {
                    const lastWorkflow = data.recent_workflows[0];
                    if (this.lastExecutionEl && lastWorkflow.created_at) {
                        const lastTime = new Date(lastWorkflow.created_at);
                        const timeAgo = this.getTimeAgo(lastTime);
                        this.lastExecutionEl.textContent = timeAgo;
                    }
                }
            }

            // 차트 업데이트
            updateCharts(data) {
                if (data.recent_workflows) {
                    this.updateBuildTrendChart(data.recent_workflows);
                    this.updateSuccessDistributionChart(data.performance_summary);
                }
            }

            // 최근 빌드 트렌드 차트 업데이트 (Chart.js 라인 차트, 최근 10회 실행)
            updateBuildTrendChart(workflows) {
                const ctx = document.getElementById('ciBuildTrendChart');
                if (!ctx) return;

                // 기존 차트 제거
                if (this.charts.buildTrend) {
                    this.charts.buildTrend.destroy();
                }

                // 최근 10개만 선택
                const recentWorkflows = workflows.slice(0, 10).reverse();

                const labels = recentWorkflows.map((w, index) => `#${w.run_number || index + 1}`);
                const executionTimes = recentWorkflows.map(w => (w.duration_seconds || 0) / 60); // 분 단위
                const statusColors = recentWorkflows.map(w => {
                    switch (w.conclusion) {
                        case 'success': return '#10b981'; // 녹색
                        case 'failure': return '#ef4444'; // 빨간색
                        case 'cancelled': return '#f59e0b'; // 노란색
                        default: return '#6b7280'; // 회색
                    }
                });

                this.charts.buildTrend = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: '실행 시간 (분)',
                            data: executionTimes,
                            borderColor: '#3b82f6',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            borderWidth: 2,
                            pointBackgroundColor: statusColors,
                            pointBorderColor: '#ffffff',
                            pointBorderWidth: 2,
                            pointRadius: 6,
                            fill: true,
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                labels: {
                                    color: '#ffffff'
                                }
                            },
                            tooltip: {
                                callbacks: {
                                    afterBody: function(context) {
                                        const index = context[0].dataIndex;
                                        const workflow = recentWorkflows[index];
                                        return [
                                            `상태: ${workflow.conclusion || 'unknown'}`,
                                            `브랜치: ${workflow.branch || 'N/A'}`,
                                            `시간: ${new Date(workflow.created_at).toLocaleString('ko-KR')}`
                                        ];
                                    }
                                }
                            }
                        },
                        scales: {
                            x: {
                                ticks: { color: '#ffffff' },
                                grid: { color: 'rgba(255, 255, 255, 0.1)' }
                            },
                            y: {
                                ticks: { color: '#ffffff' },
                                grid: { color: 'rgba(255, 255, 255, 0.1)' },
                                title: {
                                    display: true,
                                    text: '실행 시간 (분)',
                                    color: '#ffffff'
                                }
                            }
                        }
                    }
                });
            }

            // 성공/실패 분포 도넛 차트 업데이트
            updateSuccessDistributionChart(summary) {
                const ctx = document.getElementById('ciSuccessDistributionChart');
                if (!ctx || !summary) return;

                // 기존 차트 제거
                if (this.charts.successDistribution) {
                    this.charts.successDistribution.destroy();
                }

                const data = [
                    summary.success_count || 0,
                    summary.failure_count || 0,
                    summary.cancelled_count || 0
                ];

                this.charts.successDistribution = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: ['성공', '실패', '취소'],
                        datasets: [{
                            data: data,
                            backgroundColor: [
                                '#10b981', // 녹색 (성공)
                                '#ef4444', // 빨간색 (실패)
                                '#f59e0b'  // 노란색 (취소)
                            ],
                            borderColor: '#ffffff',
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    color: '#ffffff',
                                    padding: 20
                                }
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        const total = data.reduce((a, b) => a + b, 0);
                                        const percentage = total > 0 ? ((context.parsed / total) * 100).toFixed(1) : 0;
                                        return `${context.label}: ${context.parsed}개 (${percentage}%)`;
                                    }
                                }
                            }
                        }
                    }
                });
            }

            // 리포트 목록 업데이트
            updateReportsList(workflows) {
                if (!this.reportsListEl || !workflows) return;

                if (workflows.length === 0) {
                    this.reportsListEl.innerHTML = `
                        <div class="text-center text-gray-400 py-8">
                            <div class="text-4xl mb-2">📊</div>
                            <div>CI 리포트 데이터가 없습니다.</div>
                        </div>
                    `;
                    return;
                }

                const reportsHtml = workflows.map(workflow => {
                    const statusColor = this.getStatusColor(workflow.conclusion);
                    const statusIcon = this.getStatusIcon(workflow.conclusion);
                    const timeAgo = this.getTimeAgo(new Date(workflow.created_at));
                    const duration = workflow.duration_seconds ?
                        `${Math.floor(workflow.duration_seconds / 60)}분 ${workflow.duration_seconds % 60}초` :
                        '알 수 없음';

                    return `
                        <div class="bg-white/5 dark:bg-gray-800/30 rounded-lg p-4 border border-white/10 dark:border-gray-700/50">
                            <div class="flex items-center justify-between mb-2">
                                <div class="flex items-center space-x-2">
                                    <span class="text-lg">${statusIcon}</span>
                                    <span class="font-semibold text-white dark:text-gray-100">${workflow.name || 'Workflow'}</span>
                                    <span class="text-sm text-gray-400">#${workflow.run_number || 'N/A'}</span>
                                </div>
                                <span class="text-xs ${statusColor} font-medium px-2 py-1 rounded-full bg-black/20">
                                    ${workflow.conclusion || 'unknown'}
                                </span>
                            </div>
                            <div class="text-sm text-gray-300 space-y-1">
                                <div>브랜치: <span class="text-white">${workflow.branch || 'N/A'}</span></div>
                                <div>실행 시간: <span class="text-white">${duration}</span></div>
                                <div>시작: <span class="text-white">${timeAgo}</span></div>
                                ${workflow.html_url ? `<a href="${workflow.html_url}" target="_blank" class="text-blue-400 hover:text-blue-300 text-xs">GitHub에서 보기 →</a>` : ''}
                            </div>
                        </div>
                    `;
                }).join('');

                this.reportsListEl.innerHTML = reportsHtml;
            }

            // 리포트 다운로드 기능
            async downloadReport(format) {
                try {
                    const endpoint = format === 'markdown' ?
                        '/api/v1/reports/ci/markdown' :
                        '/api/v1/reports/ci/json';

                    const response = await fetch(endpoint);
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }

                    let content, filename, mimeType;

                    if (format === 'markdown') {
                        content = await response.text();
                        filename = `ci_report_${new Date().toISOString().split('T')[0]}.md`;
                        mimeType = 'text/markdown';
                    } else {
                        content = JSON.stringify(await response.json(), null, 2);
                        filename = `ci_report_${new Date().toISOString().split('T')[0]}.json`;
                        mimeType = 'application/json';
                    }

                    // 파일 다운로드
                    const blob = new Blob([content], { type: mimeType });
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = filename;
                    a.click();
                    window.URL.revokeObjectURL(url);

                    addLog(`📥 CI 리포트 ${format.toUpperCase()} 파일이 다운로드되었습니다.`, 'info');
                } catch (error) {
                    console.error('리포트 다운로드 중 오류:', error);
                    addLog(`📥 리포트 다운로드 실패: ${error.message}`, 'error');
                }
            }

            // 폴백 데이터 로드 (API 오류 시)
            loadFallbackData() {
                const fallbackData = {
                    performance_summary: {
                        total_runs: 25,
                        success_count: 20,
                        failure_count: 3,
                        cancelled_count: 2,
                        success_rate: 80.0,
                        failure_rate: 12.0,
                        avg_duration_seconds: 420
                    },
                    recent_workflows: [
                        {
                            name: 'CI Pipeline',
                            run_number: 123,
                            conclusion: 'success',
                            branch: 'main',
                            duration_seconds: 380,
                            created_at: new Date(Date.now() - 3600000).toISOString(),
                            html_url: 'https://github.com/youareplan/mcp-map-company/actions'
                        },
                        {
                            name: 'Security Scan',
                            run_number: 122,
                            conclusion: 'failure',
                            branch: 'develop',
                            duration_seconds: 280,
                            created_at: new Date(Date.now() - 7200000).toISOString(),
                            html_url: 'https://github.com/youareplan/mcp-map-company/actions'
                        }
                    ]
                };

                this.updateStatisticsCards(fallbackData);
                this.updateCharts(fallbackData);
                this.updateReportsList(fallbackData.recent_workflows);

                if (this.jsonContentEl) {
                    this.jsonContentEl.textContent = JSON.stringify(fallbackData, null, 2);
                }
            }

            // 유틸리티 메서드들
            getStatusColor(status) {
                switch (status) {
                    case 'success': return 'text-green-400';
                    case 'failure': return 'text-red-400';
                    case 'cancelled': return 'text-yellow-400';
                    default: return 'text-gray-400';
                }
            }

            getStatusIcon(status) {
                switch (status) {
                    case 'success': return '✅';
                    case 'failure': return '❌';
                    case 'cancelled': return '⏹️';
                    case 'in_progress': return '🔄';
                    default: return '⚪';
                }
            }

            getTimeAgo(date) {
                const now = new Date();
                const diffMs = now - date;
                const diffMins = Math.floor(diffMs / 60000);
                const diffHours = Math.floor(diffMins / 60);
                const diffDays = Math.floor(diffHours / 24);

                if (diffMins < 1) return '방금 전';
                if (diffMins < 60) return `${diffMins}분 전`;
                if (diffHours < 24) return `${diffHours}시간 전`;
                return `${diffDays}일 전`;
            }

            // 기존 메서드들 (필요에 따라 수정)
            showLoadingState() {
                if (this.reportsListEl) {
                    this.reportsListEl.innerHTML = `
                        <div class="text-center text-gray-400 py-8">
                            <div class="text-4xl mb-2 animate-spin">🔄</div>
                            <div>CI 리포트 데이터를 로드하는 중...</div>
                        </div>
                    `;
                }
            }

            hideLoadingState() {
                // 로딩 상태는 updateReportsList에서 처리됨
            }

            toggleJsonView() {
                this.jsonViewVisible = !this.jsonViewVisible;
                if (this.jsonViewSectionEl) {
                    this.jsonViewSectionEl.classList.toggle('hidden', !this.jsonViewVisible);
                }

                if (this.jsonToggleBtn) {
                    this.jsonToggleBtn.innerHTML = this.jsonViewVisible ?
                        '<span class="mr-2">👁️</span>JSON 숨기기' :
                        '<span class="mr-2">👁️</span>JSON 보기';
                }
            }

            copyJsonToClipboard() {
                if (this.jsonContentEl && this.jsonContentEl.textContent) {
                    navigator.clipboard.writeText(this.jsonContentEl.textContent).then(() => {
                        addLog('📋 JSON 데이터가 클립보드에 복사되었습니다.', 'info');
                    }).catch(err => {
                        console.error('클립보드 복사 실패:', err);
                        addLog('📋 클립보드 복사에 실패했습니다.', 'error');
                    });
                }
            }

            setFilter(filter) {
                this.currentFilter = filter;
                // 필터 버튼 스타일 업데이트
                [this.filterAllBtn, this.filterSuccessBtn, this.filterFailureBtn].forEach(btn => {
                    if (btn) {
                        btn.classList.remove('bg-blue-600', 'text-white');
                        btn.classList.add('bg-white/10', 'text-white/80');
                    }
                });

                // 활성 버튼 스타일 적용
                const activeBtn = filter === 'all' ? this.filterAllBtn :
                                 filter === 'success' ? this.filterSuccessBtn : this.filterFailureBtn;
                if (activeBtn) {
                    activeBtn.classList.remove('bg-white/10', 'text-white/80');
                    activeBtn.classList.add('bg-blue-600', 'text-white');
                }

                // 필터링 적용은 현재 데이터로 다시 리포트 목록 업데이트
                if (this.currentData && this.currentData.recent_workflows) {
                    let filteredWorkflows = this.currentData.recent_workflows;

                    if (filter === 'success') {
                        filteredWorkflows = filteredWorkflows.filter(w => w.conclusion === 'success');
                    } else if (filter === 'failure') {
                        filteredWorkflows = filteredWorkflows.filter(w => w.conclusion === 'failure');
                    }

                    this.updateReportsList(filteredWorkflows);
                }
            }

            startAutoRefresh() {
                this.autoRefreshInterval = setInterval(() => {
                    this.loadCIReports();
                }, 60000); // 60초마다 새로고침
            }

            stopAutoRefresh() {
                if (this.autoRefreshInterval) {
                    clearInterval(this.autoRefreshInterval);
                    this.autoRefreshInterval = null;
                }
            }

            initializeCharts() {
                // 차트 초기화는 데이터 로드 후 updateCharts에서 처리
            }
            }

            async generateMockCIReports() {
                // 실제 환경에서는 /api/v1/ci/reports 호출
                const mockData = [
                    {
                        id: `ci-${Date.now()}-1`,
                        workflow: 'CI/CD Pipeline',
                        status: 'success',
                        execution_time: 480, // 초 단위
                        test_count: 127,
                        test_passed: 125,
                        test_failed: 2,
                        coverage: 85.6,
                        timestamp: new Date(Date.now() - 3600000).toISOString(),
                        branch: 'main',
                        commit: 'c3f5aa7',
                        author: 'developer@company.com'
                    },
                    {
                        id: `ci-${Date.now()}-2`,
                        workflow: 'Security Scan',
                        status: 'failure',
                        execution_time: 320,
                        test_count: 45,
                        test_passed: 40,
                        test_failed: 5,
                        coverage: 72.3,
                        timestamp: new Date(Date.now() - 7200000).toISOString(),
                        branch: 'develop',
                        commit: '6b14912',
                        author: 'security@company.com',
                        error_message: 'Vulnerability detected in dependencies'
                    },
                    {
                        id: `ci-${Date.now()}-3`,
                        workflow: 'Build & Test',
                        status: 'success',
                        execution_time: 620,
                        test_count: 89,
                        test_passed: 89,
                        test_failed: 0,
                        coverage: 92.1,
                        timestamp: new Date(Date.now() - 10800000).toISOString(),
                        branch: 'main',
                        commit: '01e2a23',
                        author: 'build@company.com'
                    }
                ];

                // 시뮬레이션을 위한 지연
                await new Promise(resolve => setTimeout(resolve, 500));

                this.reports = mockData;
                this.applyCurrentFilter();
            }

            setFilter(filterType) {
                this.currentFilter = filterType;

                // 버튼 상태 업데이트
                this.updateFilterButtons();

                // 필터 적용 및 표시
                this.applyCurrentFilter();
                this.displayReports();

                addLog(`📊 CI 리포트 필터가 '${filterType}'로 변경되었습니다.`, 'info');
            }

            updateFilterButtons() {
                const buttons = [this.filterAllBtn, this.filterSuccessBtn, this.filterFailureBtn];
                const filters = ['all', 'success', 'failure'];

                buttons.forEach((btn, index) => {
                    if (!btn) return;

                    if (filters[index] === this.currentFilter) {
                        btn.classList.add('bg-blue-600', 'text-white');
                        btn.classList.remove('bg-white/10', 'text-white/80');
                    } else {
                        btn.classList.remove('bg-blue-600', 'text-white');
                        btn.classList.add('bg-white/10', 'text-white/80');
                    }
                });
            }

            applyCurrentFilter() {
                if (this.currentFilter === 'all') {
                    this.filteredReports = [...this.reports];
                } else {
                    this.filteredReports = this.reports.filter(
                        report => report.status === this.currentFilter
                    );
                }
            }

            updateStatistics() {
                if (this.reports.length === 0) return;

                // 평균 실행 시간 계산
                const avgTime = this.reports.reduce((sum, r) => sum + r.execution_time, 0) / this.reports.length;
                const minutes = Math.floor(avgTime / 60);
                const seconds = Math.floor(avgTime % 60);

                // 실패율 계산
                const failedCount = this.reports.filter(r => r.status === 'failure').length;
                const failureRate = ((failedCount / this.reports.length) * 100).toFixed(1);

                // 평균 커버리지 계산
                const avgCoverage = (this.reports.reduce((sum, r) => sum + r.coverage, 0) / this.reports.length).toFixed(1);

                // 최근 실행 날짜
                const latestReport = this.reports.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp))[0];
                const lastExecution = new Date(latestReport.timestamp).toLocaleDateString('ko-KR');

                // UI 업데이트
                if (this.avgExecutionTimeEl) this.avgExecutionTimeEl.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                if (this.failureRateEl) this.failureRateEl.textContent = failureRate;
                if (this.testCoverageEl) this.testCoverageEl.textContent = avgCoverage;
                if (this.lastExecutionEl) this.lastExecutionEl.textContent = lastExecution;
            }

            displayReports() {
                if (!this.reportsListEl) return;

                if (this.filteredReports.length === 0) {
                    this.reportsListEl.innerHTML = `
                        <div class="text-center text-gray-400 py-8">
                            <div class="text-4xl mb-2">📊</div>
                            <div>표시할 CI 리포트가 없습니다.</div>
                        </div>
                    `;
                    return;
                }

                const reportsHtml = this.filteredReports.map(report => {
                    const statusIcon = report.status === 'success' ? '✅' : '❌';
                    const statusColor = report.status === 'success' ? 'green' : 'red';
                    const executionTime = `${Math.floor(report.execution_time / 60)}:${(report.execution_time % 60).toString().padStart(2, '0')}`;

                    return `
                        <div class="bg-white/5 dark:bg-gray-800/30 rounded-lg p-4 border border-${statusColor}-500/20">
                            <div class="flex items-start justify-between">
                                <div class="flex items-start space-x-3 flex-1">
                                    <div class="text-2xl">${statusIcon}</div>
                                    <div class="flex-1">
                                        <div class="flex items-center space-x-2 mb-1">
                                            <h4 class="text-white dark:text-gray-100 font-semibold">${report.workflow}</h4>
                                            <span class="text-xs px-2 py-1 rounded-full bg-gray-700 text-gray-300">${report.branch}</span>
                                        </div>
                                        <p class="text-white/80 dark:text-gray-300 text-sm mb-2">
                                            실행 시간: ${executionTime} | 테스트: ${report.test_passed}/${report.test_count} | 커버리지: ${report.coverage}%
                                        </p>
                                        <div class="flex items-center justify-between text-xs text-white/60 dark:text-gray-400">
                                            <span>📅 ${new Date(report.timestamp).toLocaleString('ko-KR')}</span>
                                            <span>👤 ${report.author}</span>
                                            <span>🔗 ${report.commit}</span>
                                        </div>
                                        ${report.error_message ? `<div class="mt-2 text-red-400 text-sm">❌ ${report.error_message}</div>` : ''}
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');

                this.reportsListEl.innerHTML = reportsHtml;
            }

            initializeCharts() {
                // Chart.js 초기화 (Chart.js가 로드되어 있다고 가정)
                if (typeof Chart === 'undefined') {
                    console.warn('Chart.js가 로드되지 않았습니다.');
                    return;
                }

                // 실행 시간 차트
                const executionTimeCtx = document.getElementById('ciExecutionTimeChart');
                if (executionTimeCtx) {
                    this.charts.executionTime = new Chart(executionTimeCtx, {
                        type: 'line',
                        data: {
                            labels: [],
                            datasets: [{
                                label: '실행 시간 (분)',
                                data: [],
                                borderColor: 'rgb(59, 130, 246)',
                                backgroundColor: 'rgba(59, 130, 246, 0.1)',
                                tension: 0.1
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    labels: { color: 'rgba(255, 255, 255, 0.8)' }
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    ticks: { color: 'rgba(255, 255, 255, 0.6)' },
                                    grid: { color: 'rgba(255, 255, 255, 0.1)' }
                                },
                                x: {
                                    ticks: { color: 'rgba(255, 255, 255, 0.6)' },
                                    grid: { color: 'rgba(255, 255, 255, 0.1)' }
                                }
                            }
                        }
                    });
                }

                // 실패율 차트
                const failureRateCtx = document.getElementById('ciFailureRateChart');
                if (failureRateCtx) {
                    this.charts.failureRate = new Chart(failureRateCtx, {
                        type: 'bar',
                        data: {
                            labels: [],
                            datasets: [{
                                label: '실패율 (%)',
                                data: [],
                                backgroundColor: 'rgba(239, 68, 68, 0.6)',
                                borderColor: 'rgb(239, 68, 68)',
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    labels: { color: 'rgba(255, 255, 255, 0.8)' }
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    max: 100,
                                    ticks: { color: 'rgba(255, 255, 255, 0.6)' },
                                    grid: { color: 'rgba(255, 255, 255, 0.1)' }
                                },
                                x: {
                                    ticks: { color: 'rgba(255, 255, 255, 0.6)' },
                                    grid: { color: 'rgba(255, 255, 255, 0.1)' }
                                }
                            }
                        }
                    });
                }
            }

            updateCharts() {
                if (!this.charts.executionTime || !this.charts.failureRate) return;

                // 최근 10개 리포트 데이터로 차트 업데이트
                const recentReports = this.reports
                    .sort((a, b) => new Date(a.timestamp) - new Date(b.timestamp))
                    .slice(-10);

                const labels = recentReports.map(r => new Date(r.timestamp).toLocaleDateString('ko-KR'));
                const executionTimes = recentReports.map(r => (r.execution_time / 60).toFixed(1));

                // 실행 시간 차트 업데이트
                this.charts.executionTime.data.labels = labels;
                this.charts.executionTime.data.datasets[0].data = executionTimes;
                this.charts.executionTime.update();

                // 실패율 차트 데이터 계산 (기간별)
                const failureRates = recentReports.map(r => {
                    return r.status === 'failure' ? 100 : 0;
                });

                this.charts.failureRate.data.labels = labels;
                this.charts.failureRate.data.datasets[0].data = failureRates;
                this.charts.failureRate.update();
            }

            toggleJsonView() {
                this.jsonViewVisible = !this.jsonViewVisible;

                if (this.jsonSectionEl) {
                    if (this.jsonViewVisible) {
                        this.jsonSectionEl.classList.remove('hidden');
                        this.jsonToggleBtn.innerHTML = '<span class="mr-2">📄</span>JSON 숨김';
                    } else {
                        this.jsonSectionEl.classList.add('hidden');
                        this.jsonToggleBtn.innerHTML = '<span class="mr-2">📄</span>JSON 보기';
                    }
                }

                this.updateJsonView();
            }

            updateJsonView() {
                if (this.jsonViewVisible && this.jsonContentEl) {
                    this.jsonContentEl.textContent = JSON.stringify(this.reports, null, 2);
                }
            }

            copyJsonToClipboard() {
                if (this.jsonContentEl) {
                    navigator.clipboard.writeText(this.jsonContentEl.textContent).then(() => {
                        addLog('📋 CI 리포트 JSON 데이터가 클립보드에 복사되었습니다.', 'info');
                    }).catch(err => {
                        addLog('📋 클립보드 복사 실패: ' + err.message, 'error');
                    });
                }
            }

            showLoadingState() {
                if (this.reportsListEl) {
                    this.reportsListEl.innerHTML = `
                        <div class="text-center text-gray-400 py-8">
                            <div class="animate-spin text-4xl mb-2">🔄</div>
                            <div>CI 리포트 데이터를 로드하는 중...</div>
                        </div>
                    `;
                }

                if (this.refreshBtn) {
                    this.refreshBtn.disabled = true;
                    this.refreshBtn.innerHTML = '<span class="mr-2">🔄</span>로딩 중...';
                }
            }

            hideLoadingState() {
                if (this.refreshBtn) {
                    this.refreshBtn.disabled = false;
                    this.refreshBtn.innerHTML = '<span class="mr-2">🔄</span>새로고침';
                }
            }

            startAutoRefresh() {
                this.stopAutoRefresh(); // 기존 인터벌 정리
                this.autoRefreshInterval = setInterval(() => {
                    this.loadCIReports();
                }, 60000); // 60초마다 새로고침
            }

            stopAutoRefresh() {
                if (this.autoRefreshInterval) {
                    clearInterval(this.autoRefreshInterval);
                    this.autoRefreshInterval = null;
                }
            }
        }

        // =============================================
        // 🚨 CI/CD 에러 로그 분석 패널 JavaScript Implementation
        // =============================================

        class CIErrorAnalyzer {
            constructor() {
                this.errorData = null;
                this.charts = {};
                this.thresholds = {
                    critical: 10,
                    error: 5,
                    warning: 1
                };
                this.currentFilter = 'all';
                this.autoRefreshInterval = null;
                this.init();
            }

            init() {
                this.initializeElements();
                this.bindEvents();
                this.loadErrorData();
                this.loadThresholds();
            }

            initializeElements() {
                // 버튼 요소들
                this.refreshBtn = document.getElementById('refreshErrorAnalysisBtn');
                this.runAnalysisBtn = document.getElementById('runErrorAnalysisBtn');
                this.downloadBtn = document.getElementById('downloadErrorReportBtn');
                this.saveThresholdsBtn = document.getElementById('saveThresholdsBtn');

                // 통계 표시 요소들
                this.failureRateEl = document.getElementById('errorFailureRate');
                this.failureWarningEl = document.getElementById('errorFailureWarning');
                this.totalCountEl = document.getElementById('errorTotalCount');
                this.typeCountEl = document.getElementById('errorTypeCount');
                this.analysisPeriodEl = document.getElementById('errorAnalysisPeriod');

                // 차트 캔버스 요소들
                this.typeDistributionChartCanvas = document.getElementById('errorTypeDistributionChart');
                this.trendChartCanvas = document.getElementById('errorTrendChart');

                // 에러 목록 및 필터
                this.errorCasesListEl = document.getElementById('errorCasesList');
                this.errorTypeFilterEl = document.getElementById('errorTypeFilter');

                // 임계치 설정 요소들
                this.criticalThresholdEl = document.getElementById('criticalThreshold');
                this.errorThresholdEl = document.getElementById('errorThreshold');
                this.warningThresholdEl = document.getElementById('warningThreshold');
            }

            bindEvents() {
                // 버튼 이벤트 바인딩
                if (this.refreshBtn) {
                    this.refreshBtn.addEventListener('click', () => this.refreshErrorData());
                }

                if (this.runAnalysisBtn) {
                    this.runAnalysisBtn.addEventListener('click', () => this.runErrorAnalysis());
                }

                if (this.downloadBtn) {
                    this.downloadBtn.addEventListener('click', () => this.downloadErrorReport());
                }

                if (this.saveThresholdsBtn) {
                    this.saveThresholdsBtn.addEventListener('click', () => this.saveThresholds());
                }

                // 필터 이벤트
                if (this.errorTypeFilterEl) {
                    this.errorTypeFilterEl.addEventListener('change', (e) => {
                        this.currentFilter = e.target.value;
                        this.filterErrorCases();
                    });
                }

                // 임계치 변경 이벤트
                [this.criticalThresholdEl, this.errorThresholdEl, this.warningThresholdEl].forEach(el => {
                    if (el) {
                        el.addEventListener('change', () => this.updateThresholdsFromInputs());
                    }
                });
            }

            async loadErrorData() {
                try {
                    this.showLoadingState();

                    // API에서 에러 분석 데이터 가져오기
                    const response = await fetch('/api/v1/ci/error-analysis');
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }

                    const data = await response.json();
                    this.errorData = data;

                    // UI 업데이트
                    this.updateStatistics();
                    this.updateCharts();
                    this.updateErrorCases();

                    addLog('🚨 CI/CD 에러 분석 데이터가 성공적으로 로드되었습니다.', 'info');
                    this.hideLoadingState();

                } catch (error) {
                    console.error('에러 분석 데이터 로드 중 오류:', error);
                    addLog(`🚨 에러 분석 데이터 로드 실패: ${error.message}`, 'error');
                    this.hideLoadingState();

                    // 폴백 데이터 사용
                    this.loadFallbackData();
                }
            }

            loadFallbackData() {
                // 모의 에러 분석 데이터
                this.errorData = {
                    analysis_summary: {
                        processed_files: 8,
                        total_errors: 23,
                        unique_error_types: 5,
                        failure_rate: 7.3,
                        analysis_period_days: 7
                    },
                    top_10_errors: [
                        { message: "test_user_authentication failed", count: 8 },
                        { message: "Module not found: requests", count: 5 },
                        { message: "Build timeout after 30 minutes", count: 4 },
                        { message: "Permission denied: /var/log", count: 3 },
                        { message: "Syntax error in main.py line 42", count: 3 }
                    ],
                    error_distribution: {
                        "TEST_FAILURE": 12,
                        "BUILD_ERROR": 6,
                        "TIMEOUT_ERROR": 3,
                        "MODULE_ERROR": 2
                    },
                    detailed_errors: [
                        {
                            type: "TEST_FAILURE",
                            message: "test_user_authentication failed",
                            source_file: "run_12345.log",
                            line_number: 156,
                            timestamp: "2024-01-15T10:30:00Z"
                        },
                        {
                            type: "BUILD_ERROR",
                            message: "Module not found: requests",
                            source_file: "run_12346.log",
                            line_number: 89,
                            timestamp: "2024-01-15T09:15:00Z"
                        }
                    ]
                };

                this.updateStatistics();
                this.updateCharts();
                this.updateErrorCases();

                addLog('🚨 에러 분석 폴백 데이터를 사용합니다.', 'warning');
            }

            updateStatistics() {
                if (!this.errorData) return;

                const summary = this.errorData.analysis_summary;

                // 실패율 업데이트
                if (this.failureRateEl) {
                    this.failureRateEl.textContent = summary.failure_rate.toFixed(1);
                }

                // 실패율 경고 표시 (10% 초과 시)
                if (this.failureWarningEl) {
                    if (summary.failure_rate > this.thresholds.critical) {
                        this.failureWarningEl.classList.remove('hidden');
                        // 실패율 카드에 애니메이션 추가
                        const failureCard = document.getElementById('errorFailureRateCard');
                        if (failureCard) {
                            failureCard.classList.add('animate-pulse');
                        }
                        addLog(`⚠️ CI/CD 실패율이 임계값(${this.thresholds.critical}%)을 초과했습니다: ${summary.failure_rate.toFixed(1)}%`, 'warning');
                    } else {
                        this.failureWarningEl.classList.add('hidden');
                        const failureCard = document.getElementById('errorFailureRateCard');
                        if (failureCard) {
                            failureCard.classList.remove('animate-pulse');
                        }
                    }
                }

                // 총 에러 수 업데이트
                if (this.totalCountEl) {
                    this.totalCountEl.textContent = summary.total_errors.toLocaleString();
                }

                // 에러 유형 수 업데이트
                if (this.typeCountEl) {
                    this.typeCountEl.textContent = summary.unique_error_types;
                }

                // 분석 기간 업데이트
                if (this.analysisPeriodEl) {
                    this.analysisPeriodEl.textContent = summary.analysis_period_days || 7;
                }
            }

            updateCharts() {
                if (!this.errorData) return;

                this.createTypeDistributionChart();
                this.createTrendChart();
            }

            createTypeDistributionChart() {
                const ctx = this.typeDistributionChartCanvas?.getContext('2d');
                if (!ctx) return;

                // 기존 차트 파괴
                if (this.charts.typeDistribution) {
                    this.charts.typeDistribution.destroy();
                }

                const distribution = this.errorData.error_distribution;
                const labels = Object.keys(distribution);
                const data = Object.values(distribution);

                // 에러 유형별 색상 매핑
                const colors = {
                    'TEST_FAILURE': '#ef4444',
                    'BUILD_ERROR': '#f97316',
                    'TIMEOUT_ERROR': '#eab308',
                    'MODULE_ERROR': '#8b5cf6',
                    'SYNTAX_ERROR': '#06b6d4',
                    'PERMISSION_ERROR': '#ec4899',
                    'DEPLOY_ERROR': '#f59e0b'
                };

                const backgroundColors = labels.map(label => colors[label] || '#6b7280');

                this.charts.typeDistribution = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: labels.map(label => {
                            // 에러 유형 한국어 변환
                            const typeMap = {
                                'TEST_FAILURE': '테스트 실패',
                                'BUILD_ERROR': '빌드 에러',
                                'TIMEOUT_ERROR': '타임아웃',
                                'MODULE_ERROR': '모듈 에러',
                                'SYNTAX_ERROR': '문법 에러',
                                'PERMISSION_ERROR': '권한 에러',
                                'DEPLOY_ERROR': '배포 에러'
                            };
                            return typeMap[label] || label;
                        }),
                        datasets: [{
                            data: data,
                            backgroundColor: backgroundColors,
                            borderColor: '#374151',
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    color: '#f3f4f6',
                                    font: { size: 12 }
                                }
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                        const percentage = ((context.parsed / total) * 100).toFixed(1);
                                        return `${context.label}: ${context.parsed}건 (${percentage}%)`;
                                    }
                                }
                            }
                        }
                    }
                });
            }

            createTrendChart() {
                const ctx = this.trendChartCanvas?.getContext('2d');
                if (!ctx) return;

                // 기존 차트 파괴
                if (this.charts.trend) {
                    this.charts.trend.destroy();
                }

                // 최근 7일간의 모의 트렌드 데이터 생성
                const days = [];
                const errorCounts = [];

                for (let i = 6; i >= 0; i--) {
                    const date = new Date();
                    date.setDate(date.getDate() - i);
                    days.push(date.toLocaleDateString('ko-KR', { month: 'short', day: 'numeric' }));

                    // 모의 에러 수 (실제로는 분석 데이터에서 가져와야 함)
                    errorCounts.push(Math.floor(Math.random() * 10) + 2);
                }

                this.charts.trend = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: days,
                        datasets: [{
                            label: '일별 에러 수',
                            data: errorCounts,
                            borderColor: '#ef4444',
                            backgroundColor: 'rgba(239, 68, 68, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4,
                            pointBackgroundColor: '#ef4444',
                            pointBorderColor: '#fff',
                            pointBorderWidth: 2,
                            pointRadius: 6
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                labels: {
                                    color: '#f3f4f6',
                                    font: { size: 12 }
                                }
                            }
                        },
                        scales: {
                            x: {
                                ticks: { color: '#9ca3af' },
                                grid: { color: 'rgba(75, 85, 99, 0.3)' }
                            },
                            y: {
                                ticks: { color: '#9ca3af' },
                                grid: { color: 'rgba(75, 85, 99, 0.3)' },
                                beginAtZero: true
                            }
                        }
                    }
                });
            }

            updateErrorCases() {
                if (!this.errorData || !this.errorCasesListEl) return;

                const errors = this.errorData.detailed_errors || [];

                // 필터 적용
                const filteredErrors = this.currentFilter === 'all'
                    ? errors
                    : errors.filter(error => error.type === this.currentFilter);

                if (filteredErrors.length === 0) {
                    this.errorCasesListEl.innerHTML = `
                        <div class="text-center text-gray-400 py-8">
                            <div class="text-4xl mb-2">🚨</div>
                            <div>표시할 에러 사례가 없습니다.</div>
                        </div>
                    `;
                    return;
                }

                // 에러 사례 목록 HTML 생성
                const errorCasesHTML = filteredErrors.slice(0, 10).map((error, index) => {
                    const typeColors = {
                        'TEST_FAILURE': 'text-red-300',
                        'BUILD_ERROR': 'text-orange-300',
                        'TIMEOUT_ERROR': 'text-yellow-300',
                        'MODULE_ERROR': 'text-purple-300',
                        'SYNTAX_ERROR': 'text-blue-300'
                    };

                    const typeColor = typeColors[error.type] || 'text-gray-300';
                    const formattedTime = error.timestamp ? new Date(error.timestamp).toLocaleString('ko-KR') : 'N/A';

                    return `
                        <div class="bg-gray-800/50 rounded-lg p-4 hover:bg-gray-800/70 transition-colors duration-200">
                            <div class="flex items-start justify-between mb-2">
                                <div class="flex items-center space-x-2">
                                    <span class="text-red-400 text-lg">🚨</span>
                                    <span class="${typeColor} text-sm font-medium">${error.type}</span>
                                    <span class="text-gray-400 text-xs">#{index + 1}</span>
                                </div>
                                <div class="text-gray-400 text-xs">${formattedTime}</div>
                            </div>
                            <div class="text-white text-sm mb-2 font-mono">
                                ${error.message.length > 100 ? error.message.substring(0, 100) + '...' : error.message}
                            </div>
                            <div class="flex items-center space-x-4 text-xs text-gray-400">
                                <span>📄 ${error.source_file}</span>
                                <span>📍 라인 ${error.line_number}</span>
                            </div>
                        </div>
                    `;
                }).join('');

                this.errorCasesListEl.innerHTML = errorCasesHTML;
            }

            filterErrorCases() {
                this.updateErrorCases();
                addLog(`🔍 에러 유형 필터가 '${this.currentFilter}'로 변경되었습니다.`, 'info');
            }

            async refreshErrorData() {
                addLog('🔄 CI/CD 에러 분석 데이터를 새로고침합니다...', 'info');
                await this.loadErrorData();
            }

            async runErrorAnalysis() {
                try {
                    addLog('🔍 CI/CD 에러 로그 분석을 실행합니다...', 'info');

                    // 분석 실행 버튼 비활성화
                    if (this.runAnalysisBtn) {
                        this.runAnalysisBtn.disabled = true;
                        this.runAnalysisBtn.innerHTML = '<span class="mr-2">⏳</span>분석 중...';
                    }

                    // 에러 분석 스크립트 실행 API 호출
                    const response = await fetch('/api/v1/ci/run-error-analysis', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            days: parseInt(this.analysisPeriodEl?.textContent) || 7,
                            format: 'json'
                        })
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }

                    const result = await response.json();
                    addLog('✅ CI/CD 에러 분석이 성공적으로 완료되었습니다.', 'success');

                    // 분석 완료 후 데이터 새로고침
                    await this.loadErrorData();

                } catch (error) {
                    console.error('에러 분석 실행 중 오류:', error);
                    addLog(`❌ 에러 분석 실행 실패: ${error.message}`, 'error');
                } finally {
                    // 분석 실행 버튼 복원
                    if (this.runAnalysisBtn) {
                        this.runAnalysisBtn.disabled = false;
                        this.runAnalysisBtn.innerHTML = '<span class="mr-2">🔍</span>분석 실행';
                    }
                }
            }

            async downloadErrorReport() {
                try {
                    addLog('📥 CI/CD 에러 리포트를 다운로드합니다...', 'info');

                    // JSON 리포트 다운로드
                    const response = await fetch('/api/v1/ci/error-report/json');
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }

                    const blob = await response.blob();
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');

                    const timestamp = new Date().toISOString().replace(/[:.]/g, '-').slice(0, -5);
                    const filename = `ci-error-report-${timestamp}.json`;

                    a.href = url;
                    a.download = filename;
                    a.click();
                    window.URL.revokeObjectURL(url);

                    addLog(`📥 CI/CD 에러 리포트가 다운로드되었습니다: ${filename}`, 'success');

                } catch (error) {
                    console.error('리포트 다운로드 중 오류:', error);
                    addLog(`📥 리포트 다운로드 실패: ${error.message}`, 'error');
                }
            }

            updateThresholdsFromInputs() {
                if (this.criticalThresholdEl) {
                    this.thresholds.critical = parseFloat(this.criticalThresholdEl.value) || 10;
                }
                if (this.errorThresholdEl) {
                    this.thresholds.error = parseFloat(this.errorThresholdEl.value) || 5;
                }
                if (this.warningThresholdEl) {
                    this.thresholds.warning = parseFloat(this.warningThresholdEl.value) || 1;
                }

                // 통계 업데이트 (실패율 경고 기준 변경 반영)
                this.updateStatistics();
            }

            saveThresholds() {
                try {
                    // 로컬 스토리지에 임계치 저장
                    localStorage.setItem('ciErrorThresholds', JSON.stringify(this.thresholds));
                    addLog('💾 CI/CD 에러 알림 임계치가 저장되었습니다.', 'success');
                } catch (error) {
                    addLog('💾 임계치 저장 실패: ' + error.message, 'error');
                }
            }

            loadThresholds() {
                try {
                    const saved = localStorage.getItem('ciErrorThresholds');
                    if (saved) {
                        this.thresholds = { ...this.thresholds, ...JSON.parse(saved) };

                        // UI에 저장된 값 반영
                        if (this.criticalThresholdEl) {
                            this.criticalThresholdEl.value = this.thresholds.critical;
                        }
                        if (this.errorThresholdEl) {
                            this.errorThresholdEl.value = this.thresholds.error;
                        }
                        if (this.warningThresholdEl) {
                            this.warningThresholdEl.value = this.thresholds.warning;
                        }
                    }
                } catch (error) {
                    console.warn('임계치 로드 실패:', error);
                }
            }

            showLoadingState() {
                if (this.errorCasesListEl) {
                    this.errorCasesListEl.innerHTML = `
                        <div class="text-center text-gray-400 py-8">
                            <div class="text-4xl mb-2 animate-spin">🔄</div>
                            <div>에러 분석 데이터를 로드하는 중...</div>
                        </div>
                    `;
                }
            }

            hideLoadingState() {
                // 로딩 상태 해제는 updateErrorCases에서 처리됨
            }
        }

        // 운영 알림 매니저 전역 인스턴스 생성
        let opsNotificationManager;
        let ciReportManager;
        let ciErrorAnalyzer;
        let quarterlyReportManager;

        // =============================================
        // 📊 분기별 운영 리포트 매니저 (한국어 주석 포함)
        // =============================================

        class QuarterlyReportManager {
            constructor() {
                this.currentQuarter = this.getCurrentQuarter();
                this.currentYear = new Date().getFullYear();
                this.monthlyTrendChart = null;
                this.scoreDistributionChart = null;
                this.autoRefreshInterval = null;
                this.init();
            }

            getCurrentQuarter() {
                const month = new Date().getMonth() + 1;
                if (month <= 3) return 'Q1';
                if (month <= 6) return 'Q2';
                if (month <= 9) return 'Q3';
                return 'Q4';
            }

            init() {
                this.initElements();
                this.bindEvents();
                this.loadQuarterlyReports();
                this.startAutoRefresh();
            }

            initElements() {
                // 버튼들
                this.refreshBtn = document.getElementById('refreshQuarterlyReportBtn');
                this.generateBtn = document.getElementById('generateQuarterlyReportBtn');
                this.downloadBtn = document.getElementById('downloadQuarterlyReportBtn');

                // 선택자들
                this.quarterSelect = document.getElementById('quarterlyReportQuarterSelect');
                this.yearSelect = document.getElementById('quarterlyReportYearSelect');

                // 점수 표시 요소들
                this.securityScoreEl = document.getElementById('quarterlySecurityScore');
                this.backupScoreEl = document.getElementById('quarterlyBackupScore');
                this.systemScoreEl = document.getElementById('quarterlySystemScore');
                this.totalScoreEl = document.getElementById('quarterlyTotalScore');
                this.gradeEl = document.getElementById('quarterlyPerformanceGrade');

                // 상세 정보 요소들
                this.blockedIPsEl = document.getElementById('quarterlyBlockedIPs');
                this.securityEventsEl = document.getElementById('quarterlySecurityEvents');
                this.rateLimitEl = document.getElementById('quarterlyRateLimit');
                this.whitelistAddedEl = document.getElementById('quarterlyWhitelistAdded');

                this.successfulBackupsEl = document.getElementById('quarterlySuccessfulBackups');
                this.failedBackupsEl = document.getElementById('quarterlyFailedBackups');
                this.backupSuccessRateEl = document.getElementById('quarterlyBackupSuccessRate');
                this.cleanupOpsEl = document.getElementById('quarterlyCleanupOps');

                this.avgCpuEl = document.getElementById('quarterlyAvgCpu');
                this.avgMemoryEl = document.getElementById('quarterlyAvgMemory');
                this.avgDiskEl = document.getElementById('quarterlyAvgDisk');
                this.uptimeEl = document.getElementById('quarterlyUptime');

                // 리포트 목록
                this.reportsListEl = document.getElementById('quarterlyReportsList');

                // 권장사항 및 기타 섹션들
                this.recommendationsSection = document.getElementById('quarterlyRecommendationsSection');
                this.recommendationsList = document.getElementById('quarterlyRecommendationsList');
                this.criticalPeriodsSection = document.getElementById('quarterlyCriticalPeriodsSection');
                this.criticalPeriodsList = document.getElementById('quarterlyCriticalPeriodsList');

                // 현재 분기로 초기화
                if (this.quarterSelect) {
                    this.quarterSelect.value = this.currentQuarter;
                }
                if (this.yearSelect) {
                    this.yearSelect.value = this.currentYear.toString();
                }
            }

            bindEvents() {
                // 버튼 이벤트
                this.refreshBtn?.addEventListener('click', () => this.loadQuarterlyReports());
                this.generateBtn?.addEventListener('click', () => this.generateQuarterlyReport());
                this.downloadBtn?.addEventListener('click', () => this.downloadReport('markdown'));

                // 선택자 이벤트
                this.quarterSelect?.addEventListener('change', () => this.onQuarterChange());
                this.yearSelect?.addEventListener('change', () => this.onYearChange());
            }

            async loadQuarterlyReports() {
                this.showLoadingState();

                try {
                    const quarter = this.quarterSelect?.value || this.currentQuarter;
                    const year = this.yearSelect?.value || this.currentYear;

                    // API에서 분기별 리포트 데이터 가져오기 (임시로 모킹된 데이터 사용)
                    await this.loadMockData(quarter, year);

                    addLog('✅ 분기별 운영 리포트가 성공적으로 로드되었습니다.', 'info');

                } catch (error) {
                    console.error('분기별 리포트 로드 중 오류:', error);
                    addLog(`📊 분기별 리포트 로드 실패: ${error.message}`, 'error');
                    this.loadFallbackData();
                } finally {
                    this.hideLoadingState();
                }
            }

            async loadMockData(quarter, year) {
                // 임시 모킹된 데이터
                const mockData = {
                    performance_summary: {
                        total_score: 85,
                        security_score: 26,
                        backup_score: 28,
                        system_score: 16,
                        ci_score: 15,
                        grade: '우수'
                    },
                    security_events: {
                        total_events: 156,
                        blocked_ips: 45,
                        rate_limit_violations: 23,
                        whitelist_additions: 8
                    },
                    backup_operations: {
                        successful_backups: 270,
                        failed_backups: 3,
                        success_rate_percent: 98.9,
                        cleanup_operations: 90
                    },
                    system_performance: {
                        avg_cpu_percent: 25.4,
                        avg_memory_percent: 68.2,
                        avg_disk_percent: 45.8,
                        uptime_days: 89
                    },
                    recent_reports: [
                        {
                            quarter: quarter,
                            year: year,
                            total_score: 85,
                            security_score: 26,
                            backup_score: 28,
                            system_score: 16,
                            ci_score: 15,
                            grade: '우수',
                            generated_at: new Date().toISOString()
                        }
                    ],
                    recommendations: [
                        '메모리 사용률이 높으므로 시스템 최적화 권장',
                        'CI 실패율 개선을 위한 테스트 코드 품질 향상 필요'
                    ],
                    critical_periods: [
                        {
                            date: '2024-02-14',
                            description: '밸런타인 데이 트래픽 증가로 인한 일시적 성능 저하'
                        }
                    ],
                    monthly_trends: {
                        month1_score: 82,
                        month2_score: 85,
                        month3_score: 88
                    }
                };

                this.updateScoreCards(mockData.performance_summary);
                this.updateDetailedStats(mockData);
                this.updateReportsList(mockData.recent_reports);
                this.updateRecommendations(mockData.recommendations);
                this.updateCriticalPeriods(mockData.critical_periods);
                this.updateCharts(mockData);
            }

            async generateQuarterlyReport() {
                const quarter = this.quarterSelect?.value || this.currentQuarter;
                const year = this.yearSelect?.value || this.currentYear;

                if (this.generateBtn) {
                    this.generateBtn.disabled = true;
                    this.generateBtn.innerHTML = '<span class="mr-2">⏳</span>생성 중...';
                }

                try {
                    addLog(`📊 ${quarter} ${year} 분기별 리포트 생성 시작...`, 'info');

                    // 실제로는 스크립트를 실행하여 리포트 생성
                    await new Promise(resolve => setTimeout(resolve, 2000)); // 시뮬레이션

                    addLog('✅ 분기별 리포트가 성공적으로 생성되었습니다.', 'info');
                    // 자동으로 새로운 리포트 로드
                    setTimeout(() => this.loadQuarterlyReports(), 1000);

                } catch (error) {
                    console.error('분기별 리포트 생성 중 오류:', error);
                    addLog(`📊 분기별 리포트 생성 실패: ${error.message}`, 'error');
                } finally {
                    if (this.generateBtn) {
                        this.generateBtn.disabled = false;
                        this.generateBtn.innerHTML = '<span class="mr-2">📊</span>리포트 생성';
                    }
                }
            }

            updateScoreCards(performance) {
                if (!performance) return;

                // 점수 업데이트
                if (this.securityScoreEl) this.securityScoreEl.textContent = performance.security_score || 0;
                if (this.backupScoreEl) this.backupScoreEl.textContent = performance.backup_score || 0;
                if (this.systemScoreEl) this.systemScoreEl.textContent = performance.system_score || 0;
                if (this.totalScoreEl) this.totalScoreEl.textContent = performance.total_score || 0;

                // 등급 업데이트
                const grade = performance.grade || '평가 중';
                if (this.gradeEl) {
                    this.gradeEl.textContent = grade;
                    this.gradeEl.className = this.getGradeClass(grade);
                }
            }

            updateDetailedStats(data) {
                const securityEvents = data.security_events || {};
                const backupOps = data.backup_operations || {};
                const systemPerf = data.system_performance || {};

                // 보안 상세 정보
                if (this.blockedIPsEl) this.blockedIPsEl.textContent = `${securityEvents.blocked_ips || 0}개`;
                if (this.securityEventsEl) this.securityEventsEl.textContent = `${securityEvents.total_events || 0}건`;
                if (this.rateLimitEl) this.rateLimitEl.textContent = `${securityEvents.rate_limit_violations || 0}회`;
                if (this.whitelistAddedEl) this.whitelistAddedEl.textContent = `${securityEvents.whitelist_additions || 0}개`;

                // 백업 상세 정보
                if (this.successfulBackupsEl) this.successfulBackupsEl.textContent = `${backupOps.successful_backups || 0}회`;
                if (this.failedBackupsEl) this.failedBackupsEl.textContent = `${backupOps.failed_backups || 0}회`;
                if (this.backupSuccessRateEl) this.backupSuccessRateEl.textContent = `${backupOps.success_rate_percent || 0}%`;
                if (this.cleanupOpsEl) this.cleanupOpsEl.textContent = `${backupOps.cleanup_operations || 0}회`;

                // 시스템 상세 정보
                if (this.avgCpuEl) this.avgCpuEl.textContent = `${systemPerf.avg_cpu_percent || 0}%`;
                if (this.avgMemoryEl) this.avgMemoryEl.textContent = `${systemPerf.avg_memory_percent || 0}%`;
                if (this.avgDiskEl) this.avgDiskEl.textContent = `${systemPerf.avg_disk_percent || 0}%`;
                if (this.uptimeEl) this.uptimeEl.textContent = `${systemPerf.uptime_days || 0}일`;
            }

            updateReportsList(reports) {
                if (!this.reportsListEl || !reports) return;

                if (reports.length === 0) {
                    this.reportsListEl.innerHTML = `
                        <div class="text-center text-gray-400 py-8">
                            <div class="text-4xl mb-2">📊</div>
                            <div>분기별 리포트 데이터가 없습니다.</div>
                        </div>
                    `;
                    return;
                }

                const reportsHtml = reports.map(report => {
                    const gradeEmoji = this.getGradeEmoji(report.grade);
                    const formatDate = (dateStr) => {
                        return new Date(dateStr).toLocaleDateString('ko-KR', {
                            year: 'numeric',
                            month: 'long',
                            day: 'numeric'
                        });
                    };

                    return `
                        <div class="bg-gray-700/50 border border-gray-600/50 rounded-lg p-4 hover:bg-gray-600/50 transition-colors duration-200">
                            <div class="flex justify-between items-start mb-3">
                                <div>
                                    <h4 class="text-white dark:text-gray-100 font-semibold">${report.quarter} ${report.year} 분기별 리포트 ${gradeEmoji}</h4>
                                    <span class="text-xs px-2 py-1 rounded-full bg-gray-600 text-gray-300">${report.grade} (${report.total_score}/100점)</span>
                                </div>
                                <div class="text-right text-sm text-gray-400">
                                    <div>📅 ${formatDate(report.generated_at)}</div>
                                </div>
                            </div>
                            <div class="grid grid-cols-4 gap-2 text-xs text-gray-400">
                                <div>🛡️ 보안: ${report.security_score}/30</div>
                                <div>📦 백업: ${report.backup_score}/30</div>
                                <div>⚙️ 시스템: ${report.system_score}/20</div>
                                <div>🚀 CI/CD: ${report.ci_score || 0}/20</div>
                            </div>
                        </div>
                    `;
                }).join('');

                this.reportsListEl.innerHTML = reportsHtml;
            }

            updateRecommendations(recommendations) {
                if (!recommendations || recommendations.length === 0) {
                    if (this.recommendationsSection) {
                        this.recommendationsSection.classList.add('hidden');
                    }
                    return;
                }

                if (this.recommendationsList) {
                    const recommendationsHtml = recommendations.map(rec =>
                        `<div class="flex items-start"><span class="mr-2">💡</span><span>${rec}</span></div>`
                    ).join('');
                    this.recommendationsList.innerHTML = recommendationsHtml;
                }

                if (this.recommendationsSection) {
                    this.recommendationsSection.classList.remove('hidden');
                }
            }

            updateCriticalPeriods(criticalPeriods) {
                if (!criticalPeriods || criticalPeriods.length === 0) {
                    if (this.criticalPeriodsSection) {
                        this.criticalPeriodsSection.classList.add('hidden');
                    }
                    return;
                }

                if (this.criticalPeriodsList) {
                    const periodsHtml = criticalPeriods.map(period =>
                        `<div class="flex items-start"><span class="mr-2">⚠️</span><span><strong>${period.date}:</strong> ${period.description}</span></div>`
                    ).join('');
                    this.criticalPeriodsList.innerHTML = periodsHtml;
                }

                if (this.criticalPeriodsSection) {
                    this.criticalPeriodsSection.classList.remove('hidden');
                }
            }

            updateCharts(data) {
                this.updateMonthlyTrendChart(data.monthly_trends || {});
                this.updateScoreDistributionChart(data.performance_summary || {});
            }

            updateMonthlyTrendChart(monthlyTrends) {
                const ctx = document.getElementById('quarterlyMonthlyTrendChart');
                if (!ctx) return;

                // 기존 차트 파괴
                if (this.monthlyTrendChart) {
                    this.monthlyTrendChart.destroy();
                }

                const isDark = document.documentElement.classList.contains('dark');
                const textColor = isDark ? '#f3f4f6' : '#374151';
                const gridColor = isDark ? 'rgba(107, 114, 128, 0.3)' : 'rgba(156, 163, 175, 0.3)';

                this.monthlyTrendChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: ['1개월', '2개월', '3개월'],
                        datasets: [{
                            label: '월별 성과 점수',
                            data: [
                                monthlyTrends.month1_score || 0,
                                monthlyTrends.month2_score || 0,
                                monthlyTrends.month3_score || 0
                            ],
                            borderColor: '#3b82f6',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                labels: { color: textColor }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 100,
                                ticks: { color: textColor },
                                grid: { color: gridColor }
                            },
                            x: {
                                ticks: { color: textColor },
                                grid: { color: gridColor }
                            }
                        }
                    }
                });
            }

            updateScoreDistributionChart(performance) {
                const ctx = document.getElementById('quarterlyScoreDistributionChart');
                if (!ctx) return;

                // 기존 차트 파괴
                if (this.scoreDistributionChart) {
                    this.scoreDistributionChart.destroy();
                }

                const isDark = document.documentElement.classList.contains('dark');
                const textColor = isDark ? '#f3f4f6' : '#374151';

                this.scoreDistributionChart = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: ['보안', '백업', '시스템', 'CI/CD'],
                        datasets: [{
                            data: [
                                performance.security_score || 0,
                                performance.backup_score || 0,
                                performance.system_score || 0,
                                performance.ci_score || 0
                            ],
                            backgroundColor: [
                                '#ef4444',
                                '#3b82f6',
                                '#10b981',
                                '#f59e0b'
                            ],
                            borderWidth: 2,
                            borderColor: isDark ? '#374151' : '#ffffff'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: { color: textColor }
                            }
                        }
                    }
                });
            }

            async downloadReport(format) {
                const quarter = this.quarterSelect?.value || this.currentQuarter;
                const year = this.yearSelect?.value || this.currentYear;

                try {
                    addLog(`📥 분기별 리포트 ${format.toUpperCase()} 다운로드를 시작합니다...`, 'info');

                    // 실제로는 스크립트를 실행하여 리포트 생성 후 다운로드
                    await new Promise(resolve => setTimeout(resolve, 1000)); // 시뮬레이션

                    addLog(`📥 분기별 리포트 ${format.toUpperCase()} 파일이 다운로드되었습니다.`, 'info');

                } catch (error) {
                    console.error('리포트 다운로드 중 오류:', error);
                    addLog(`📥 리포트 다운로드 실패: ${error.message}`, 'error');
                }
            }

            onQuarterChange() {
                const newQuarter = this.quarterSelect?.value;
                if (newQuarter) {
                    addLog(`📊 분기가 ${newQuarter}로 변경되었습니다.`, 'info');
                    this.loadQuarterlyReports();
                }
            }

            onYearChange() {
                const newYear = this.yearSelect?.value;
                if (newYear) {
                    addLog(`📊 연도가 ${newYear}년으로 변경되었습니다.`, 'info');
                    this.loadQuarterlyReports();
                }
            }

            getGradeClass(grade) {
                switch (grade) {
                    case '우수': return 'text-green-200 text-xs font-medium';
                    case '보통': return 'text-yellow-200 text-xs font-medium';
                    case '개선 필요': return 'text-red-200 text-xs font-medium';
                    default: return 'text-gray-200 text-xs font-medium';
                }
            }

            getGradeEmoji(grade) {
                switch (grade) {
                    case '우수': return '🏆';
                    case '보통': return '👍';
                    case '개선 필요': return '⚠️';
                    default: return '📊';
                }
            }

            loadFallbackData() {
                // 실제 데이터를 로드할 수 없을 때 기본 데이터 표시
                const fallbackData = {
                    performance_summary: {
                        total_score: 0,
                        security_score: 0,
                        backup_score: 0,
                        system_score: 0,
                        ci_score: 0,
                        grade: '데이터 없음'
                    },
                    security_events: { total_events: 0, blocked_ips: 0, rate_limit_violations: 0, whitelist_additions: 0 },
                    backup_operations: { successful_backups: 0, failed_backups: 0, success_rate_percent: 0, cleanup_operations: 0 },
                    system_performance: { avg_cpu_percent: 0, avg_memory_percent: 0, avg_disk_percent: 0, uptime_days: 0 },
                    recent_reports: [],
                    recommendations: [],
                    critical_periods: [],
                    monthly_trends: { month1_score: 0, month2_score: 0, month3_score: 0 }
                };

                this.updateScoreCards(fallbackData.performance_summary);
                this.updateDetailedStats(fallbackData);
                this.updateReportsList(fallbackData.recent_reports);
                this.updateRecommendations(fallbackData.recommendations);
                this.updateCriticalPeriods(fallbackData.critical_periods);
                this.updateCharts(fallbackData);
            }

            showLoadingState() {
                if (this.refreshBtn) {
                    this.refreshBtn.disabled = true;
                    this.refreshBtn.innerHTML = '<span class="mr-2">🔄</span>로딩 중...';
                }

                if (this.reportsListEl) {
                    this.reportsListEl.innerHTML = `
                        <div class="text-center text-gray-400 py-8">
                            <div class="text-4xl mb-2">📊</div>
                            <div>분기별 리포트 데이터를 로드하는 중...</div>
                        </div>
                    `;
                }
            }

            hideLoadingState() {
                if (this.refreshBtn) {
                    this.refreshBtn.disabled = false;
                    this.refreshBtn.innerHTML = '<span class="mr-2">🔄</span>새로고침';
                }
            }

            startAutoRefresh() {
                this.stopAutoRefresh();
                // 5분마다 자동 새로고침
                this.autoRefreshInterval = setInterval(() => {
                    this.loadQuarterlyReports();
                }, 300000);
            }

            stopAutoRefresh() {
                if (this.autoRefreshInterval) {
                    clearInterval(this.autoRefreshInterval);
                    this.autoRefreshInterval = null;
                }
            }
        }

        // =============================================
        // 📅 연간 운영 리포트 매니저 (한국어 주석 포함)
        // =============================================

        class YearlyReportManager {
            constructor() {
                this.currentYear = new Date().getFullYear();
                this.isLoading = false;
                this.reportData = null;
                this.charts = {
                    quarterly: null,
                    distribution: null
                };
                this.init();
            }

            init() {
                this.setupEventListeners();
                this.updateYearSelector();
                this.loadInitialData();
                addLog('📅 연간 운영 리포트 매니저가 초기화되었습니다.', 'info');
            }

            setupEventListeners() {
                // 새로고침 버튼
                const refreshBtn = document.getElementById('yearlyRefreshBtn');
                if (refreshBtn) {
                    refreshBtn.addEventListener('click', () => this.refreshData());
                }

                // 리포트 생성 버튼
                const generateBtn = document.getElementById('yearlyGenerateBtn');
                if (generateBtn) {
                    generateBtn.addEventListener('click', () => this.generateReport());
                }

                // Markdown 다운로드 버튼
                const markdownBtn = document.getElementById('yearlyMarkdownBtn');
                if (markdownBtn) {
                    markdownBtn.addEventListener('click', () => this.downloadMarkdown());
                }

                // JSON 다운로드 버튼
                const jsonBtn = document.getElementById('yearlyJsonBtn');
                if (jsonBtn) {
                    jsonBtn.addEventListener('click', () => this.downloadJson());
                }

                // 알림 전송 버튼
                const notifyBtn = document.getElementById('yearlyNotifyBtn');
                if (notifyBtn) {
                    notifyBtn.addEventListener('click', () => this.sendNotification());
                }

                // 연도 선택기
                const yearSelector = document.getElementById('yearlyYearSelector');
                if (yearSelector) {
                    yearSelector.addEventListener('change', (e) => {
                        this.currentYear = parseInt(e.target.value);
                        this.loadYearlyData();
                    });
                }
            }

            updateYearSelector() {
                const yearSelector = document.getElementById('yearlyYearSelector');
                if (!yearSelector) return;

                // 현재 연도부터 5년 전까지의 옵션 생성
                const currentYear = new Date().getFullYear();
                yearSelector.innerHTML = '';

                for (let year = currentYear; year >= currentYear - 5; year--) {
                    const option = document.createElement('option');
                    option.value = year;
                    option.textContent = year + '년';
                    if (year === this.currentYear) {
                        option.selected = true;
                    }
                    yearSelector.appendChild(option);
                }
            }

            async loadInitialData() {
                await this.loadYearlyData();
            }

            async refreshData() {
                addLog('📅 연간 운영 리포트 데이터를 새로고침합니다...', 'info');
                await this.loadYearlyData();
                this.showSuccessToast('데이터가 새로고침되었습니다');
            }

            async loadYearlyData() {
                if (this.isLoading) return;

                this.setLoadingState(true);
                this.updateProgressBar(0, '연간 데이터 로딩 중...');

                try {
                    // 실제로는 yearly_ops_report.sh 스크립트를 호출하여 데이터를 가져옴
                    // 여기서는 시뮬레이션된 데이터 사용
                    this.updateProgressBar(25, '보안 데이터 분석 중...');
                    await this.delay(500);

                    this.updateProgressBar(50, '백업 데이터 분석 중...');
                    await this.delay(500);

                    this.updateProgressBar(75, '시스템 메트릭 분석 중...');
                    await this.delay(500);

                    this.updateProgressBar(100, '리포트 생성 완료');

                    // 시뮬레이션된 연간 리포트 데이터
                    this.reportData = this.generateSimulatedData();

                    this.updateScoreCards();
                    this.updateCharts();
                    this.updateCriticalEvents();
                    this.updateStatistics();

                    addLog(`📅 ${this.currentYear}년 연간 운영 리포트가 로드되었습니다.`, 'success');

                } catch (error) {
                    console.error('연간 리포트 로딩 실패:', error);
                    addLog('❌ 연간 리포트 로딩에 실패했습니다: ' + error.message, 'error');
                    this.showErrorToast('데이터 로딩에 실패했습니다');
                } finally {
                    this.setLoadingState(false);
                }
            }

            generateSimulatedData() {
                // 실제 환경에서는 yearly_ops_report.sh의 출력을 파싱
                const baseScore = 75 + Math.random() * 20; // 75-95 점
                return {
                    year: this.currentYear,
                    overall_score: Math.round(baseScore),
                    security_score: Math.round(baseScore + (Math.random() - 0.5) * 10),
                    backup_score: Math.round(baseScore + (Math.random() - 0.5) * 8),
                    system_score: Math.round(baseScore + (Math.random() - 0.5) * 12),
                    cicd_score: Math.round(baseScore + (Math.random() - 0.5) * 15),
                    quarterly_trends: [
                        { quarter: 'Q1', score: Math.round(baseScore + (Math.random() - 0.5) * 10) },
                        { quarter: 'Q2', score: Math.round(baseScore + (Math.random() - 0.5) * 10) },
                        { quarter: 'Q3', score: Math.round(baseScore + (Math.random() - 0.5) * 10) },
                        { quarter: 'Q4', score: Math.round(baseScore + (Math.random() - 0.5) * 10) }
                    ],
                    critical_events: [
                        { date: '2024-12-15', type: '보안', description: 'SSH 무차별 대입 공격 차단', severity: 'high' },
                        { date: '2024-11-28', type: '백업', description: '백업 검증 실패 (database-prod)', severity: 'medium' },
                        { date: '2024-10-22', type: 'CI/CD', description: 'Production 배포 실패 (rollback 수행)', severity: 'high' },
                        { date: '2024-09-15', type: '시스템', description: 'Disk 사용량 90% 초과', severity: 'medium' },
                        { date: '2024-08-08', type: '보안', description: 'Suspicious API 호출 패턴 탐지', severity: 'low' }
                    ],
                    statistics: {
                        total_security_incidents: Math.floor(50 + Math.random() * 30),
                        backup_success_rate: Math.round(95 + Math.random() * 4),
                        system_uptime: Math.round(98 + Math.random() * 1.5),
                        avg_deployment_time: Math.round(8 + Math.random() * 4)
                    }
                };
            }

            updateScoreCards() {
                if (!this.reportData) return;

                const scoreCards = [
                    { id: 'yearlyOverallScore', value: this.reportData.overall_score },
                    { id: 'yearlySecurityScore', value: this.reportData.security_score },
                    { id: 'yearlyBackupScore', value: this.reportData.backup_score },
                    { id: 'yearlySystemScore', value: this.reportData.system_score },
                    { id: 'yearlyCicdScore', value: this.reportData.cicd_score }
                ];

                scoreCards.forEach(card => {
                    const element = document.getElementById(card.id);
                    if (element) {
                        this.animateScore(element, card.value);
                    }
                });
            }

            animateScore(element, targetValue) {
                const startValue = 0;
                const duration = 1000;
                const startTime = performance.now();

                const animate = (currentTime) => {
                    const elapsed = currentTime - startTime;
                    const progress = Math.min(elapsed / duration, 1);

                    const currentValue = Math.round(startValue + (targetValue - startValue) * progress);
                    element.textContent = currentValue;

                    if (progress < 1) {
                        requestAnimationFrame(animate);
                    }
                };

                requestAnimationFrame(animate);
            }

            updateCharts() {
                if (!this.reportData) return;

                this.updateQuarterlyTrendChart();
                this.updateScoreDistributionChart();
            }

            updateQuarterlyTrendChart() {
                const ctx = document.getElementById('yearlyQuarterlyChart');
                if (!ctx) return;

                // 기존 차트 파괴
                if (this.charts.quarterly) {
                    this.charts.quarterly.destroy();
                }

                const isDark = document.documentElement.classList.contains('dark');
                const textColor = isDark ? '#e5e7eb' : '#374151';
                const gridColor = isDark ? '#374151' : '#e5e7eb';

                this.charts.quarterly = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: this.reportData.quarterly_trends.map(q => q.quarter),
                        datasets: [{
                            label: '분기별 성과 점수',
                            data: this.reportData.quarterly_trends.map(q => q.score),
                            borderColor: '#3b82f6',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                labels: { color: textColor }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 100,
                                ticks: { color: textColor },
                                grid: { color: gridColor }
                            },
                            x: {
                                ticks: { color: textColor },
                                grid: { color: gridColor }
                            }
                        }
                    }
                });
            }

            updateScoreDistributionChart() {
                const ctx = document.getElementById('yearlyDistributionChart');
                if (!ctx) return;

                // 기존 차트 파괴
                if (this.charts.distribution) {
                    this.charts.distribution.destroy();
                }

                const isDark = document.documentElement.classList.contains('dark');
                const textColor = isDark ? '#e5e7eb' : '#374151';

                this.charts.distribution = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: ['보안', '백업', '시스템', 'CI/CD'],
                        datasets: [{
                            data: [
                                this.reportData.security_score,
                                this.reportData.backup_score,
                                this.reportData.system_score,
                                this.reportData.cicd_score
                            ],
                            backgroundColor: [
                                '#ef4444', // 보안 - 빨간색
                                '#10b981', // 백업 - 초록색
                                '#f59e0b', // 시스템 - 노란색
                                '#3b82f6'  // CI/CD - 파란색
                            ],
                            borderWidth: 2,
                            borderColor: isDark ? '#1f2937' : '#ffffff'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: { color: textColor }
                            }
                        }
                    }
                });
            }

            updateCriticalEvents() {
                if (!this.reportData) return;

                const container = document.getElementById('yearlyCriticalEventsList');
                if (!container) return;

                container.innerHTML = '';

                this.reportData.critical_events.slice(0, 5).forEach(event => {
                    const severityColors = {
                        high: 'text-red-400 bg-red-500/20',
                        medium: 'text-yellow-400 bg-yellow-500/20',
                        low: 'text-green-400 bg-green-500/20'
                    };

                    const severityLabels = {
                        high: '높음',
                        medium: '보통',
                        low: '낮음'
                    };

                    const eventElement = document.createElement('div');
                    eventElement.className = 'flex items-center justify-between p-3 bg-white/5 rounded-lg border border-white/10';
                    eventElement.innerHTML = `
                        <div class="flex-1">
                            <div class="flex items-center space-x-2 mb-1">
                                <span class="text-sm font-medium text-white">${event.type}</span>
                                <span class="px-2 py-1 rounded text-xs font-medium ${severityColors[event.severity]}">${severityLabels[event.severity]}</span>
                            </div>
                            <div class="text-sm text-gray-300">${event.description}</div>
                        </div>
                        <div class="text-xs text-gray-400">${event.date}</div>
                    `;
                    container.appendChild(eventElement);
                });
            }

            updateStatistics() {
                if (!this.reportData) return;

                const stats = [
                    { id: 'yearlySecurityIncidents', value: this.reportData.statistics.total_security_incidents },
                    { id: 'yearlyBackupSuccessRate', value: this.reportData.statistics.backup_success_rate + '%' },
                    { id: 'yearlySystemUptime', value: this.reportData.statistics.system_uptime + '%' },
                    { id: 'yearlyAvgDeployTime', value: this.reportData.statistics.avg_deployment_time + '분' }
                ];

                stats.forEach(stat => {
                    const element = document.getElementById(stat.id);
                    if (element) {
                        element.textContent = stat.value;
                    }
                });
            }

            async generateReport() {
                if (this.isLoading) return;

                addLog('📊 연간 운영 리포트를 생성합니다...', 'info');
                this.setLoadingState(true);

                try {
                    // 실제로는 yearly_ops_report.sh 스크립트를 실행
                    await this.delay(2000);

                    await this.loadYearlyData();
                    this.showSuccessToast('리포트가 생성되었습니다');

                } catch (error) {
                    console.error('리포트 생성 실패:', error);
                    addLog('❌ 리포트 생성에 실패했습니다: ' + error.message, 'error');
                    this.showErrorToast('리포트 생성에 실패했습니다');
                } finally {
                    this.setLoadingState(false);
                }
            }

            async downloadMarkdown() {
                if (!this.reportData) {
                    this.showErrorToast('리포트 데이터가 없습니다');
                    return;
                }

                const markdown = this.generateMarkdownReport();
                this.downloadFile(`yearly_ops_report_${this.currentYear}.md`, markdown, 'text/markdown');
                addLog('📄 Markdown 리포트가 다운로드되었습니다.', 'success');
            }

            async downloadJson() {
                if (!this.reportData) {
                    this.showErrorToast('리포트 데이터가 없습니다');
                    return;
                }

                const json = JSON.stringify(this.reportData, null, 2);
                this.downloadFile(`yearly_ops_report_${this.currentYear}.json`, json, 'application/json');
                addLog('📊 JSON 리포트가 다운로드되었습니다.', 'success');
            }

            generateMarkdownReport() {
                return `# 📅 ${this.currentYear}년 연간 운영 리포트

## 📊 종합 성과 요약
- **종합 점수**: ${this.reportData.overall_score}/100
- **보안 점수**: ${this.reportData.security_score}/100
- **백업 점수**: ${this.reportData.backup_score}/100
- **시스템 점수**: ${this.reportData.system_score}/100
- **CI/CD 점수**: ${this.reportData.cicd_score}/100

## 📈 분기별 성과 트렌드
${this.reportData.quarterly_trends.map(q => `- **${q.quarter}**: ${q.score}점`).join('\n')}

## 🚨 주요 보안 이벤트 (Top 5)
${this.reportData.critical_events.slice(0, 5).map(event =>
    `- **${event.date}** [${event.type}] ${event.description} (위험도: ${event.severity})`
).join('\n')}

## 📋 연간 통계
- **보안 인시던트**: ${this.reportData.statistics.total_security_incidents}건
- **백업 성공률**: ${this.reportData.statistics.backup_success_rate}%
- **시스템 가동시간**: ${this.reportData.statistics.system_uptime}%
- **평균 배포 시간**: ${this.reportData.statistics.avg_deployment_time}분

---
*Generated by MCP Map Company Admin Dashboard*
`;
            }

            async sendNotification() {
                if (!this.reportData) {
                    this.showErrorToast('리포트 데이터가 없습니다');
                    return;
                }

                if (this.isLoading) return;

                addLog('📧 연간 운영 리포트 알림을 전송합니다...', 'info');
                this.setLoadingState(true);

                try {
                    // 실제로는 mcp/utils/notifier.py의 send_yearly_ops_report 함수를 호출
                    await this.delay(1500);

                    this.showSuccessToast('연간 리포트 알림이 전송되었습니다');
                    addLog('📧 연간 운영 리포트 알림이 성공적으로 전송되었습니다.', 'success');

                } catch (error) {
                    console.error('알림 전송 실패:', error);
                    addLog('❌ 알림 전송에 실패했습니다: ' + error.message, 'error');
                    this.showErrorToast('알림 전송에 실패했습니다');
                } finally {
                    this.setLoadingState(false);
                }
            }

            downloadFile(filename, content, mimeType) {
                const blob = new Blob([content], { type: mimeType });
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = filename;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);
            }

            setLoadingState(loading) {
                this.isLoading = loading;
                const buttons = [
                    'yearlyRefreshBtn', 'yearlyGenerateBtn', 'yearlyMarkdownBtn',
                    'yearlyJsonBtn', 'yearlyNotifyBtn'
                ];

                buttons.forEach(btnId => {
                    const btn = document.getElementById(btnId);
                    if (btn) {
                        btn.disabled = loading;
                        btn.style.opacity = loading ? '0.5' : '1';
                    }
                });
            }

            updateProgressBar(percentage, message) {
                const progressBar = document.getElementById('yearlyProgressBar');
                const progressText = document.getElementById('yearlyProgressText');

                if (progressBar) {
                    progressBar.style.width = percentage + '%';
                }

                if (progressText) {
                    progressText.textContent = message;
                }
            }

            showSuccessToast(message) {
                this.showToast(message, 'success');
            }

            showErrorToast(message) {
                this.showToast(message, 'error');
            }

            showToast(message, type) {
                // 간단한 토스트 알림 구현
                const toast = document.createElement('div');
                toast.className = `fixed top-4 right-4 px-6 py-3 rounded-lg text-white font-medium z-50 ${
                    type === 'success' ? 'bg-green-600' : 'bg-red-600'
                }`;
                toast.textContent = message;

                document.body.appendChild(toast);

                setTimeout(() => {
                    toast.style.opacity = '0';
                    setTimeout(() => {
                        if (toast.parentNode) {
                            toast.parentNode.removeChild(toast);
                        }
                    }, 300);
                }, 3000);
            }

            // 차트 업데이트 (다크모드 변경시 호출)
            updateChartsForTheme() {
                if (this.reportData) {
                    this.updateCharts();
                }
            }

            delay(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }
        }

        // 전역 변수로 매니저 인스턴스 저장
        let yearlyReportManager = null;

        // DOM 로드 완료 시 매니저들 초기화
        document.addEventListener('DOMContentLoaded', function() {
            // 운영 알림 통합 패널이 있는 경우에만 초기화
            if (document.getElementById('opsNotificationsList')) {
                opsNotificationManager = new OpsNotificationManager();
                addLog('🔔 운영 알림 통합 패널이 초기화되었습니다.', 'info');
            }

            // CI/CD 성능 리포트 패널이 있는 경우에만 초기화
            if (document.getElementById('ciReportsList')) {
                ciReportManager = new CIReportManager();
                addLog('📊 CI/CD 성능 리포트 패널이 초기화되었습니다.', 'info');
            }

            // CI/CD 에러 로그 분석 패널이 있는 경우에만 초기화
            if (document.getElementById('errorCasesList')) {
                ciErrorAnalyzer = new CIErrorAnalyzer();
                addLog('🚨 CI/CD 에러 로그 분석 패널이 초기화되었습니다.', 'info');
            }

            // 분기별 운영 리포트 패널이 있는 경우에만 초기화
            if (document.getElementById('quarterlyReportsList')) {
                quarterlyReportManager = new QuarterlyReportManager();
                addLog('📊 분기별 운영 리포트 패널이 초기화되었습니다.', 'info');
            }

            // 연간 운영 리포트 패널이 있는 경우에만 초기화
            if (document.getElementById('yearlyOverallScore')) {
                yearlyReportManager = new YearlyReportManager();
                addLog('📅 연간 운영 리포트 패널이 초기화되었습니다.', 'info');
            }
        });
    </script>

    <!-- 알림 세부 정보 모달 -->
    <div id="alertDetailModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden items-center justify-center p-4 z-50">
        <div class="bg-white dark:bg-gray-800 rounded-xl max-w-4xl w-full max-h-[90vh] overflow-hidden shadow-2xl">
            <!-- 모달 헤더 -->
            <div class="bg-gradient-to-r from-blue-600 to-purple-600 dark:from-blue-700 dark:to-purple-700 p-6">
                <div class="flex justify-between items-center">
                    <h3 class="text-xl font-bold text-white flex items-center">
                        <span id="modalAlertIcon" class="mr-3">📢</span>
                        알림 세부 정보
                    </h3>
                    <button
                        id="closeModalBtn"
                        class="text-white hover:text-gray-200 transition-colors p-2 hover:bg-white/10 rounded-lg"
                    >
                        ✕
                    </button>
                </div>
            </div>

            <!-- 모달 내용 -->
            <div class="p-6 overflow-y-auto max-h-[calc(90vh-120px)]">
                <!-- 알림 기본 정보 -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div class="space-y-3">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">알림 제목</label>
                            <div id="modalAlertTitle" class="p-3 bg-gray-100 dark:bg-gray-700 rounded-lg text-gray-900 dark:text-gray-100"></div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">심각도</label>
                            <div id="modalAlertLevel" class="p-3 bg-gray-100 dark:bg-gray-700 rounded-lg text-gray-900 dark:text-gray-100"></div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">발생 시간</label>
                            <div id="modalAlertTime" class="p-3 bg-gray-100 dark:bg-gray-700 rounded-lg text-gray-900 dark:text-gray-100"></div>
                        </div>
                    </div>
                    <div class="space-y-3">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">알림 ID</label>
                            <div id="modalAlertId" class="p-3 bg-gray-100 dark:bg-gray-700 rounded-lg text-gray-900 dark:text-gray-100 font-mono text-sm"></div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">채널</label>
                            <div id="modalAlertChannel" class="p-3 bg-gray-100 dark:bg-gray-700 rounded-lg text-gray-900 dark:text-gray-100"></div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">상태</label>
                            <div id="modalAlertStatus" class="p-3 bg-gray-100 dark:bg-gray-700 rounded-lg text-gray-900 dark:text-gray-100"></div>
                        </div>
                    </div>
                </div>

                <!-- 알림 메시지 -->
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">알림 메시지</label>
                    <div id="modalAlertMessage" class="p-4 bg-gray-100 dark:bg-gray-700 rounded-lg text-gray-900 dark:text-gray-100 whitespace-pre-wrap"></div>
                </div>

                <!-- 관련 로그 링크 -->
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">관련 로그</label>
                    <div id="modalLogLinks" class="space-y-2">
                        <!-- 로그 링크들이 동적으로 추가됩니다 -->
                    </div>
                </div>

                <!-- 추가 정보 (있는 경우) -->
                <div id="modalAdditionalInfo" class="mb-6 hidden">
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">추가 정보</label>
                    <div id="modalAdditionalInfoContent" class="p-4 bg-gray-100 dark:bg-gray-700 rounded-lg text-gray-900 dark:text-gray-100"></div>
                </div>

                <!-- 로그 내용 (있는 경우) -->
                <div id="modalLogContent" class="hidden">
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">첨부된 로그 내용</label>
                    <div id="modalLogContentText" class="p-4 bg-gray-900 dark:bg-gray-800 rounded-lg text-green-400 font-mono text-sm overflow-x-auto max-h-64 overflow-y-auto whitespace-pre"></div>
                </div>
            </div>

            <!-- 모달 푸터 -->
            <div class="bg-gray-50 dark:bg-gray-700 px-6 py-4 flex justify-end gap-3">
                <button
                    id="modalExportBtn"
                    class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors duration-200 flex items-center"
                >
                    📄 내보내기
                </button>
                <button
                    id="modalCloseBtn"
                    class="px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg transition-colors duration-200"
                >
                    닫기
                </button>
            </div>
        </div>
    </div>
</body>
</html>